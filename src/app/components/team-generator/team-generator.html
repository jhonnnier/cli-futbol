<div class="team-generator">
  <h2>Generar Equipos</h2>

  <div class="config-section">
    <button
      class="btn-generate"
      (click)="generateTeams()"
      [disabled]="players().length < 2"
    >
      üé≤ Repartir Equipos
    </button>
  </div>

  @if (players().length < 2) {
    <p class="warning">Se necesitan al menos 2 jugadores para generar equipos.</p>
  }

  @if (teams().length > 0) {
    <div class="teams-grid">
      @for (team of teams(); track team.name) {
        <div class="team-card">
          <div class="team-header">
            <h3>{{ team.name }}</h3>
            <span class="team-stats">
              Total: {{ team.totalSkill }} | Prom: {{ getSkillAverage(team) }}
            </span>
          </div>
          
          <div class="formation-field">
            @if (team.goalkeeper) {
              <div class="formation-row goalkeeper-row">
                <div class="player-avatar goalkeeper">
                  <div class="avatar-circle">
                    <span class="goalkeeper-icon">üß§</span>
                  </div>
                  <div class="player-rating goalkeeper-rating">{{ team.goalkeeper.skill }}</div>
                  <div class="player-info">
                    <div class="player-name">{{ team.goalkeeper.name }}</div>
                  </div>
                </div>
              </div>
            }
            
            <div class="formation-rows">
              @for (player of getSortedPlayers(team.players); track player.id; let idx = $index) {
                @if (idx % 3 === 0) {
                  <div class="formation-row">
                    @for (p of getRowPlayers(getSortedPlayers(team.players), idx); track p.id) {
                      <div class="player-avatar" [attr.data-position]="getPlayerPosition(p)">
                        <div class="avatar-circle">
                          <span class="player-initial">{{ getInitial(p.name) }}</span>
                        </div>
                        <div class="player-rating">{{ getPlayerSkill(p) }}</div>
                        <div class="player-info">
                          <div class="player-name">{{ p.name }}</div>
                          <div class="player-position">
                            @if (getPlayerPosition(p) === 'defense') {
                              üõ°Ô∏è
                            } @else if (getPlayerPosition(p) === 'creation') {
                              üéØ
                            } @else {
                              ‚öîÔ∏è
                            }
                          </div>
                        </div>
                      </div>
                    }
                  </div>
                }
              }
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
