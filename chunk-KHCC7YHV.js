import{$a as Er,Ba as _u,E as _i,Ea as yi,Fa as Te,G as wr,Ga as Pe,H as Xt,Ha as yu,I as fo,Ia as Ye,Ja as Xe,K as wn,Ka as Me,La as N,M as Ve,Ma as O,Na as je,Oa as re,Pa as ie,Qa as wo,R as Le,Ra as Nt,S as Be,Sa as Zt,Ta as he,Ua as bn,Va as $,Wa as Ke,X as br,Xa as k,Ya as Fe,Za as vi,_a as wi,a as z,aa as _e,b as ne,ba as Ot,bb as dt,ca as mo,cb as vu,da as go,db as bo,ea as po,eb as wu,f as fu,gb as Eo,hb as Co,i as mu,la as _o,ma as U,n as gu,ra as yo,s as pu,sa as Ee,wa as Ue,xa as vo,ya as $e,za as kt}from"./chunk-KZAHEGFW.js";var Io=[{id:"17",name:"Edinson",defense:4,creation:2,offense:2,enabled:!0,order:1,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/edinson_2.png"},{id:"2",name:"Jhonnier",defense:4,creation:2,offense:1,enabled:!0,order:2,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/jhonnier_2.png"},{id:"3",name:"Goku",defense:4,creation:2,offense:2,enabled:!0,order:3,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/goku_2.png"},{id:"11",name:"Jorge",defense:2,creation:2,offense:3,enabled:!0,order:4,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/jorge_2.png"},{id:"5",name:"Wilson",defense:2,creation:2,offense:3,enabled:!0,order:5,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/wilson.png"},{id:"4",name:"Jhonatan",defense:2,creation:2,offense:3,enabled:!0,order:6,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/jhonatan.png"},{id:"10",name:"Yhonier",defense:2,creation:3,offense:4,enabled:!0,order:7,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/yhonier.png"},{id:"1",name:"Carlos",defense:2,creation:2,offense:3,enabled:!0,order:8,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/carlos.png"},{id:"16",name:"Oscar",defense:4,creation:2,offense:1,enabled:!0,order:9,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/oscar.png"},{id:"18",name:"Fernando",defense:4,creation:2,offense:2,enabled:!0,order:10,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/fernando.png"},{id:"15",name:"Willian",defense:1,creation:2,offense:3,enabled:!0,order:11,image:""},{id:"6",name:"Lucho",defense:2,creation:2,offense:3,enabled:!0,order:12,image:""},{id:"19",name:"Quiira",defense:2,creation:2,offense:3,enabled:!0,order:13,image:""},{id:"12",name:"Ronal",defense:2,creation:2,offense:2,enabled:!0,order:14,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/ronal.png"},{id:"7",name:"Camilo",defense:2,creation:3,offense:2,enabled:!1,order:15,image:""},{id:"8",name:"Sergio",defense:2,creation:3,offense:3,enabled:!1,order:16,image:""},{id:"9",name:"Beken",defense:2,creation:3,offense:4,enabled:!1,order:17,image:""},{id:"13",name:"H Javier",defense:2,creation:3,offense:4,enabled:!1,order:18,image:""},{id:"14",name:"Acosta",defense:3,creation:3,offense:2,enabled:!1,order:19,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/acosta.png"}];var bu=[{id:"gk1",name:"Ivan",skill:4,selected:!0,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/ivan.png"},{id:"gk2",name:"Leo",skill:4,selected:!0,image:"https://raw.githubusercontent.com/jhonnnier/cli-futbol/refs/heads/master/src/assets/images/leo.png"},{id:"gk3",name:"gk3",skill:4,selected:!1,image:""},{id:"gk4",name:"gk4",skill:4,selected:!1,image:""}];var Ft=class n{storageKey="futbol-goalkeepers";goalkeepers=_e(bu);maxSelected=2;selectedGoalkeepers=()=>this.goalkeepers().filter(e=>e.selected);saveGoalkeepers(){localStorage.setItem(this.storageKey,JSON.stringify(this.goalkeepers()))}toggleGoalkeeper(e){let t=this.goalkeepers().find(i=>i.id===e);if(!t)return;let r=this.selectedGoalkeepers().length;!t.selected&&r>=this.maxSelected||(this.goalkeepers.update(i=>i.map(o=>o.id===e?ne(z({},o),{selected:!o.selected}):o)),this.saveGoalkeepers())}canSelect(e){let t=this.goalkeepers().find(r=>r.id===e);return t?t.selected?!0:this.selectedGoalkeepers().length<this.maxSelected:!1}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Xt({token:n,factory:n.\u0275fac,providedIn:"root"})};var Eu=()=>{};var Tu=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Rm=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Pu={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,f=h?n[i+2]:0,m=o>>2,v=(o&3)<<4|u>>4,C=(u&15)<<2|f>>6,x=f&63;h||(x=64,a||(C=64)),r.push(t[m],t[v],t[C],t[x])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Tu(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Rm(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let f=i<n.length?t[n.charAt(i)]:64;++i;let v=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||f==null||v==null)throw new To;let C=o<<2|u>>4;if(r.push(C),f!==64){let x=u<<4&240|f>>2;if(r.push(x),v!==64){let V=f<<6&192|v;r.push(V)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},To=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Om=function(n){let e=Tu(n);return Pu.encodeByteArray(e,!0)},Ir=function(n){return Om(n).replace(/\./g,"")},Au=function(n){try{return Pu.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var km=()=>xu().__FIREBASE_DEFAULTS__,Nm=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Fm=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Au(n[1]);return e&&JSON.parse(e)},Po=()=>{try{return Eu()||km()||Nm()||Fm()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Lm=n=>Po()?.emulatorHosts?.[n],Su=n=>{let e=Lm(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ao=()=>Po()?.config;var bi=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Ei(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Vu(n){return(await fetch(n,{credentials:"include"})).ok}function Du(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=z({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ir(JSON.stringify(t)),Ir(JSON.stringify(a)),""].join(".")}var Cr={};function Bm(){let n={prod:[],emulator:[]};for(let e of Object.keys(Cr))Cr[e]?n.emulator.push(e):n.prod.push(e);return n}function Um(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Cu=!1;function Mu(n,e){if(typeof window>"u"||typeof document>"u"||!Ei(window.location.host)||Cr[n]===e||Cr[n]||Cu)return;Cr[n]=e;function t(C){return`__firebase__banner__${C}`}let r="__firebase__banner",o=Bm().prod.length>0;function a(){let C=document.getElementById(r);C&&C.remove()}function u(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function h(C,x){C.setAttribute("width","24"),C.setAttribute("id",x),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function f(){let C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{Cu=!0,a()},C}function m(C,x){C.setAttribute("id",x),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function v(){let C=Um(r),x=t("text"),V=document.getElementById(x)||document.createElement("span"),F=t("learnmore"),M=document.getElementById(F)||document.createElement("a"),J=t("preprendIcon"),X=document.getElementById(J)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){let ee=C.element;u(ee),m(M,F);let ke=f();h(X,J),ee.append(X,V,M,ke),document.body.appendChild(ee)}o?(V.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Ru(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jm(){let n=Po()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ou(){return!jm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xo(){try{return typeof indexedDB=="object"}catch{return!1}}function ku(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var qm="FirebaseError",mt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=qm,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tr.prototype.create)}},Tr=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?Gm(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new mt(i,u,r)}};function Gm(n,e){return n.replace(zm,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var zm=/\{\$([^}]+)}/g;function en(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Iu(o)&&Iu(a)){if(!en(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Iu(n){return n!==null&&typeof n=="object"}var E0=14400*1e3;function Ze(n){return n&&n._delegate?n._delegate:n}var gt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var tn="[DEFAULT]";var So=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new bi;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Km(e))try{this.getOrInitializeService({instanceIdentifier:tn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=tn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tn){return this.instances.has(e)}getOptions(e=tn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$m(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=tn){return this.component?this.component.multipleInstances?e:tn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function $m(n){return n===tn?void 0:n}function Km(n){return n.instantiationMode==="EAGER"}var Ci=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new So(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Hm=[],W=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(W||{}),Wm={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},Qm=W.INFO,Jm={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},Ym=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Jm[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},En=class{constructor(e){this.name=e,this._logLevel=Qm,this._logHandler=Ym,this._userLogHandler=null,Hm.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Wm[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}};var Xm=(n,e)=>e.some(t=>n instanceof t),Nu,Fu;function Zm(){return Nu||(Nu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eg(){return Fu||(Fu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Lu=new WeakMap,Do=new WeakMap,Bu=new WeakMap,Vo=new WeakMap,Ro=new WeakMap;function tg(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(et(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Lu.set(t,n)}).catch(()=>{}),Ro.set(e,n),e}function ng(n){if(Do.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});Do.set(n,e)}var Mo={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Do.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Bu.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Uu(n){Mo=n(Mo)}function rg(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ii(this),e,...t);return Bu.set(r,e.sort?e.sort():[e]),et(r)}:eg().includes(n)?function(...e){return n.apply(Ii(this),e),et(Lu.get(this))}:function(...e){return et(n.apply(Ii(this),e))}}function ig(n){return typeof n=="function"?rg(n):(n instanceof IDBTransaction&&ng(n),Xm(n,Zm())?new Proxy(n,Mo):n)}function et(n){if(n instanceof IDBRequest)return tg(n);if(Vo.has(n))return Vo.get(n);let e=ig(n);return e!==n&&(Vo.set(n,e),Ro.set(e,n)),e}var Ii=n=>Ro.get(n);function qu(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=et(a);return r&&a.addEventListener("upgradeneeded",h=>{r(et(a.result),h.oldVersion,h.newVersion,et(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}var sg=["get","getKey","getAll","getAllKeys","count"],og=["put","add","delete","clear"],Oo=new Map;function ju(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Oo.get(e))return Oo.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=og.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||sg.includes(t)))return;let o=async function(a,...u){let h=this.transaction(a,i?"readwrite":"readonly"),f=h.store;return r&&(f=f.index(u.shift())),(await Promise.all([f[t](...u),i&&h.done]))[0]};return Oo.set(e,o),o}Uu(n=>ne(z({},n),{get:(e,t,r)=>ju(e,t)||n.get(e,t,r),has:(e,t)=>!!ju(e,t)||n.has(e,t)}));var No=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ag(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function ag(n){return n.getComponent()?.type==="VERSION"}var Fo="@firebase/app",Gu="0.14.7";var pt=new En("@firebase/app"),cg="@firebase/app-compat",lg="@firebase/analytics-compat",ug="@firebase/analytics",hg="@firebase/app-check-compat",dg="@firebase/app-check",fg="@firebase/auth",mg="@firebase/auth-compat",gg="@firebase/database",pg="@firebase/data-connect",_g="@firebase/database-compat",yg="@firebase/functions",vg="@firebase/functions-compat",wg="@firebase/installations",bg="@firebase/installations-compat",Eg="@firebase/messaging",Cg="@firebase/messaging-compat",Ig="@firebase/performance",Tg="@firebase/performance-compat",Pg="@firebase/remote-config",Ag="@firebase/remote-config-compat",xg="@firebase/storage",Sg="@firebase/storage-compat",Vg="@firebase/firestore",Dg="@firebase/ai",Mg="@firebase/firestore-compat",Rg="firebase",Og="12.8.0";var Lo="[DEFAULT]",kg={[Fo]:"fire-core",[cg]:"fire-core-compat",[ug]:"fire-analytics",[lg]:"fire-analytics-compat",[dg]:"fire-app-check",[hg]:"fire-app-check-compat",[fg]:"fire-auth",[mg]:"fire-auth-compat",[gg]:"fire-rtdb",[pg]:"fire-data-connect",[_g]:"fire-rtdb-compat",[yg]:"fire-fn",[vg]:"fire-fn-compat",[wg]:"fire-iid",[bg]:"fire-iid-compat",[Eg]:"fire-fcm",[Cg]:"fire-fcm-compat",[Ig]:"fire-perf",[Tg]:"fire-perf-compat",[Pg]:"fire-rc",[Ag]:"fire-rc-compat",[xg]:"fire-gcs",[Sg]:"fire-gcs-compat",[Vg]:"fire-fst",[Mg]:"fire-fst-compat",[Dg]:"fire-vertex","fire-js":"fire-js",[Rg]:"fire-js-all"};var Ti=new Map,Ng=new Map,Bo=new Map;function zu(n,e){try{n.container.addComponent(e)}catch(t){pt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pr(n){let e=n.name;if(Bo.has(e))return pt.debug(`There were multiple attempts to register component ${e}.`),!1;Bo.set(e,n);for(let t of Ti.values())zu(t,n);for(let t of Ng.values())zu(t,n);return!0}function Wu(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Qu(n){return n==null?!1:n.settings!==void 0}var Fg={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lt=new Tr("app","Firebase",Fg);var Uo=class{constructor(e,t,r){this._isDeleted=!1,this._options=z({},e),this._config=z({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new gt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lt.create("app-deleted",{appName:this._name})}};var Ju=Og;function Go(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=z({name:Lo,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Lt.create("bad-app-name",{appName:String(i)});if(t||(t=Ao()),!t)throw Lt.create("no-options");let o=Ti.get(i);if(o){if(en(t,o.options)&&en(r,o.config))return o;throw Lt.create("duplicate-app",{appName:i})}let a=new Ci(i);for(let h of Bo.values())a.addComponent(h);let u=new Uo(t,r,a);return Ti.set(i,u),u}function Yu(n=Lo){let e=Ti.get(n);if(!e&&n===Lo&&Ao())return Go();if(!e)throw Lt.create("no-app",{appName:n});return e}function Bt(n,e,t){let r=kg[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){let a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pt.warn(a.join(" "));return}Pr(new gt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var Lg="firebase-heartbeat-database",Bg=1,Ar="firebase-heartbeat-store",ko=null;function Xu(){return ko||(ko=qu(Lg,Bg,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ar)}catch(t){console.warn(t)}}}}).catch(n=>{throw Lt.create("idb-open",{originalErrorMessage:n.message})})),ko}async function Ug(n){try{let t=(await Xu()).transaction(Ar),r=await t.objectStore(Ar).get(Zu(n));return await t.done,r}catch(e){if(e instanceof mt)pt.warn(e.message);else{let t=Lt.create("idb-get",{originalErrorMessage:e?.message});pt.warn(t.message)}}}async function $u(n,e){try{let r=(await Xu()).transaction(Ar,"readwrite");await r.objectStore(Ar).put(e,Zu(n)),await r.done}catch(t){if(t instanceof mt)pt.warn(t.message);else{let r=Lt.create("idb-set",{originalErrorMessage:t?.message});pt.warn(r.message)}}}function Zu(n){return`${n.name}!${n.options.appId}`}var jg=1024,qg=30,jo=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new qo(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ku();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>qg){let i=zg(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){pt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=Ku(),{heartbeatsToSend:t,unsentEntries:r}=Gg(this._heartbeatsCache.heartbeats),i=Ir(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return pt.warn(e),""}}};function Ku(){return new Date().toISOString().substring(0,10)}function Gg(n,e=jg){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Hu(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Hu(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var qo=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xo()?ku().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await Ug(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return $u(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return $u(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function Hu(n){return Ir(JSON.stringify({version:2,heartbeats:n})).length}function zg(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function $g(n){Pr(new gt("platform-logger",e=>new No(e),"PRIVATE")),Pr(new gt("heartbeat",e=>new jo(e),"PRIVATE")),Bt(Fo,Gu,n),Bt(Fo,Gu,"esm2020"),Bt("fire-js","")}$g("");var Kg="firebase",Hg="12.8.0";Bt(Kg,Hg,"app");var eh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},th={};var _t,zo;(function(){var n;function e(w,g){function _(){}_.prototype=g.prototype,w.F=g.prototype,w.prototype=new _,w.prototype.constructor=w,w.D=function(b,y,I){for(var p=Array(arguments.length-2),De=2;De<arguments.length;De++)p[De-2]=arguments[De];return g.prototype[y].apply(b,p)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,g,_){_||(_=0);let b=Array(16);if(typeof g=="string")for(var y=0;y<16;++y)b[y]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(y=0;y<16;++y)b[y]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=w.g[0],_=w.g[1],y=w.g[2];let I=w.g[3],p;p=g+(I^_&(y^I))+b[0]+3614090360&4294967295,g=_+(p<<7&4294967295|p>>>25),p=I+(y^g&(_^y))+b[1]+3905402710&4294967295,I=g+(p<<12&4294967295|p>>>20),p=y+(_^I&(g^_))+b[2]+606105819&4294967295,y=I+(p<<17&4294967295|p>>>15),p=_+(g^y&(I^g))+b[3]+3250441966&4294967295,_=y+(p<<22&4294967295|p>>>10),p=g+(I^_&(y^I))+b[4]+4118548399&4294967295,g=_+(p<<7&4294967295|p>>>25),p=I+(y^g&(_^y))+b[5]+1200080426&4294967295,I=g+(p<<12&4294967295|p>>>20),p=y+(_^I&(g^_))+b[6]+2821735955&4294967295,y=I+(p<<17&4294967295|p>>>15),p=_+(g^y&(I^g))+b[7]+4249261313&4294967295,_=y+(p<<22&4294967295|p>>>10),p=g+(I^_&(y^I))+b[8]+1770035416&4294967295,g=_+(p<<7&4294967295|p>>>25),p=I+(y^g&(_^y))+b[9]+2336552879&4294967295,I=g+(p<<12&4294967295|p>>>20),p=y+(_^I&(g^_))+b[10]+4294925233&4294967295,y=I+(p<<17&4294967295|p>>>15),p=_+(g^y&(I^g))+b[11]+2304563134&4294967295,_=y+(p<<22&4294967295|p>>>10),p=g+(I^_&(y^I))+b[12]+1804603682&4294967295,g=_+(p<<7&4294967295|p>>>25),p=I+(y^g&(_^y))+b[13]+4254626195&4294967295,I=g+(p<<12&4294967295|p>>>20),p=y+(_^I&(g^_))+b[14]+2792965006&4294967295,y=I+(p<<17&4294967295|p>>>15),p=_+(g^y&(I^g))+b[15]+1236535329&4294967295,_=y+(p<<22&4294967295|p>>>10),p=g+(y^I&(_^y))+b[1]+4129170786&4294967295,g=_+(p<<5&4294967295|p>>>27),p=I+(_^y&(g^_))+b[6]+3225465664&4294967295,I=g+(p<<9&4294967295|p>>>23),p=y+(g^_&(I^g))+b[11]+643717713&4294967295,y=I+(p<<14&4294967295|p>>>18),p=_+(I^g&(y^I))+b[0]+3921069994&4294967295,_=y+(p<<20&4294967295|p>>>12),p=g+(y^I&(_^y))+b[5]+3593408605&4294967295,g=_+(p<<5&4294967295|p>>>27),p=I+(_^y&(g^_))+b[10]+38016083&4294967295,I=g+(p<<9&4294967295|p>>>23),p=y+(g^_&(I^g))+b[15]+3634488961&4294967295,y=I+(p<<14&4294967295|p>>>18),p=_+(I^g&(y^I))+b[4]+3889429448&4294967295,_=y+(p<<20&4294967295|p>>>12),p=g+(y^I&(_^y))+b[9]+568446438&4294967295,g=_+(p<<5&4294967295|p>>>27),p=I+(_^y&(g^_))+b[14]+3275163606&4294967295,I=g+(p<<9&4294967295|p>>>23),p=y+(g^_&(I^g))+b[3]+4107603335&4294967295,y=I+(p<<14&4294967295|p>>>18),p=_+(I^g&(y^I))+b[8]+1163531501&4294967295,_=y+(p<<20&4294967295|p>>>12),p=g+(y^I&(_^y))+b[13]+2850285829&4294967295,g=_+(p<<5&4294967295|p>>>27),p=I+(_^y&(g^_))+b[2]+4243563512&4294967295,I=g+(p<<9&4294967295|p>>>23),p=y+(g^_&(I^g))+b[7]+1735328473&4294967295,y=I+(p<<14&4294967295|p>>>18),p=_+(I^g&(y^I))+b[12]+2368359562&4294967295,_=y+(p<<20&4294967295|p>>>12),p=g+(_^y^I)+b[5]+4294588738&4294967295,g=_+(p<<4&4294967295|p>>>28),p=I+(g^_^y)+b[8]+2272392833&4294967295,I=g+(p<<11&4294967295|p>>>21),p=y+(I^g^_)+b[11]+1839030562&4294967295,y=I+(p<<16&4294967295|p>>>16),p=_+(y^I^g)+b[14]+4259657740&4294967295,_=y+(p<<23&4294967295|p>>>9),p=g+(_^y^I)+b[1]+2763975236&4294967295,g=_+(p<<4&4294967295|p>>>28),p=I+(g^_^y)+b[4]+1272893353&4294967295,I=g+(p<<11&4294967295|p>>>21),p=y+(I^g^_)+b[7]+4139469664&4294967295,y=I+(p<<16&4294967295|p>>>16),p=_+(y^I^g)+b[10]+3200236656&4294967295,_=y+(p<<23&4294967295|p>>>9),p=g+(_^y^I)+b[13]+681279174&4294967295,g=_+(p<<4&4294967295|p>>>28),p=I+(g^_^y)+b[0]+3936430074&4294967295,I=g+(p<<11&4294967295|p>>>21),p=y+(I^g^_)+b[3]+3572445317&4294967295,y=I+(p<<16&4294967295|p>>>16),p=_+(y^I^g)+b[6]+76029189&4294967295,_=y+(p<<23&4294967295|p>>>9),p=g+(_^y^I)+b[9]+3654602809&4294967295,g=_+(p<<4&4294967295|p>>>28),p=I+(g^_^y)+b[12]+3873151461&4294967295,I=g+(p<<11&4294967295|p>>>21),p=y+(I^g^_)+b[15]+530742520&4294967295,y=I+(p<<16&4294967295|p>>>16),p=_+(y^I^g)+b[2]+3299628645&4294967295,_=y+(p<<23&4294967295|p>>>9),p=g+(y^(_|~I))+b[0]+4096336452&4294967295,g=_+(p<<6&4294967295|p>>>26),p=I+(_^(g|~y))+b[7]+1126891415&4294967295,I=g+(p<<10&4294967295|p>>>22),p=y+(g^(I|~_))+b[14]+2878612391&4294967295,y=I+(p<<15&4294967295|p>>>17),p=_+(I^(y|~g))+b[5]+4237533241&4294967295,_=y+(p<<21&4294967295|p>>>11),p=g+(y^(_|~I))+b[12]+1700485571&4294967295,g=_+(p<<6&4294967295|p>>>26),p=I+(_^(g|~y))+b[3]+2399980690&4294967295,I=g+(p<<10&4294967295|p>>>22),p=y+(g^(I|~_))+b[10]+4293915773&4294967295,y=I+(p<<15&4294967295|p>>>17),p=_+(I^(y|~g))+b[1]+2240044497&4294967295,_=y+(p<<21&4294967295|p>>>11),p=g+(y^(_|~I))+b[8]+1873313359&4294967295,g=_+(p<<6&4294967295|p>>>26),p=I+(_^(g|~y))+b[15]+4264355552&4294967295,I=g+(p<<10&4294967295|p>>>22),p=y+(g^(I|~_))+b[6]+2734768916&4294967295,y=I+(p<<15&4294967295|p>>>17),p=_+(I^(y|~g))+b[13]+1309151649&4294967295,_=y+(p<<21&4294967295|p>>>11),p=g+(y^(_|~I))+b[4]+4149444226&4294967295,g=_+(p<<6&4294967295|p>>>26),p=I+(_^(g|~y))+b[11]+3174756917&4294967295,I=g+(p<<10&4294967295|p>>>22),p=y+(g^(I|~_))+b[2]+718787259&4294967295,y=I+(p<<15&4294967295|p>>>17),p=_+(I^(y|~g))+b[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(y+(p<<21&4294967295|p>>>11))&4294967295,w.g[2]=w.g[2]+y&4294967295,w.g[3]=w.g[3]+I&4294967295}r.prototype.v=function(w,g){g===void 0&&(g=w.length);let _=g-this.blockSize,b=this.C,y=this.h,I=0;for(;I<g;){if(y==0)for(;I<=_;)i(this,w,I),I+=this.blockSize;if(typeof w=="string"){for(;I<g;)if(b[y++]=w.charCodeAt(I++),y==this.blockSize){i(this,b),y=0;break}}else for(;I<g;)if(b[y++]=w[I++],y==this.blockSize){i(this,b),y=0;break}}this.h=y,this.o+=g},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;g=this.o*8;for(var _=w.length-8;_<w.length;++_)w[_]=g&255,g/=256;for(this.v(w),w=Array(16),g=0,_=0;_<4;++_)for(let b=0;b<32;b+=8)w[g++]=this.g[_]>>>b&255;return w};function o(w,g){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=g(w)}function a(w,g){this.h=g;let _=[],b=!0;for(let y=w.length-1;y>=0;y--){let I=w[y]|0;b&&I==g||(_[y]=I,b=!1)}this.g=_}var u={};function h(w){return-128<=w&&w<128?o(w,function(g){return new a([g|0],g<0?-1:0)}):new a([w|0],w<0?-1:0)}function f(w){if(isNaN(w)||!isFinite(w))return v;if(w<0)return M(f(-w));let g=[],_=1;for(let b=0;w>=_;b++)g[b]=w/_|0,_*=4294967296;return new a(g,0)}function m(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return M(m(w.substring(1),g));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');let _=f(Math.pow(g,8)),b=v;for(let I=0;I<w.length;I+=8){var y=Math.min(8,w.length-I);let p=parseInt(w.substring(I,I+y),g);y<8?(y=f(Math.pow(g,y)),b=b.j(y).add(f(p))):(b=b.j(_),b=b.add(f(p)))}return b}var v=h(0),C=h(1),x=h(16777216);n=a.prototype,n.m=function(){if(F(this))return-M(this).m();let w=0,g=1;for(let _=0;_<this.g.length;_++){let b=this.i(_);w+=(b>=0?b:4294967296+b)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(V(this))return"0";if(F(this))return"-"+M(this).toString(w);let g=f(Math.pow(w,6));var _=this;let b="";for(;;){let y=ke(_,g).g;_=J(_,y.j(g));let I=((_.g.length>0?_.g[0]:_.h)>>>0).toString(w);if(_=y,V(_))return I+b;for(;I.length<6;)I="0"+I;b=I+b}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function V(w){if(w.h!=0)return!1;for(let g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function F(w){return w.h==-1}n.l=function(w){return w=J(this,w),F(w)?-1:V(w)?0:1};function M(w){let g=w.g.length,_=[];for(let b=0;b<g;b++)_[b]=~w.g[b];return new a(_,~w.h).add(C)}n.abs=function(){return F(this)?M(this):this},n.add=function(w){let g=Math.max(this.g.length,w.g.length),_=[],b=0;for(let y=0;y<=g;y++){let I=b+(this.i(y)&65535)+(w.i(y)&65535),p=(I>>>16)+(this.i(y)>>>16)+(w.i(y)>>>16);b=p>>>16,I&=65535,p&=65535,_[y]=p<<16|I}return new a(_,_[_.length-1]&-2147483648?-1:0)};function J(w,g){return w.add(M(g))}n.j=function(w){if(V(this)||V(w))return v;if(F(this))return F(w)?M(this).j(M(w)):M(M(this).j(w));if(F(w))return M(this.j(M(w)));if(this.l(x)<0&&w.l(x)<0)return f(this.m()*w.m());let g=this.g.length+w.g.length,_=[];for(var b=0;b<2*g;b++)_[b]=0;for(b=0;b<this.g.length;b++)for(let y=0;y<w.g.length;y++){let I=this.i(b)>>>16,p=this.i(b)&65535,De=w.i(y)>>>16,At=w.i(y)&65535;_[2*b+2*y]+=p*At,X(_,2*b+2*y),_[2*b+2*y+1]+=I*At,X(_,2*b+2*y+1),_[2*b+2*y+1]+=p*De,X(_,2*b+2*y+1),_[2*b+2*y+2]+=I*De,X(_,2*b+2*y+2)}for(w=0;w<g;w++)_[w]=_[2*w+1]<<16|_[2*w];for(w=g;w<2*g;w++)_[w]=0;return new a(_,0)};function X(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function ee(w,g){this.g=w,this.h=g}function ke(w,g){if(V(g))throw Error("division by zero");if(V(w))return new ee(v,v);if(F(w))return g=ke(M(w),g),new ee(M(g.g),M(g.h));if(F(g))return g=ke(w,M(g)),new ee(M(g.g),g.h);if(w.g.length>30){if(F(w)||F(g))throw Error("slowDivide_ only works with positive integers.");for(var _=C,b=g;b.l(w)<=0;)_=ze(_),b=ze(b);var y=be(_,1),I=be(b,1);for(b=be(b,2),_=be(_,2);!V(b);){var p=I.add(b);p.l(w)<=0&&(y=y.add(_),I=p),b=be(b,1),_=be(_,1)}return g=J(w,y.j(g)),new ee(y,g)}for(y=v;w.l(g)>=0;){for(_=Math.max(1,Math.floor(w.m()/g.m())),b=Math.ceil(Math.log(_)/Math.LN2),b=b<=48?1:Math.pow(2,b-48),I=f(_),p=I.j(g);F(p)||p.l(w)>0;)_-=b,I=f(_),p=I.j(g);V(I)&&(I=C),y=y.add(I),w=J(w,p)}return new ee(y,w)}n.B=function(w){return ke(this,w).h},n.and=function(w){let g=Math.max(this.g.length,w.g.length),_=[];for(let b=0;b<g;b++)_[b]=this.i(b)&w.i(b);return new a(_,this.h&w.h)},n.or=function(w){let g=Math.max(this.g.length,w.g.length),_=[];for(let b=0;b<g;b++)_[b]=this.i(b)|w.i(b);return new a(_,this.h|w.h)},n.xor=function(w){let g=Math.max(this.g.length,w.g.length),_=[];for(let b=0;b<g;b++)_[b]=this.i(b)^w.i(b);return new a(_,this.h^w.h)};function ze(w){let g=w.g.length+1,_=[];for(let b=0;b<g;b++)_[b]=w.i(b)<<1|w.i(b-1)>>>31;return new a(_,w.h)}function be(w,g){let _=g>>5;g%=32;let b=w.g.length-_,y=[];for(let I=0;I<b;I++)y[I]=g>0?w.i(I+_)>>>g|w.i(I+_+1)<<32-g:w.i(I+_);return new a(y,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,zo=th.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=f,a.fromString=m,_t=th.Integer=a}).apply(typeof eh<"u"?eh:typeof self<"u"?self:typeof window<"u"?window:{});var Pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yt={};var $o,Wg,Cn,Ko,xr,Ai,Ho,Wo,Qo;(function(){var n,e=Object.defineProperty;function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pi=="object"&&Pi];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var d=0;d<s.length-1;d++){var E=s[d];if(!(E in l))break e;l=l[E]}s=s[s.length-1],d=l[s],c=c(d),c!=d&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}i("Symbol.dispose",function(s){return s||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(s){return s||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(s){return s||function(c){var l=[],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&l.push([d,c[d]]);return l}});var o=o||{},a=this||self;function u(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function h(s,c,l){return s.call.apply(s.bind,arguments)}function f(s,c,l){return f=h,f.apply(null,arguments)}function m(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var d=l.slice();return d.push.apply(d,arguments),s.apply(this,d)}}function v(s,c){function l(){}l.prototype=c.prototype,s.Z=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Ob=function(d,E,T){for(var S=Array(arguments.length-2),G=2;G<arguments.length;G++)S[G-2]=arguments[G];return c.prototype[E].apply(d,S)}}var C=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?s=>s&&AsyncContext.Snapshot.wrap(s):s=>s;function x(s){let c=s.length;if(c>0){let l=Array(c);for(let d=0;d<c;d++)l[d]=s[d];return l}return[]}function V(s,c){for(let d=1;d<arguments.length;d++){let E=arguments[d];var l=typeof E;if(l=l!="object"?l:E?Array.isArray(E)?"array":l:"null",l=="array"||l=="object"&&typeof E.length=="number"){l=s.length||0;let T=E.length||0;s.length=l+T;for(let S=0;S<T;S++)s[l+S]=E[S]}else s.push(E)}}class F{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return this.h>0?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function M(s){a.setTimeout(()=>{throw s},0)}function J(){var s=w;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class X{constructor(){this.h=this.g=null}add(c,l){let d=ee.get();d.set(c,l),this.h?this.h.next=d:this.g=d,this.h=d}}var ee=new F(()=>new ke,s=>s.reset());class ke{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let ze,be=!1,w=new X,g=()=>{let s=Promise.resolve(void 0);ze=()=>{s.then(_)}};function _(){for(var s;s=J();){try{s.h.call(s.g)}catch(l){M(l)}var c=ee;c.j(s),c.h<100&&(c.h++,s.next=c.g,c.g=s)}be=!1}function b(){this.u=this.u,this.C=this.C}b.prototype.u=!1,b.prototype.dispose=function(){this.u||(this.u=!0,this.N())},b.prototype[Symbol.dispose]=function(){this.dispose()},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function y(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}y.prototype.h=function(){this.defaultPrevented=!0};var I=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};a.addEventListener("test",l,c),a.removeEventListener("test",l,c)}catch{}return s})();function p(s){return/^[\s\xa0]*$/.test(s)}function De(s,c){y.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s&&this.init(s,c)}v(De,y),De.prototype.init=function(s,c){let l=this.type=s.type,d=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget,c||(l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement)),this.relatedTarget=c,d?(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=s.pointerType,this.state=s.state,this.i=s,s.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);let s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var At="closure_listenable_"+(Math.random()*1e6|0),em=0;function tm(s,c,l,d,E){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!d,this.ha=E,this.key=++em,this.da=this.fa=!1}function ti(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function ni(s,c,l){for(let d in s)c.call(l,s[d],d,s)}function nm(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function hl(s){let c={};for(let l in s)c[l]=s[l];return c}let dl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fl(s,c){let l,d;for(let E=1;E<arguments.length;E++){d=arguments[E];for(l in d)s[l]=d[l];for(let T=0;T<dl.length;T++)l=dl[T],Object.prototype.hasOwnProperty.call(d,l)&&(s[l]=d[l])}}function ri(s){this.src=s,this.g={},this.h=0}ri.prototype.add=function(s,c,l,d,E){let T=s.toString();s=this.g[T],s||(s=this.g[T]=[],this.h++);let S=Gs(s,c,d,E);return S>-1?(c=s[S],l||(c.fa=!1)):(c=new tm(c,this.src,T,!!d,E),c.fa=l,s.push(c)),c};function qs(s,c){let l=c.type;if(l in s.g){var d=s.g[l],E=Array.prototype.indexOf.call(d,c,void 0),T;(T=E>=0)&&Array.prototype.splice.call(d,E,1),T&&(ti(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function Gs(s,c,l,d){for(let E=0;E<s.length;++E){let T=s[E];if(!T.da&&T.listener==c&&T.capture==!!l&&T.ha==d)return E}return-1}var zs="closure_lm_"+(Math.random()*1e6|0),$s={};function ml(s,c,l,d,E){if(d&&d.once)return pl(s,c,l,d,E);if(Array.isArray(c)){for(let T=0;T<c.length;T++)ml(s,c[T],l,d,E);return null}return l=Qs(l),s&&s[At]?s.J(c,l,u(d)?!!d.capture:!!d,E):gl(s,c,l,!1,d,E)}function gl(s,c,l,d,E,T){if(!c)throw Error("Invalid event type");let S=u(E)?!!E.capture:!!E,G=Hs(s);if(G||(s[zs]=G=new ri(s)),l=G.add(c,l,d,S,T),l.proxy)return l;if(d=rm(),l.proxy=d,d.src=s,d.listener=l,s.addEventListener)I||(E=S),E===void 0&&(E=!1),s.addEventListener(c.toString(),d,E);else if(s.attachEvent)s.attachEvent(yl(c.toString()),d);else if(s.addListener&&s.removeListener)s.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return l}function rm(){function s(l){return c.call(s.src,s.listener,l)}let c=im;return s}function pl(s,c,l,d,E){if(Array.isArray(c)){for(let T=0;T<c.length;T++)pl(s,c[T],l,d,E);return null}return l=Qs(l),s&&s[At]?s.K(c,l,u(d)?!!d.capture:!!d,E):gl(s,c,l,!0,d,E)}function _l(s,c,l,d,E){if(Array.isArray(c))for(var T=0;T<c.length;T++)_l(s,c[T],l,d,E);else d=u(d)?!!d.capture:!!d,l=Qs(l),s&&s[At]?(s=s.i,T=String(c).toString(),T in s.g&&(c=s.g[T],l=Gs(c,l,d,E),l>-1&&(ti(c[l]),Array.prototype.splice.call(c,l,1),c.length==0&&(delete s.g[T],s.h--)))):s&&(s=Hs(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Gs(c,l,d,E)),(l=s>-1?c[s]:null)&&Ks(l))}function Ks(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[At])qs(c.i,s);else{var l=s.type,d=s.proxy;c.removeEventListener?c.removeEventListener(l,d,s.capture):c.detachEvent?c.detachEvent(yl(l),d):c.addListener&&c.removeListener&&c.removeListener(d),(l=Hs(c))?(qs(l,s),l.h==0&&(l.src=null,c[zs]=null)):ti(s)}}}function yl(s){return s in $s?$s[s]:$s[s]="on"+s}function im(s,c){if(s.da)s=!0;else{c=new De(c,this);let l=s.listener,d=s.ha||s.src;s.fa&&Ks(s),s=l.call(d,c)}return s}function Hs(s){return s=s[zs],s instanceof ri?s:null}var Ws="__closure_events_fn_"+(Math.random()*1e9>>>0);function Qs(s){return typeof s=="function"?s:(s[Ws]||(s[Ws]=function(c){return s.handleEvent(c)}),s[Ws])}function Ie(){b.call(this),this.i=new ri(this),this.M=this,this.G=null}v(Ie,b),Ie.prototype[At]=!0,Ie.prototype.removeEventListener=function(s,c,l,d){_l(this,s,c,l,d)};function xe(s,c){var l,d=s.G;if(d)for(l=[];d;d=d.G)l.push(d);if(s=s.M,d=c.type||c,typeof c=="string")c=new y(c,s);else if(c instanceof y)c.target=c.target||s;else{var E=c;c=new y(d,s),fl(c,E)}E=!0;let T,S;if(l)for(S=l.length-1;S>=0;S--)T=c.g=l[S],E=ii(T,d,!0,c)&&E;if(T=c.g=s,E=ii(T,d,!0,c)&&E,E=ii(T,d,!1,c)&&E,l)for(S=0;S<l.length;S++)T=c.g=l[S],E=ii(T,d,!1,c)&&E}Ie.prototype.N=function(){if(Ie.Z.N.call(this),this.i){var s=this.i;for(let c in s.g){let l=s.g[c];for(let d=0;d<l.length;d++)ti(l[d]);delete s.g[c],s.h--}}this.G=null},Ie.prototype.J=function(s,c,l,d){return this.i.add(String(s),c,!1,l,d)},Ie.prototype.K=function(s,c,l,d){return this.i.add(String(s),c,!0,l,d)};function ii(s,c,l,d){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();let E=!0;for(let T=0;T<c.length;++T){let S=c[T];if(S&&!S.da&&S.capture==l){let G=S.listener,ge=S.ha||S.src;S.fa&&qs(s.i,S),E=G.call(ge,d)!==!1&&E}}return E&&!d.defaultPrevented}function sm(s,c){if(typeof s!="function")if(s&&typeof s.handleEvent=="function")s=f(s.handleEvent,s);else throw Error("Invalid listener argument");return Number(c)>2147483647?-1:a.setTimeout(s,c||0)}function vl(s){s.g=sm(()=>{s.g=null,s.i&&(s.i=!1,vl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class om extends b{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:vl(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ir(s){b.call(this),this.h=s,this.g={}}v(ir,b);var wl=[];function bl(s){ni(s.g,function(c,l){this.g.hasOwnProperty(l)&&Ks(c)},s),s.g={}}ir.prototype.N=function(){ir.Z.N.call(this),bl(this)},ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Js=a.JSON.stringify,am=a.JSON.parse,cm=class{stringify(s){return a.JSON.stringify(s,void 0)}parse(s){return a.JSON.parse(s,void 0)}};function El(){}function Cl(){}var sr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ys(){y.call(this,"d")}v(Ys,y);function Xs(){y.call(this,"c")}v(Xs,y);var Ht={},Il=null;function si(){return Il=Il||new Ie}Ht.Ia="serverreachability";function Tl(s){y.call(this,Ht.Ia,s)}v(Tl,y);function or(s){let c=si();xe(c,new Tl(c))}Ht.STAT_EVENT="statevent";function Pl(s,c){y.call(this,Ht.STAT_EVENT,s),this.stat=c}v(Pl,y);function Se(s){let c=si();xe(c,new Pl(c,s))}Ht.Ja="timingevent";function Al(s,c){y.call(this,Ht.Ja,s),this.size=c}v(Al,y);function ar(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){s()},c)}function cr(){this.g=!0}cr.prototype.ua=function(){this.g=!1};function lm(s,c,l,d,E,T){s.info(function(){if(s.g)if(T){var S="",G=T.split("&");for(let Z=0;Z<G.length;Z++){var ge=G[Z].split("=");if(ge.length>1){let pe=ge[0];ge=ge[1];let Je=pe.split("_");S=Je.length>=2&&Je[1]=="type"?S+(pe+"="+ge+"&"):S+(pe+"=redacted&")}}}else S=null;else S=T;return"XMLHTTP REQ ("+d+") [attempt "+E+"]: "+c+`
`+l+`
`+S})}function um(s,c,l,d,E,T,S){s.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+E+"]: "+c+`
`+l+`
`+T+" "+S})}function _n(s,c,l,d){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+dm(s,l)+(d?" "+d:"")})}function hm(s,c){s.info(function(){return"TIMEOUT: "+c})}cr.prototype.info=function(){};function dm(s,c){if(!s.g)return c;if(!c)return null;try{let T=JSON.parse(c);if(T){for(s=0;s<T.length;s++)if(Array.isArray(T[s])){var l=T[s];if(!(l.length<2)){var d=l[1];if(Array.isArray(d)&&!(d.length<1)){var E=d[0];if(E!="noop"&&E!="stop"&&E!="close")for(let S=1;S<d.length;S++)d[S]=""}}}}return Js(T)}catch{return c}}var oi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Sl;function Zs(){}v(Zs,El),Zs.prototype.g=function(){return new XMLHttpRequest},Sl=new Zs;function lr(s){return encodeURIComponent(String(s))}function fm(s){var c=1;s=s.split(":");let l=[];for(;c>0&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function xt(s,c,l,d){this.j=s,this.i=c,this.l=l,this.S=d||1,this.V=new ir(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Vl}function Vl(){this.i=null,this.g="",this.h=!1}var Dl={},eo={};function to(s,c,l){s.M=1,s.A=ci(Qe(c)),s.u=l,s.R=!0,Ml(s,null)}function Ml(s,c){s.F=Date.now(),ai(s),s.B=Qe(s.A);var l=s.B,d=s.S;Array.isArray(d)||(d=[String(d)]),$l(l.i,"t",d),s.C=0,l=s.j.L,s.h=new Vl,s.g=lu(s.j,l?c:null,!s.u),s.P>0&&(s.O=new om(f(s.Y,s,s.g),s.P)),c=s.V,l=s.g,d=s.ba;var E="readystatechange";Array.isArray(E)||(E&&(wl[0]=E.toString()),E=wl);for(let T=0;T<E.length;T++){let S=ml(l,E[T],d||c.handleEvent,!1,c.h||c);if(!S)break;c.g[S.key]=S}c=s.J?hl(s.J):{},s.u?(s.v||(s.v="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.B,s.v,s.u,c)):(s.v="GET",s.g.ea(s.B,s.v,null,c)),or(),lm(s.i,s.v,s.B,s.l,s.S,s.u)}xt.prototype.ba=function(s){s=s.target;let c=this.O;c&&Dt(s)==3?c.j():this.Y(s)},xt.prototype.Y=function(s){try{if(s==this.g)e:{let G=Dt(this.g),ge=this.g.ya(),Z=this.g.ca();if(!(G<3)&&(G!=3||this.g&&(this.h.h||this.g.la()||Xl(this.g)))){this.K||G!=4||ge==7||(ge==8||Z<=0?or(3):or(2)),no(this);var c=this.g.ca();this.X=c;var l=mm(this);if(this.o=c==200,um(this.i,this.v,this.B,this.l,this.S,G,c),this.o){if(this.U&&!this.L){t:{if(this.g){var d,E=this.g;if((d=E.g?E.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(d)){var T=d;break t}}T=null}if(s=T)_n(this.i,this.l,s,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ro(this,s);else{this.o=!1,this.m=3,Se(12),Wt(this),ur(this);break e}}if(this.R){s=!0;let pe;for(;!this.K&&this.C<l.length;)if(pe=gm(this,l),pe==eo){G==4&&(this.m=4,Se(14),s=!1),_n(this.i,this.l,null,"[Incomplete Response]");break}else if(pe==Dl){this.m=4,Se(15),_n(this.i,this.l,l,"[Invalid Chunk]"),s=!1;break}else _n(this.i,this.l,pe,null),ro(this,pe);if(Rl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),G!=4||l.length!=0||this.h.h||(this.m=1,Se(16),s=!1),this.o=this.o&&s,!s)_n(this.i,this.l,l,"[Invalid Chunked Response]"),Wt(this),ur(this);else if(l.length>0&&!this.W){this.W=!0;var S=this.j;S.g==this&&S.aa&&!S.P&&(S.j.info("Great, no buffering proxy detected. Bytes received: "+l.length),uo(S),S.P=!0,Se(11))}}else _n(this.i,this.l,l,null),ro(this,l);G==4&&Wt(this),this.o&&!this.K&&(G==4?su(this.j,this):(this.o=!1,ai(this)))}else Sm(this.g),c==400&&l.indexOf("Unknown SID")>0?(this.m=3,Se(12)):(this.m=0,Se(13)),Wt(this),ur(this)}}}catch{}};function mm(s){if(!Rl(s))return s.g.la();let c=Xl(s.g);if(c==="")return"";let l="",d=c.length,E=Dt(s.g)==4;if(!s.h.i){if(typeof TextDecoder>"u")return Wt(s),ur(s),"";s.h.i=new a.TextDecoder}for(let T=0;T<d;T++)s.h.h=!0,l+=s.h.i.decode(c[T],{stream:!(E&&T==d-1)});return c.length=0,s.h.g+=l,s.C=0,s.h.g}function Rl(s){return s.g?s.v=="GET"&&s.M!=2&&s.j.Aa:!1}function gm(s,c){var l=s.C,d=c.indexOf(`
`,l);return d==-1?eo:(l=Number(c.substring(l,d)),isNaN(l)?Dl:(d+=1,d+l>c.length?eo:(c=c.slice(d,d+l),s.C=d+l,c)))}xt.prototype.cancel=function(){this.K=!0,Wt(this)};function ai(s){s.T=Date.now()+s.H,Ol(s,s.H)}function Ol(s,c){if(s.D!=null)throw Error("WatchDog timer not null");s.D=ar(f(s.aa,s),c)}function no(s){s.D&&(a.clearTimeout(s.D),s.D=null)}xt.prototype.aa=function(){this.D=null;let s=Date.now();s-this.T>=0?(hm(this.i,this.B),this.M!=2&&(or(),Se(17)),Wt(this),this.m=2,ur(this)):Ol(this,this.T-s)};function ur(s){s.j.I==0||s.K||su(s.j,s)}function Wt(s){no(s);var c=s.O;c&&typeof c.dispose=="function"&&c.dispose(),s.O=null,bl(s.V),s.g&&(c=s.g,s.g=null,c.abort(),c.dispose())}function ro(s,c){try{var l=s.j;if(l.I!=0&&(l.g==s||io(l.h,s))){if(!s.L&&io(l.h,s)&&l.I==3){try{var d=l.Ba.g.parse(c)}catch{d=null}if(Array.isArray(d)&&d.length==3){var E=d;if(E[0]==0){e:if(!l.v){if(l.g)if(l.g.F+3e3<s.F)mi(l),di(l);else break e;lo(l),Se(18)}}else l.xa=E[1],0<l.xa-l.K&&E[2]<37500&&l.F&&l.A==0&&!l.C&&(l.C=ar(f(l.Va,l),6e3));Fl(l.h)<=1&&l.ta&&(l.ta=void 0)}else Jt(l,11)}else if((s.L||l.g==s)&&mi(l),!p(c))for(E=l.Ba.g.parse(c),c=0;c<E.length;c++){let Z=E[c],pe=Z[0];if(!(pe<=l.K))if(l.K=pe,Z=Z[1],l.I==2)if(Z[0]=="c"){l.M=Z[1],l.ba=Z[2];let Je=Z[3];Je!=null&&(l.ka=Je,l.j.info("VER="+l.ka));let Yt=Z[4];Yt!=null&&(l.za=Yt,l.j.info("SVER="+l.za));let Mt=Z[5];Mt!=null&&typeof Mt=="number"&&Mt>0&&(d=1.5*Mt,l.O=d,l.j.info("backChannelRequestTimeoutMs_="+d)),d=l;let Rt=s.g;if(Rt){let pi=Rt.g?Rt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pi){var T=d.h;T.g||pi.indexOf("spdy")==-1&&pi.indexOf("quic")==-1&&pi.indexOf("h2")==-1||(T.j=T.l,T.g=new Set,T.h&&(so(T,T.h),T.h=null))}if(d.G){let ho=Rt.g?Rt.g.getResponseHeader("X-HTTP-Session-Id"):null;ho&&(d.wa=ho,te(d.J,d.G,ho))}}l.I=3,l.l&&l.l.ra(),l.aa&&(l.T=Date.now()-s.F,l.j.info("Handshake RTT: "+l.T+"ms")),d=l;var S=s;if(d.na=cu(d,d.L?d.ba:null,d.W),S.L){Ll(d.h,S);var G=S,ge=d.O;ge&&(G.H=ge),G.D&&(no(G),ai(G)),d.g=S}else ru(d);l.i.length>0&&fi(l)}else Z[0]!="stop"&&Z[0]!="close"||Jt(l,7);else l.I==3&&(Z[0]=="stop"||Z[0]=="close"?Z[0]=="stop"?Jt(l,7):co(l):Z[0]!="noop"&&l.l&&l.l.qa(Z),l.A=0)}}or(4)}catch{}}var pm=class{constructor(s,c){this.g=s,this.map=c}};function kl(s){this.l=s||10,a.PerformanceNavigationTiming?(s=a.performance.getEntriesByType("navigation"),s=s.length>0&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Nl(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Fl(s){return s.h?1:s.g?s.g.size:0}function io(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function so(s,c){s.g?s.g.add(c):s.h=c}function Ll(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}kl.prototype.cancel=function(){if(this.i=Bl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Bl(s){if(s.h!=null)return s.i.concat(s.h.G);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.G);return c}return x(s.i)}var Ul=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _m(s,c){if(s){s=s.split("&");for(let l=0;l<s.length;l++){let d=s[l].indexOf("="),E,T=null;d>=0?(E=s[l].substring(0,d),T=s[l].substring(d+1)):E=s[l],c(E,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function St(s){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let c;s instanceof St?(this.l=s.l,hr(this,s.j),this.o=s.o,this.g=s.g,dr(this,s.u),this.h=s.h,oo(this,Kl(s.i)),this.m=s.m):s&&(c=String(s).match(Ul))?(this.l=!1,hr(this,c[1]||"",!0),this.o=fr(c[2]||""),this.g=fr(c[3]||"",!0),dr(this,c[4]),this.h=fr(c[5]||"",!0),oo(this,c[6]||"",!0),this.m=fr(c[7]||"")):(this.l=!1,this.i=new gr(null,this.l))}St.prototype.toString=function(){let s=[];var c=this.j;c&&s.push(mr(c,jl,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(mr(c,jl,!0),"@"),s.push(lr(l).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.u,l!=null&&s.push(":",String(l))),(l=this.h)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(mr(l,l.charAt(0)=="/"?wm:vm,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",mr(l,Em)),s.join("")},St.prototype.resolve=function(s){let c=Qe(this),l=!!s.j;l?hr(c,s.j):l=!!s.o,l?c.o=s.o:l=!!s.g,l?c.g=s.g:l=s.u!=null;var d=s.h;if(l)dr(c,s.u);else if(l=!!s.h){if(d.charAt(0)!="/")if(this.g&&!this.h)d="/"+d;else{var E=c.h.lastIndexOf("/");E!=-1&&(d=c.h.slice(0,E+1)+d)}if(E=d,E==".."||E==".")d="";else if(E.indexOf("./")!=-1||E.indexOf("/.")!=-1){d=E.lastIndexOf("/",0)==0,E=E.split("/");let T=[];for(let S=0;S<E.length;){let G=E[S++];G=="."?d&&S==E.length&&T.push(""):G==".."?((T.length>1||T.length==1&&T[0]!="")&&T.pop(),d&&S==E.length&&T.push("")):(T.push(G),d=!0)}d=T.join("/")}else d=E}return l?c.h=d:l=s.i.toString()!=="",l?oo(c,Kl(s.i)):l=!!s.m,l&&(c.m=s.m),c};function Qe(s){return new St(s)}function hr(s,c,l){s.j=l?fr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function dr(s,c){if(c){if(c=Number(c),isNaN(c)||c<0)throw Error("Bad port number "+c);s.u=c}else s.u=null}function oo(s,c,l){c instanceof gr?(s.i=c,Cm(s.i,s.l)):(l||(c=mr(c,bm)),s.i=new gr(c,s.l))}function te(s,c,l){s.i.set(c,l)}function ci(s){return te(s,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),s}function fr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function mr(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,ym),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function ym(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var jl=/[#\/\?@]/g,vm=/[#\?:]/g,wm=/[#\?]/g,bm=/[#\?@]/g,Em=/#/g;function gr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Qt(s){s.g||(s.g=new Map,s.h=0,s.i&&_m(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=gr.prototype,n.add=function(s,c){Qt(this),this.i=null,s=yn(this,s);let l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function ql(s,c){Qt(s),c=yn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Gl(s,c){return Qt(s),c=yn(s,c),s.g.has(c)}n.forEach=function(s,c){Qt(this),this.g.forEach(function(l,d){l.forEach(function(E){s.call(c,E,d,this)},this)},this)};function zl(s,c){Qt(s);let l=[];if(typeof c=="string")Gl(s,c)&&(l=l.concat(s.g.get(yn(s,c))));else for(s=Array.from(s.g.values()),c=0;c<s.length;c++)l=l.concat(s[c]);return l}n.set=function(s,c){return Qt(this),this.i=null,s=yn(this,s),Gl(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=zl(this,s),s.length>0?String(s[0]):c):c};function $l(s,c,l){ql(s,c),l.length>0&&(s.i=null,s.g.set(yn(s,c),x(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(let d=0;d<c.length;d++){var l=c[d];let E=lr(l);l=zl(this,l);for(let T=0;T<l.length;T++){let S=E;l[T]!==""&&(S+="="+lr(l[T])),s.push(S)}}return this.i=s.join("&")};function Kl(s){let c=new gr;return c.i=s.i,s.g&&(c.g=new Map(s.g),c.h=s.h),c}function yn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Cm(s,c){c&&!s.j&&(Qt(s),s.i=null,s.g.forEach(function(l,d){let E=d.toLowerCase();d!=E&&(ql(this,d),$l(this,E,l))},s)),s.j=c}function Im(s,c){let l=new cr;if(a.Image){let d=new Image;d.onload=m(Vt,l,"TestLoadImage: loaded",!0,c,d),d.onerror=m(Vt,l,"TestLoadImage: error",!1,c,d),d.onabort=m(Vt,l,"TestLoadImage: abort",!1,c,d),d.ontimeout=m(Vt,l,"TestLoadImage: timeout",!1,c,d),a.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=s}else c(!1)}function Tm(s,c){let l=new cr,d=new AbortController,E=setTimeout(()=>{d.abort(),Vt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:d.signal}).then(T=>{clearTimeout(E),T.ok?Vt(l,"TestPingServer: ok",!0,c):Vt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(E),Vt(l,"TestPingServer: error",!1,c)})}function Vt(s,c,l,d,E){try{E&&(E.onload=null,E.onerror=null,E.onabort=null,E.ontimeout=null),d(l)}catch{}}function Pm(){this.g=new cm}function li(s){this.i=s.Sb||null,this.h=s.ab||!1}v(li,El),li.prototype.g=function(){return new ui(this.i,this.h)};function ui(s,c){Ie.call(this),this.H=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ui,Ie),n=ui.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=s,this.D=c,this.readyState=1,_r(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let c={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};s&&(c.body=s),(this.H||a).fetch(new Request(this.D,c)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,pr(this)),this.readyState=0},n.Pa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,_r(this)),this.g&&(this.readyState=3,_r(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Hl(this)}else s.text().then(this.Oa.bind(this),this.ga.bind(this))};function Hl(s){s.j.read().then(s.Ma.bind(s)).catch(s.ga.bind(s))}n.Ma=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.B.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?pr(this):_r(this),this.readyState==3&&Hl(this)}},n.Oa=function(s){this.g&&(this.response=this.responseText=s,pr(this))},n.Na=function(s){this.g&&(this.response=s,pr(this))},n.ga=function(){this.g&&pr(this)};function pr(s){s.readyState=4,s.l=null,s.j=null,s.B=null,_r(s)}n.setRequestHeader=function(s,c){this.A.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function _r(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(ui.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Wl(s){let c="";return ni(s,function(l,d){c+=d,c+=":",c+=l,c+=`\r
`}),c}function ao(s,c,l){e:{for(d in l){var d=!1;break e}d=!0}d||(l=Wl(l),typeof s=="string"?l!=null&&lr(l):te(s,c,l))}function ae(s){Ie.call(this),this.headers=new Map,this.L=s||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ae,Ie);var Am=/^https?$/i,xm=["POST","PUT"];n=ae.prototype,n.Fa=function(s){this.H=s},n.ea=function(s,c,l,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Sl.g(),this.g.onreadystatechange=C(f(this.Ca,this));try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(T){Ql(this,T);return}if(s=l||"",l=new Map(this.headers),d)if(Object.getPrototypeOf(d)===Object.prototype)for(var E in d)l.set(E,d[E]);else if(typeof d.keys=="function"&&typeof d.get=="function")for(let T of d.keys())l.set(T,d.get(T));else throw Error("Unknown input type for opt_headers: "+String(d));d=Array.from(l.keys()).find(T=>T.toLowerCase()=="content-type"),E=a.FormData&&s instanceof a.FormData,!(Array.prototype.indexOf.call(xm,c,void 0)>=0)||d||E||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[T,S]of l)this.g.setRequestHeader(T,S);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(s),this.v=!1}catch(T){Ql(this,T)}};function Ql(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.o=5,Jl(s),hi(s)}function Jl(s){s.A||(s.A=!0,xe(s,"complete"),xe(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=s||7,xe(this,"complete"),xe(this,"abort"),hi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hi(this,!0)),ae.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Yl(this):this.Xa())},n.Xa=function(){Yl(this)};function Yl(s){if(s.h&&typeof o<"u"){if(s.v&&Dt(s)==4)setTimeout(s.Ca.bind(s),0);else if(xe(s,"readystatechange"),Dt(s)==4){s.h=!1;try{let T=s.ca();e:switch(T){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var d;if(d=T===0){let S=String(s.D).match(Ul)[1]||null;!S&&a.self&&a.self.location&&(S=a.self.location.protocol.slice(0,-1)),d=!Am.test(S?S.toLowerCase():"")}l=d}if(l)xe(s,"complete"),xe(s,"success");else{s.o=6;try{var E=Dt(s)>2?s.g.statusText:""}catch{E=""}s.l=E+" ["+s.ca()+"]",Jl(s)}}finally{hi(s)}}}}function hi(s,c){if(s.g){s.m&&(clearTimeout(s.m),s.m=null);let l=s.g;s.g=null,c||xe(s,"ready");try{l.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Dt(s){return s.g?s.g.readyState:0}n.ca=function(){try{return Dt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),am(c)}};function Xl(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.F){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function Sm(s){let c={};s=(s.g&&Dt(s)>=2&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let d=0;d<s.length;d++){if(p(s[d]))continue;var l=fm(s[d]);let E=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let T=c[E]||[];c[E]=T,T.push(l)}nm(c,function(d){return d.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function yr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function Zl(s){this.za=0,this.i=[],this.j=new cr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=yr("failFast",!1,s),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=yr("baseRetryDelayMs",5e3,s),this.Za=yr("retryDelaySeedMs",1e4,s),this.Ta=yr("forwardChannelMaxRetries",2,s),this.va=yr("forwardChannelRequestTimeoutMs",2e4,s),this.ma=s&&s.xmlHttpFactory||void 0,this.Ua=s&&s.Rb||void 0,this.Aa=s&&s.useFetchStreams||!1,this.O=void 0,this.L=s&&s.supportsCrossDomainXhr||!1,this.M="",this.h=new kl(s&&s.concurrentRequestLimit),this.Ba=new Pm,this.S=s&&s.fastHandshake||!1,this.R=s&&s.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=s&&s.Pb||!1,s&&s.ua&&this.j.ua(),s&&s.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&s&&s.detectBufferingProxy||!1,this.ia=void 0,s&&s.longPollingTimeout&&s.longPollingTimeout>0&&(this.ia=s.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Zl.prototype,n.ka=8,n.I=1,n.connect=function(s,c,l,d){Se(0),this.W=s,this.H=c||{},l&&d!==void 0&&(this.H.OSID=l,this.H.OAID=d),this.F=this.X,this.J=cu(this,null,this.W),fi(this)};function co(s){if(eu(s),s.I==3){var c=s.V++,l=Qe(s.J);if(te(l,"SID",s.M),te(l,"RID",c),te(l,"TYPE","terminate"),vr(s,l),c=new xt(s,s.j,c),c.M=2,c.A=ci(Qe(l)),l=!1,a.navigator&&a.navigator.sendBeacon)try{l=a.navigator.sendBeacon(c.A.toString(),"")}catch{}!l&&a.Image&&(new Image().src=c.A,l=!0),l||(c.g=lu(c.j,null),c.g.ea(c.A)),c.F=Date.now(),ai(c)}au(s)}function di(s){s.g&&(uo(s),s.g.cancel(),s.g=null)}function eu(s){di(s),s.v&&(a.clearTimeout(s.v),s.v=null),mi(s),s.h.cancel(),s.m&&(typeof s.m=="number"&&a.clearTimeout(s.m),s.m=null)}function fi(s){if(!Nl(s.h)&&!s.m){s.m=!0;var c=s.Ea;ze||g(),be||(ze(),be=!0),w.add(c,s),s.D=0}}function Vm(s,c){return Fl(s.h)>=s.h.j-(s.m?1:0)?!1:s.m?(s.i=c.G.concat(s.i),!0):s.I==1||s.I==2||s.D>=(s.Sa?0:s.Ta)?!1:(s.m=ar(f(s.Ea,s,c),ou(s,s.D)),s.D++,!0)}n.Ea=function(s){if(this.m)if(this.m=null,this.I==1){if(!s){this.V=Math.floor(Math.random()*1e5),s=this.V++;let E=new xt(this,this.j,s),T=this.o;if(this.U&&(T?(T=hl(T),fl(T,this.U)):T=this.U),this.u!==null||this.R||(E.J=T,T=null),this.S)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var d=this.i[l];if("__data__"in d.map&&(d=d.map.__data__,typeof d=="string")){d=d.length;break t}d=void 0}if(d===void 0)break;if(c+=d,c>4096){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=nu(this,E,c),l=Qe(this.J),te(l,"RID",s),te(l,"CVER",22),this.G&&te(l,"X-HTTP-Session-Id",this.G),vr(this,l),T&&(this.R?c="headers="+lr(Wl(T))+"&"+c:this.u&&ao(l,this.u,T)),so(this.h,E),this.Ra&&te(l,"TYPE","init"),this.S?(te(l,"$req",c),te(l,"SID","null"),E.U=!0,to(E,l,null)):to(E,l,c),this.I=2}}else this.I==3&&(s?tu(this,s):this.i.length==0||Nl(this.h)||tu(this))};function tu(s,c){var l;c?l=c.l:l=s.V++;let d=Qe(s.J);te(d,"SID",s.M),te(d,"RID",l),te(d,"AID",s.K),vr(s,d),s.u&&s.o&&ao(d,s.u,s.o),l=new xt(s,s.j,l,s.D+1),s.u===null&&(l.J=s.o),c&&(s.i=c.G.concat(s.i)),c=nu(s,l,1e3),l.H=Math.round(s.va*.5)+Math.round(s.va*.5*Math.random()),so(s.h,l),to(l,d,c)}function vr(s,c){s.H&&ni(s.H,function(l,d){te(c,d,l)}),s.l&&ni({},function(l,d){te(c,d,l)})}function nu(s,c,l){l=Math.min(s.i.length,l);let d=s.l?f(s.l.Ka,s.l,s):null;e:{var E=s.i;let G=-1;for(;;){let ge=["count="+l];G==-1?l>0?(G=E[0].g,ge.push("ofs="+G)):G=0:ge.push("ofs="+G);let Z=!0;for(let pe=0;pe<l;pe++){var T=E[pe].g;let Je=E[pe].map;if(T-=G,T<0)G=Math.max(0,E[pe].g-100),Z=!1;else try{T="req"+T+"_"||"";try{var S=Je instanceof Map?Je:Object.entries(Je);for(let[Yt,Mt]of S){let Rt=Mt;u(Mt)&&(Rt=Js(Mt)),ge.push(T+Yt+"="+encodeURIComponent(Rt))}}catch(Yt){throw ge.push(T+"type="+encodeURIComponent("_badmap")),Yt}}catch{d&&d(Je)}}if(Z){S=ge.join("&");break e}}S=void 0}return s=s.i.splice(0,l),c.G=s,S}function ru(s){if(!s.g&&!s.v){s.Y=1;var c=s.Da;ze||g(),be||(ze(),be=!0),w.add(c,s),s.A=0}}function lo(s){return s.g||s.v||s.A>=3?!1:(s.Y++,s.v=ar(f(s.Da,s),ou(s,s.A)),s.A++,!0)}n.Da=function(){if(this.v=null,iu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var s=4*this.T;this.j.info("BP detection timer enabled: "+s),this.B=ar(f(this.Wa,this),s)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Se(10),di(this),iu(this))};function uo(s){s.B!=null&&(a.clearTimeout(s.B),s.B=null)}function iu(s){s.g=new xt(s,s.j,"rpc",s.Y),s.u===null&&(s.g.J=s.o),s.g.P=0;var c=Qe(s.na);te(c,"RID","rpc"),te(c,"SID",s.M),te(c,"AID",s.K),te(c,"CI",s.F?"0":"1"),!s.F&&s.ia&&te(c,"TO",s.ia),te(c,"TYPE","xmlhttp"),vr(s,c),s.u&&s.o&&ao(c,s.u,s.o),s.O&&(s.g.H=s.O);var l=s.g;s=s.ba,l.M=1,l.A=ci(Qe(c)),l.u=null,l.R=!0,Ml(l,s)}n.Va=function(){this.C!=null&&(this.C=null,di(this),lo(this),Se(19))};function mi(s){s.C!=null&&(a.clearTimeout(s.C),s.C=null)}function su(s,c){var l=null;if(s.g==c){mi(s),uo(s),s.g=null;var d=2}else if(io(s.h,c))l=c.G,Ll(s.h,c),d=1;else return;if(s.I!=0){if(c.o)if(d==1){l=c.u?c.u.length:0,c=Date.now()-c.F;var E=s.D;d=si(),xe(d,new Al(d,l)),fi(s)}else ru(s);else if(E=c.m,E==3||E==0&&c.X>0||!(d==1&&Vm(s,c)||d==2&&lo(s)))switch(l&&l.length>0&&(c=s.h,c.i=c.i.concat(l)),E){case 1:Jt(s,5);break;case 4:Jt(s,10);break;case 3:Jt(s,6);break;default:Jt(s,2)}}}function ou(s,c){let l=s.Qa+Math.floor(Math.random()*s.Za);return s.isActive()||(l*=2),l*c}function Jt(s,c){if(s.j.info("Error code "+c),c==2){var l=f(s.bb,s),d=s.Ua;let E=!d;d=new St(d||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||hr(d,"https"),ci(d),E?Im(d.toString(),l):Tm(d.toString(),l)}else Se(2);s.I=0,s.l&&s.l.pa(c),au(s),eu(s)}n.bb=function(s){s?(this.j.info("Successfully pinged google.com"),Se(2)):(this.j.info("Failed to ping google.com"),Se(1))};function au(s){if(s.I=0,s.ja=[],s.l){let c=Bl(s.h);(c.length!=0||s.i.length!=0)&&(V(s.ja,c),V(s.ja,s.i),s.h.i.length=0,x(s.i),s.i.length=0),s.l.oa()}}function cu(s,c,l){var d=l instanceof St?Qe(l):new St(l);if(d.g!="")c&&(d.g=c+"."+d.g),dr(d,d.u);else{var E=a.location;d=E.protocol,c=c?c+"."+E.hostname:E.hostname,E=+E.port;let T=new St(null);d&&hr(T,d),c&&(T.g=c),E&&dr(T,E),l&&(T.h=l),d=T}return l=s.G,c=s.wa,l&&c&&te(d,l,c),te(d,"VER",s.ka),vr(s,d),d}function lu(s,c,l){if(c&&!s.L)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Aa&&!s.ma?new ae(new li({ab:l})):new ae(s.ma),c.Fa(s.L),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function uu(){}n=uu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function gi(){}gi.prototype.g=function(s,c){return new Ne(s,c)};function Ne(s,c){Ie.call(this),this.g=new Zl(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.sa&&(s?s["X-WebChannel-Client-Profile"]=c.sa:s={"X-WebChannel-Client-Profile":c.sa}),this.g.U=s,(s=c&&c.Qb)&&!p(s)&&(this.g.u=s),this.A=c&&c.supportsCrossDomainXhr||!1,this.v=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!p(c)&&(this.g.G=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new vn(this)}v(Ne,Ie),Ne.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Ne.prototype.close=function(){co(this.g)},Ne.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.v&&(l={},l.__data__=Js(s),s=l);c.i.push(new pm(c.Ya++,s)),c.I==3&&fi(c)},Ne.prototype.N=function(){this.g.l=null,delete this.j,co(this.g),delete this.g,Ne.Z.N.call(this)};function hu(s){Ys.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}v(hu,Ys);function du(){Xs.call(this),this.status=1}v(du,Xs);function vn(s){this.g=s}v(vn,uu),vn.prototype.ra=function(){xe(this.g,"a")},vn.prototype.qa=function(s){xe(this.g,new hu(s))},vn.prototype.pa=function(s){xe(this.g,new du)},vn.prototype.oa=function(){xe(this.g,"b")},gi.prototype.createWebChannel=gi.prototype.g,Ne.prototype.send=Ne.prototype.o,Ne.prototype.open=Ne.prototype.m,Ne.prototype.close=Ne.prototype.close,Qo=yt.createWebChannelTransport=function(){return new gi},Wo=yt.getStatEventTarget=function(){return si()},Ho=yt.Event=Ht,Ai=yt.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},oi.NO_ERROR=0,oi.TIMEOUT=8,oi.HTTP_ERROR=6,xr=yt.ErrorCode=oi,xl.COMPLETE="complete",Ko=yt.EventType=xl,Cl.EventType=sr,sr.OPEN="a",sr.CLOSE="b",sr.ERROR="c",sr.MESSAGE="d",Ie.prototype.listen=Ie.prototype.J,Cn=yt.WebChannel=Cl,Wg=yt.FetchXmlHttpFactory=li,ae.prototype.listenOnce=ae.prototype.K,ae.prototype.getLastError=ae.prototype.Ha,ae.prototype.getLastErrorCode=ae.prototype.ya,ae.prototype.getStatus=ae.prototype.ca,ae.prototype.getResponseJson=ae.prototype.La,ae.prototype.getResponseText=ae.prototype.la,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Fa,$o=yt.XhrIo=ae}).apply(typeof Pi<"u"?Pi:typeof self<"u"?self:typeof window<"u"?window:{});var ye=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ye.UNAUTHENTICATED=new ye(null),ye.GOOGLE_CREDENTIALS=new ye("google-credentials-uid"),ye.FIRST_PARTY=new ye("first-party-uid"),ye.MOCK_USER=new ye("mock-user");var $n="12.8.0";function jh(n){$n=n}var sn=new En("@firebase/firestore");function In(){return sn.logLevel}function D(n,...e){if(sn.logLevel<=W.DEBUG){let t=e.map(Ac);sn.debug(`Firestore (${$n}): ${n}`,...t)}}function bt(n,...e){if(sn.logLevel<=W.ERROR){let t=e.map(Ac);sn.error(`Firestore (${$n}): ${n}`,...t)}}function Ut(n,...e){if(sn.logLevel<=W.WARN){let t=e.map(Ac);sn.warn(`Firestore (${$n}): ${n}`,...t)}}function Ac(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,qh(n,r,t)}function qh(n,e,t){let r=`FIRESTORE (${$n}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw bt(r),new Error(r)}function Y(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||qh(e,i,r)}function j(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},R=class extends mt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var tt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Oi=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},ki=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ye.UNAUTHENTICATED))}shutdown(){}},ta=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Ni=class{constructor(e){this.t=e,this.currentUser=ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0,42304);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new tt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new tt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{D("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(D("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new tt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(D("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string",31837,{l:r}),new Oi(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string",2055,{h:e}),new ye(e)}},na=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=ye.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}},ra=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new na(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Fi=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Li=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Y(this.o===void 0,3512);let r=o=>{o.error!=null&&D("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,D("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{D("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):D("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Fi(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Fi(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Qg(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var on=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=Qg(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function H(n,e){return n<e?-1:n>e?1:0}function ia(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),o=e.charAt(r);if(i!==o)return Jo(i)===Jo(o)?H(i,o):Jo(i)?1:-1}return H(n.length,e.length)}var Jg=55296,Yg=57343;function Jo(n){let e=n.charCodeAt(0);return e>=Jg&&e<=Yg}function Dn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var nh="__name__",Bi=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return H(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):ia(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _t.fromString(e.substring(4,e.length-2))}},oe=class n extends Bi{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new R(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Xg=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Oe=class n extends Bi{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Xg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nh}static keyField(){return new n([nh])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new R(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new R(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new R(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new R(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(oe.fromString(e))}static fromName(e){return new n(oe.fromString(e).popFirst(5))}static empty(){return new n(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new oe(e.slice()))}};function Gh(n,e,t){if(!t)throw new R(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zh(n,e,t,r){if(e===!0&&r===!0)throw new R(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function rh(n){if(!L.isDocumentKey(n))throw new R(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ih(n){if(L.isDocumentKey(n))throw new R(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function $h(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ps(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function ut(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new R(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ps(n);throw new R(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function le(n,e){let t={typeString:n};return e&&(t.value=e),t}function Kn(n,e){if(!$h(n))throw new R(P.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new R(P.INVALID_ARGUMENT,t);return!0}var sh=-62135596800,oh=1e6,ue=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*oh);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new R(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new R(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<sh)throw new R(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new R(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/oh}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kn(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-sh;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ue._jsonSchemaVersion="firestore/timestamp/1.0",ue._jsonSchema={type:le("string",ue._jsonSchemaVersion),seconds:le("number"),nanoseconds:le("number")};var q=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ue(0,0))}static max(){return new n(new ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Or=-1,Ui=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Ui.UNKNOWN_ID=-1;function Zg(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new ue(t+1,0):new ue(t,r));return new an(i,L.empty(),e)}function ep(n){return new an(n.readTime,n.key,Or)}var an=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),L.empty(),Or)}static max(){return new n(q.max(),L.empty(),Or)}};function tp(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:H(n.largestBatchId,e.largestBatchId))}var np="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",sa=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Hn(n){if(n.code!==P.FAILED_PRECONDITION||n.message!==np)throw n;D("LocalStore","Unexpectedly lost primary lease")}var A=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let f=h;t(e[f]).next(m=>{a[f]=m,++u,u===o&&r(a)},m=>i(m))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function rp(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Wn(n){return n.name==="IndexedDbTransactionError"}var xc=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),Sc=-1;function _s(n){return n==null}function kr(n){return n===0&&1/n==-1/0}function ip(n){return typeof n=="number"&&Number.isInteger(n)&&!kr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Kh="";function sp(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ah(e)),e=op(n.get(t),e);return ah(e)}function op(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case Kh:t+="";break;default:t+=o}}return t}function ah(n){return n+Kh+""}var ap="remoteDocuments",Hh="owner";var Wh="mutationQueues";var Qh="mutations";var Jh="documentMutations",cp="remoteDocumentsV14";var Yh="remoteDocumentGlobal";var Xh="targets";var Zh="targetDocuments";var ed="targetGlobal",td="collectionParents";var nd="clientMetadata";var rd="bundles";var id="namedQueries";var lp="indexConfiguration";var up="indexState";var hp="indexEntries";var sd="documentOverlays";var dp="globals";var fp=[Wh,Qh,Jh,ap,Xh,Hh,ed,Zh,nd,Yh,td,rd,id],iv=[...fp,sd],mp=[Wh,Qh,Jh,cp,Xh,Hh,ed,Zh,nd,Yh,td,rd,id,sd],gp=mp,pp=[...gp,lp,up,hp];var sv=[...pp,dp];function ch(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function zt(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function od(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ce=class n{constructor(e,t){this.comparator=e,this.root=t||nt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xn(this.root,e,this.comparator,!1)}getReverseIterator(){return new xn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xn(this.root,e,this.comparator,!0)}},xn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},nt=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}};nt.EMPTY=null,nt.RED=!0,nt.BLACK=!1;nt.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new nt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ve=class n{constructor(e){this.comparator=e,this.data=new ce(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ji(this.data.getIterator())}getIteratorFrom(e){return new ji(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ji=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ge=class n{constructor(e){this.fields=e,e.sort(Oe.comparator)}static empty(){return new n([])}unionWith(e){let t=new ve(Oe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Dn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var qi=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ce=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new qi("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ce.EMPTY_BYTE_STRING=new Ce("");var _p=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Et(n){if(Y(!!n,39018),typeof n=="string"){let e=0,t=_p.exec(n);if(Y(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ct(n){return typeof n=="string"?Ce.fromBase64String(n):Ce.fromUint8Array(n)}var ad="server_timestamp",cd="__type__",ld="__previous_value__",ud="__local_write_time__";function ys(n){return(n?.mapValue?.fields||{})[cd]?.stringValue===ad}function vs(n){let e=n.mapValue.fields[ld];return ys(e)?vs(e):e}function Nr(n){let e=Et(n.mapValue.fields[ud].timestampValue);return new ue(e.seconds,e.nanos)}var oa=class{constructor(e,t,r,i,o,a,u,h,f,m,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=m,this.apiKey=v}},Gi="(default)",Fr=class n{constructor(e,t){this.projectId=e,this.database=t||Gi}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Gi}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};function hd(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new R(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fr(n.options.projectId,e)}var Vc="__type__",dd="__max__",xi={mapValue:{fields:{__type__:{stringValue:dd}}}},Dc="__vector__",Mn="value";function jt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ys(n)?4:md(n)?9007199254740991:fd(n)?10:11:B(28295,{value:n})}function ct(n,e){if(n===e)return!0;let t=jt(n);if(t!==jt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Nr(n).isEqual(Nr(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=Et(i.timestampValue),u=Et(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return Ct(i.bytesValue).isEqual(Ct(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return se(i.geoPointValue.latitude)===se(o.geoPointValue.latitude)&&se(i.geoPointValue.longitude)===se(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return se(i.integerValue)===se(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=se(i.doubleValue),u=se(o.doubleValue);return a===u?kr(a)===kr(u):isNaN(a)&&isNaN(u)}return!1})(n,e);case 9:return Dn(n.arrayValue.values||[],e.arrayValue.values||[],ct);case 10:case 11:return(function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(ch(a)!==ch(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!ct(a[h],u[h])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function Lr(n,e){return(n.values||[]).find(t=>ct(t,e))!==void 0}function Rn(n,e){if(n===e)return 0;let t=jt(n),r=jt(e);if(t!==r)return H(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return H(n.booleanValue,e.booleanValue);case 2:return(function(o,a){let u=se(o.integerValue||o.doubleValue),h=se(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return lh(n.timestampValue,e.timestampValue);case 4:return lh(Nr(n),Nr(e));case 5:return ia(n.stringValue,e.stringValue);case 6:return(function(o,a){let u=Ct(o),h=Ct(a);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,a){let u=o.split("/"),h=a.split("/");for(let f=0;f<u.length&&f<h.length;f++){let m=H(u[f],h[f]);if(m!==0)return m}return H(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,a){let u=H(se(o.latitude),se(a.latitude));return u!==0?u:H(se(o.longitude),se(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return uh(n.arrayValue,e.arrayValue);case 10:return(function(o,a){let u=o.fields||{},h=a.fields||{},f=u[Mn]?.arrayValue,m=h[Mn]?.arrayValue,v=H(f?.values?.length||0,m?.values?.length||0);return v!==0?v:uh(f,m)})(n.mapValue,e.mapValue);case 11:return(function(o,a){if(o===xi.mapValue&&a===xi.mapValue)return 0;if(o===xi.mapValue)return 1;if(a===xi.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),f=a.fields||{},m=Object.keys(f);h.sort(),m.sort();for(let v=0;v<h.length&&v<m.length;++v){let C=ia(h[v],m[v]);if(C!==0)return C;let x=Rn(u[h[v]],f[m[v]]);if(x!==0)return x}return H(h.length,m.length)})(n.mapValue,e.mapValue);default:throw B(23264,{he:t})}}function lh(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return H(n,e);let t=Et(n),r=Et(e),i=H(t.seconds,r.seconds);return i!==0?i:H(t.nanos,r.nanos)}function uh(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Rn(t[i],r[i]);if(o)return o}return H(t.length,r.length)}function On(n){return aa(n)}function aa(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Et(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ct(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return L.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=aa(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${aa(t.fields[a])}`;return i+"}"})(n.mapValue):B(61005,{value:n})}function Di(n){switch(jt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=vs(n);return e?16+Di(e):16;case 5:return 2*n.stringValue.length;case 6:return Ct(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+Di(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return zt(r.fields,(o,a)=>{i+=o.length+Di(a)}),i})(n.mapValue);default:throw B(13486,{value:n})}}function ca(n){return!!n&&"integerValue"in n}function Mc(n){return!!n&&"arrayValue"in n}function hh(n){return!!n&&"nullValue"in n}function dh(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Mi(n){return!!n&&"mapValue"in n}function fd(n){return(n?.mapValue?.fields||{})[Vc]?.stringValue===Dc}function Dr(n){if(n.geoPointValue)return{geoPointValue:z({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:z({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return zt(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Dr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dr(n.arrayValue.values[t]);return e}return z({},n)}function md(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===dd}var av={mapValue:{fields:{[Vc]:{stringValue:Dc},[Mn]:{arrayValue:{}}}}};var Re=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Mi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dr(t)}setAll(e){let t=Oe.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Dr(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Mi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ct(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Mi(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){zt(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Dr(this.value))}};function gd(n){let e=[];return zt(n.fields,(t,r)=>{let i=new Oe([t]);if(Mi(r)){let o=gd(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Ge(e)}var He=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),Re.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),Re.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),Re.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Re.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Re.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var cn=class{constructor(e,t){this.position=e,this.inclusive=t}};function fh(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=Rn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function mh(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ct(n.position[t],e.position[t]))return!1;return!0}var ln=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function yp(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var zi=class{},me=class n extends zi{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ua(e,t,r):t==="array-contains"?new fa(e,r):t==="in"?new ma(e,r):t==="not-in"?new ga(e,r):t==="array-contains-any"?new pa(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ha(e,r):new da(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Rn(t,this.value)):t!==null&&jt(this.value)===jt(t)&&this.matchesComparison(Rn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},We=class n extends zi{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return pd(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function pd(n){return n.op==="and"}function _d(n){return vp(n)&&pd(n)}function vp(n){for(let e of n.filters)if(e instanceof We)return!1;return!0}function la(n){if(n instanceof me)return n.field.canonicalString()+n.op.toString()+On(n.value);if(_d(n))return n.filters.map(e=>la(e)).join(",");{let e=n.filters.map(t=>la(t)).join(",");return`${n.op}(${e})`}}function yd(n,e){return n instanceof me?(function(r,i){return i instanceof me&&r.op===i.op&&r.field.isEqual(i.field)&&ct(r.value,i.value)})(n,e):n instanceof We?(function(r,i){return i instanceof We&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&yd(a,i.filters[u]),!0):!1})(n,e):void B(19439)}function vd(n){return n instanceof me?(function(t){return`${t.field.canonicalString()} ${t.op} ${On(t.value)}`})(n):n instanceof We?(function(t){return t.op.toString()+" {"+t.getFilters().map(vd).join(" ,")+"}"})(n):"Filter"}var ua=class extends me{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},ha=class extends me{constructor(e,t){super(e,"in",t),this.keys=wd("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},da=class extends me{constructor(e,t){super(e,"not-in",t),this.keys=wd("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function wd(n,e){return(e.arrayValue?.values||[]).map(t=>L.fromName(t.referenceValue))}var fa=class extends me{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Mc(t)&&Lr(t.arrayValue,this.value)}},ma=class extends me{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Lr(this.value.arrayValue,t)}},ga=class extends me{constructor(e,t){super(e,"not-in",t)}matches(e){if(Lr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Lr(this.value.arrayValue,t)}},pa=class extends me{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Mc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Lr(this.value.arrayValue,r))}};var _a=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Te=null}};function gh(n,e=null,t=[],r=[],i=null,o=null,a=null){return new _a(n,e,t,r,i,o,a)}function Rc(n){let e=j(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>la(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),_s(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>On(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>On(r)).join(",")),e.Te=t}return e.Te}function Oc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yp(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!yd(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!mh(n.startAt,e.startAt)&&mh(n.endAt,e.endAt)}function ya(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var kn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function wp(n,e,t,r,i,o,a,u){return new kn(n,e,t,r,i,o,a,u)}function kc(n){return new kn(n)}function ph(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function bp(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function bd(n){return n.collectionGroup!==null}function Sn(n){let e=j(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new ve(Oe.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(f=>{f.isInequality()&&(u=u.add(f.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new ln(o,r))}),t.has(Oe.keyField().canonicalString())||e.Ie.push(new ln(Oe.keyField(),r))}return e.Ie}function rt(n){let e=j(n);return e.Ee||(e.Ee=Ep(e,Sn(n))),e.Ee}function Ep(n,e){if(n.limitType==="F")return gh(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new ln(i.field,o)});let t=n.endAt?new cn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new cn(n.startAt.position,n.startAt.inclusive):null;return gh(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function $i(n,e,t){return new kn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ws(n,e){return Oc(rt(n),rt(e))&&n.limitType===e.limitType}function Ed(n){return`${Rc(rt(n))}|lt:${n.limitType}`}function Tn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>vd(i)).join(", ")}]`),_s(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>On(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>On(i)).join(",")),`Target(${r})`})(rt(n))}; limitType=${n.limitType})`}function bs(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of Sn(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,u,h){let f=fh(a,u,h);return a.inclusive?f<=0:f<0})(r.startAt,Sn(r),i)||r.endAt&&!(function(a,u,h){let f=fh(a,u,h);return a.inclusive?f>=0:f>0})(r.endAt,Sn(r),i))})(n,e)}function Cp(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Cd(n){return(e,t)=>{let r=!1;for(let i of Sn(n)){let o=Ip(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Ip(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):(function(o,a,u){let h=a.data.field(o),f=u.data.field(o);return h!==null&&f!==null?Rn(h,f):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}var It=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zt(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return od(this.inner)}size(){return this.innerSize}};var Tp=new ce(L.comparator);function Tt(){return Tp}var Id=new ce(L.comparator);function Vr(...n){let e=Id;for(let t of n)e=e.insert(t.key,t);return e}function Td(n){let e=Id;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function nn(){return Mr()}function Pd(){return Mr()}function Mr(){return new It(n=>n.toString(),(n,e)=>n.isEqual(e))}var Pp=new ce(L.comparator),Ap=new ve(L.comparator);function K(...n){let e=Ap;for(let t of n)e=e.add(t);return e}var xp=new ve(H);function Sp(){return xp}function Nc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kr(e)?"-0":e}}function Ad(n){return{integerValue:""+n}}function Vp(n,e){return ip(e)?Ad(e):Nc(n,e)}var Nn=class{constructor(){this._=void 0}};function Dp(n,e,t){return n instanceof Fn?(function(i,o){let a={fields:{[cd]:{stringValue:ad},[ud]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&ys(o)&&(o=vs(o)),o&&(a.fields[ld]=o),{mapValue:a}})(t,e):n instanceof un?Sd(n,e):n instanceof hn?Vd(n,e):(function(i,o){let a=xd(i,o),u=_h(a)+_h(i.Ae);return ca(a)&&ca(i.Ae)?Ad(u):Nc(i.serializer,u)})(n,e)}function Mp(n,e,t){return n instanceof un?Sd(n,e):n instanceof hn?Vd(n,e):t}function xd(n,e){return n instanceof Ln?(function(r){return ca(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var Fn=class extends Nn{},un=class extends Nn{constructor(e){super(),this.elements=e}};function Sd(n,e){let t=Dd(e);for(let r of n.elements)t.some(i=>ct(i,r))||t.push(r);return{arrayValue:{values:t}}}var hn=class extends Nn{constructor(e){super(),this.elements=e}};function Vd(n,e){let t=Dd(e);for(let r of n.elements)t=t.filter(i=>!ct(i,r));return{arrayValue:{values:t}}}var Ln=class extends Nn{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function _h(n){return se(n.integerValue||n.doubleValue)}function Dd(n){return Mc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Rp(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof un&&i instanceof un||r instanceof hn&&i instanceof hn?Dn(r.elements,i.elements,ct):r instanceof Ln&&i instanceof Ln?ct(r.Ae,i.Ae):r instanceof Fn&&i instanceof Fn})(n.transform,e.transform)}var va=class{constructor(e,t){this.version=e,this.transformResults=t}},it=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ri(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Bn=class{};function Md(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Un(n.key,it.none()):new dn(n.key,n.data,it.none());{let t=n.data,r=Re.empty(),i=new ve(Oe.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new lt(n.key,r,new Ge(i.toArray()),it.none())}}function Op(n,e,t){n instanceof dn?(function(i,o,a){let u=i.value.clone(),h=vh(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):n instanceof lt?(function(i,o,a){if(!Ri(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=vh(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Rd(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,e,t):(function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Rr(n,e,t,r){return n instanceof dn?(function(o,a,u,h){if(!Ri(o.precondition,a))return u;let f=o.value.clone(),m=wh(o.fieldTransforms,h,a);return f.setAll(m),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),null})(n,e,t,r):n instanceof lt?(function(o,a,u,h){if(!Ri(o.precondition,a))return u;let f=wh(o.fieldTransforms,h,a),m=a.data;return m.setAll(Rd(o)),m.setAll(f),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(v=>v.field))})(n,e,t,r):(function(o,a,u){return Ri(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(n,e,t)}function kp(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=xd(r.transform,i||null);o!=null&&(t===null&&(t=Re.empty()),t.set(r.field,o))}return t||null}function yh(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Dn(r,i,(o,a)=>Rp(o,a))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var dn=class extends Bn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},lt=class extends Bn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Rd(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function vh(n,e,t){let r=new Map;Y(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,Mp(a,u,t[i]))}return r}function wh(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,Dp(o,a,e))}return r}var Un=class extends Bn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},wa=class extends Bn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ba=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&Op(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Rr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Rr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Pd();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=Md(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),K())}isEqual(e){return this.batchId===e.batchId&&Dn(this.mutations,e.mutations,(t,r)=>yh(t,r))&&Dn(this.baseMutations,e.baseMutations,(t,r)=>yh(t,r))}},Ea=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return Pp})(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Ca=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ia=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var de,Q;function Np(n){switch(n){case P.OK:return B(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function Od(n){if(n===void 0)return bt("GRPC error has no .code"),P.UNKNOWN;switch(n){case de.OK:return P.OK;case de.CANCELLED:return P.CANCELLED;case de.UNKNOWN:return P.UNKNOWN;case de.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case de.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case de.INTERNAL:return P.INTERNAL;case de.UNAVAILABLE:return P.UNAVAILABLE;case de.UNAUTHENTICATED:return P.UNAUTHENTICATED;case de.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case de.NOT_FOUND:return P.NOT_FOUND;case de.ALREADY_EXISTS:return P.ALREADY_EXISTS;case de.PERMISSION_DENIED:return P.PERMISSION_DENIED;case de.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case de.ABORTED:return P.ABORTED;case de.OUT_OF_RANGE:return P.OUT_OF_RANGE;case de.UNIMPLEMENTED:return P.UNIMPLEMENTED;case de.DATA_LOSS:return P.DATA_LOSS;default:return B(39323,{code:n})}}(Q=de||(de={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var Fp=null;function Lp(){return new TextEncoder}var Bp=new _t([4294967295,4294967295],0);function bh(n){let e=Lp().encode(n),t=new zo;return t.update(e),new Uint8Array(t.digest())}function Eh(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new _t([t,r],0),new _t([i,o],0)]}var Ta=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new rn(`Invalid padding: ${t}`);if(r<0)throw new rn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new rn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new rn(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=_t.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(_t.fromNumber(r)));return i.compare(Bp)===1&&(i=new _t([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=bh(e),[r,i]=Eh(t);for(let o=0;o<this.hashCount;o++){let a=this.ye(r,i,o);if(!this.we(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.ge===0)return;let t=bh(e),[r,i]=Eh(t);for(let o=0;o<this.hashCount;o++){let a=this.ye(r,i,o);this.be(a)}}be(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},rn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ki=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Br.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new ce(H),Tt(),K())}},Br=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,K(),K(),K())}};var Vn=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}},Hi=class{constructor(e,t){this.targetId=e,this.Ce=t}},Wi=class{constructor(e,t,r=Ce.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Qi=class{constructor(){this.ve=0,this.Fe=Ch(),this.Me=Ce.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B(38017,{changeType:o})}}),new Br(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=Ch()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Y(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}},Pa=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Tt(),this.He=Si(),this.Je=Si(),this.Ze=new ce(H)}Xe(e){for(let t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:B(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let o=i.target;if(ya(o))if(r===0){let a=new L(o.path);this.et(t,a,He.newNoDocument(a,q.min()))}else Y(r===1,20013,{expectedCount:r});else{let a=this._t(t);if(a!==r){let u=this.ut(e),h=u?this.ct(u,e,a):1;if(h!==0){this.it(t);let f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}Fp?.lt((function(m,v,C,x,V){let F={localCacheCount:m,existenceFilterCount:v.count,databaseId:C.database,projectId:C.projectId},M=v.unchangedNames;return M&&(F.bloomFilter={applied:V===0,hashCount:M?.hashCount??0,bitmapLength:M?.bits?.bitmap?.length??0,padding:M?.bits?.padding??0,mightContain:J=>x?.mightContain(J)??!1}),F})(a,e.Ce,this.Ge.ht(),u,h))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=Ct(r).toUint8Array()}catch(h){if(h instanceof qi)return Ut("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Ta(a,i,o)}catch(h){return Ut(h instanceof rn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Ge.ht(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(t,o,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((o,a)=>{let u=this.ot(a);if(u){if(o.current&&ya(u.target)){let h=new L(u.target.path);this.It(h).has(a)||this.Et(a,h)||this.et(a,h,He.newNoDocument(h,e))}o.Be&&(t.set(a,o.ke()),o.Ke())}});let r=K();this.Je.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));let i=new Ki(e,t,this.Ze,this.je,r);return this.je=Tt(),this.He=Si(),this.Je=Si(),this.Ze=new ce(H),i}Ye(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Qi,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new ve(H),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new ve(H),this.He=this.He.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||D("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Qi),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Si(){return new ce(L.comparator)}function Ch(){return new ce(L.comparator)}var Up={asc:"ASCENDING",desc:"DESCENDING"},jp={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qp={and:"AND",or:"OR"},Aa=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function xa(n,e){return n.useProto3Json||_s(e)?e:{value:e}}function Ji(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kd(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Gp(n,e){return Ji(n,e.toTimestamp())}function st(n){return Y(!!n,49232),q.fromTimestamp((function(t){let r=Et(t);return new ue(r.seconds,r.nanos)})(n))}function Fc(n,e){return Sa(n,e).canonicalString()}function Sa(n,e){let t=(function(i){return new oe(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Nd(n){let e=oe.fromString(n);return Y(jd(e),10190,{key:e.toString()}),e}function Va(n,e){return Fc(n.databaseId,e.path)}function Yo(n,e){let t=Nd(e);if(t.get(1)!==n.databaseId.projectId)throw new R(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new R(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(Ld(t))}function Fd(n,e){return Fc(n.databaseId,e)}function zp(n){let e=Nd(n);return e.length===4?oe.emptyPath():Ld(e)}function Da(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ld(n){return Y(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ih(n,e,t){return{name:Va(n,e),fields:t.value.mapValue.fields}}function $p(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:B(39313,{state:f})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(f,m){return f.useProto3Json?(Y(m===void 0||typeof m=="string",58123),Ce.fromBase64String(m||"")):(Y(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Ce.fromUint8Array(m||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&(function(f){let m=f.code===void 0?P.UNKNOWN:Od(f.code);return new R(m,f.message||"")})(a);t=new Wi(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Yo(n,r.document.name),o=st(r.document.updateTime),a=r.document.createTime?st(r.document.createTime):q.min(),u=new Re({mapValue:{fields:r.document.fields}}),h=He.newFoundDocument(i,o,a,u),f=r.targetIds||[],m=r.removedTargetIds||[];t=new Vn(f,m,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Yo(n,r.document),o=r.readTime?st(r.readTime):q.min(),a=He.newNoDocument(i,o),u=r.removedTargetIds||[];t=new Vn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Yo(n,r.document),o=r.removedTargetIds||[];t=new Vn([],o,i,null)}else{if(!("filter"in e))return B(11601,{Vt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Ia(i,o),u=r.targetId;t=new Hi(u,a)}}return t}function Kp(n,e){let t;if(e instanceof dn)t={update:Ih(n,e.key,e.value)};else if(e instanceof Un)t={delete:Va(n,e.key)};else if(e instanceof lt)t={update:Ih(n,e.key,e.data),updateMask:t_(e.fieldMask)};else{if(!(e instanceof wa))return B(16599,{dt:e.type});t={verify:Va(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,a){let u=a.transform;if(u instanceof Fn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof un)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof hn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Ln)return{fieldPath:a.field.canonicalString(),increment:u.Ae};throw B(20930,{transform:a.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:Gp(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B(27497)})(n,e.precondition)),t}function Hp(n,e){return n&&n.length>0?(Y(e!==void 0,14353),n.map(t=>(function(i,o){let a=i.updateTime?st(i.updateTime):st(o);return a.isEqual(q.min())&&(a=st(o)),new va(a,i.transformResults||[])})(t,e))):[]}function Wp(n,e){return{documents:[Fd(n,e.path)]}}function Qp(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Fd(n,i);let o=(function(f){if(f.length!==0)return Ud(We.create(f,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let a=(function(f){if(f.length!==0)return f.map(m=>(function(C){return{field:Pn(C.field),direction:Xp(C.dir)}})(m))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=xa(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(e.endAt)),{ft:t,parent:i}}function Jp(n){let e=zp(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){Y(r===1,65062);let m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let o=[];t.where&&(o=(function(v){let C=Bd(v);return C instanceof We&&_d(C)?C.getFilters():[C]})(t.where));let a=[];t.orderBy&&(a=(function(v){return v.map(C=>(function(V){return new ln(An(V.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(V.direction))})(C))})(t.orderBy));let u=null;t.limit&&(u=(function(v){let C;return C=typeof v=="object"?v.value:v,_s(C)?null:C})(t.limit));let h=null;t.startAt&&(h=(function(v){let C=!!v.before,x=v.values||[];return new cn(x,C)})(t.startAt));let f=null;return t.endAt&&(f=(function(v){let C=!v.before,x=v.values||[];return new cn(x,C)})(t.endAt)),wp(e,i,a,o,u,"F",h,f)}function Yp(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Bd(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=An(t.unaryFilter.field);return me.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=An(t.unaryFilter.field);return me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=An(t.unaryFilter.field);return me.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=An(t.unaryFilter.field);return me.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return me.create(An(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return We.create(t.compositeFilter.filters.map(r=>Bd(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function Xp(n){return Up[n]}function Zp(n){return jp[n]}function e_(n){return qp[n]}function Pn(n){return{fieldPath:n.canonicalString()}}function An(n){return Oe.fromServerFormat(n.fieldPath)}function Ud(n){return n instanceof me?(function(t){if(t.op==="=="){if(dh(t.value))return{unaryFilter:{field:Pn(t.field),op:"IS_NAN"}};if(hh(t.value))return{unaryFilter:{field:Pn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dh(t.value))return{unaryFilter:{field:Pn(t.field),op:"IS_NOT_NAN"}};if(hh(t.value))return{unaryFilter:{field:Pn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pn(t.field),op:Zp(t.op),value:t.value}}})(n):n instanceof We?(function(t){let r=t.getFilters().map(i=>Ud(i));return r.length===1?r[0]:{compositeFilter:{op:e_(t.op),filters:r}}})(n):B(54877,{filter:n})}function t_(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function jd(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function qd(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}var Ur=class n{constructor(e,t,r,i,o=q.min(),a=q.min(),u=Ce.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ma=class{constructor(e){this.yt=e}};function Gd(n){let e=Jp({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?$i(e,e.limit,"L"):e}var Yi=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(se(e.integerValue));else if("doubleValue"in e){let r=se(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),kr(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Et(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ct(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?md(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fd(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):B(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Mn,o=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(se(o)),this.Ot(i,t),this.Ct(r[i],t)}qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),L.fromName(e).path.forEach(r=>{this.Ft(t,60),this.$t(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};Yi.Wt=new Yi;var Ra=class{constructor(){this.Sn=new Oa}addToCollectionParentIndex(e,t){return this.Sn.add(t),A.resolve()}getCollectionParents(e,t){return A.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return A.resolve()}deleteFieldIndex(e,t){return A.resolve()}deleteAllFieldIndexes(e){return A.resolve()}createTargetIndexes(e,t){return A.resolve()}getDocumentsMatchingTarget(e,t){return A.resolve(null)}getIndexType(e,t){return A.resolve(0)}getFieldIndexes(e,t){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,t){return A.resolve(an.min())}getMinOffsetFromCollectionGroup(e,t){return A.resolve(an.min())}updateCollectionGroup(e,t,r){return A.resolve()}updateIndexEntries(e,t){return A.resolve()}},Oa=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ve(oe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ve(oe.comparator)).toArray()}};var cv=new Uint8Array(0);var Th={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zd=41943040,qe=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};qe.DEFAULT_COLLECTION_PERCENTILE=10,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qe.DEFAULT=new qe(zd,qe.DEFAULT_COLLECTION_PERCENTILE,qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qe.DISABLED=new qe(-1,0,0);var jr=class n{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new n(0)}static ar(){return new n(-1)}};var Ph="LruGarbageCollector",n_=1048576;function Ah([n,e],[t,r]){let i=H(n,t);return i===0?H(e,r):i}var ka=class{constructor(e){this.Pr=e,this.buffer=new ve(Ah),this.Tr=0}Ir(){return++this.Tr}Er(e){let t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Ah(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Na=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){D(Ph,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Wn(t)?D(Ph,"Ignoring IndexedDB error during garbage collection: ",t):await Hn(t)}await this.Ar(3e5)})}},Fa=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return A.resolve(xc.ce);let r=new ka(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.mr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(D("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve(Th)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(D("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Th):this.gr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,o,a,u,h,f,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(D("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),i=this.params.maximumSequenceNumbersToCollect):i=v,a=Date.now(),this.nthSequenceNumber(e,i))).next(v=>(r=v,u=Date.now(),this.removeTargets(e,r,t))).next(v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(v=>(f=Date.now(),In()<=W.DEBUG&&D("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(f-h)+`ms
Total Duration: ${f-m}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:v})))}};function r_(n,e){return new Fa(n,e)}var La=class{constructor(){this.changes=new It(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,He.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?A.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ba=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Ua=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Rr(r.mutation,i,Ge.empty(),ue.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,K()).next(()=>r))}getLocalViewOfDocuments(e,t,r=K()){let i=nn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=Vr();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=nn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,K()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=Tt(),a=Mr(),u=(function(){return Mr()})();return t.forEach((h,f)=>{let m=r.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof lt)?o=o.insert(f.key,f):m!==void 0?(a.set(f.key,m.mutation.getFieldMask()),Rr(m.mutation,f,m.mutation.getFieldMask(),ue.now())):a.set(f.key,Ge.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((f,m)=>a.set(f,m)),t.forEach((f,m)=>u.set(f,new Ba(m,a.get(f)??null))),u))}recalculateAndSaveOverlays(e,t){let r=Mr(),i=new ce((a,u)=>a-u),o=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let f=t.get(h);if(f===null)return;let m=r.get(h)||Ge.empty();m=u.applyToLocalView(f,m),r.set(h,m);let v=(i.get(u.batchId)||K()).add(h);i=i.insert(u.batchId,v)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),f=h.key,m=h.value,v=Pd();m.forEach(C=>{if(!o.has(C)){let x=Md(t.get(C),r.get(C));x!==null&&v.set(C,x),o=o.add(C)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,v))}return A.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return bp(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):bd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):A.resolve(nn()),u=Or,h=o;return a.next(f=>A.forEach(f,(m,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(m)?A.resolve():this.remoteDocumentCache.getEntry(e,m).next(C=>{h=h.insert(m,C)}))).next(()=>this.populateOverlays(e,f,o)).next(()=>this.computeViews(e,h,f,K())).next(m=>({batchId:u,changes:Td(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=Vr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=Vr();return this.indexManager.getCollectionParents(e,o).next(u=>A.forEach(u,h=>{let f=(function(v,C){return new kn(C,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(m=>{m.forEach((v,C)=>{a=a.insert(v,C)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,f)=>{let m=f.getKey();a.get(m)===null&&(a=a.insert(m,He.newInvalidDocument(m)))});let u=Vr();return a.forEach((h,f)=>{let m=o.get(h);m!==void 0&&Rr(m.mutation,f,Ge.empty(),ue.now()),bs(t,f)&&(u=u.insert(h,f))}),u})}};var ja=class{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return A.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:st(i.createTime)}})(t)),A.resolve()}getNamedQuery(e,t){return A.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:Gd(i.bundledQuery),readTime:st(i.readTime)}})(t)),A.resolve()}};var qa=class{constructor(){this.overlays=new ce(L.comparator),this.Lr=new Map}getOverlay(e,t){return A.resolve(this.overlays.get(t))}getOverlays(e,t){let r=nn();return A.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.bt(e,t,o)}),A.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Lr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Lr.delete(r)),A.resolve()}getOverlaysForCollection(e,t,r){let i=nn(),o=t.length+1,a=new L(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,f=h.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return A.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ce((f,m)=>f-m),a=this.overlays.getIterator();for(;a.hasNext();){let f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let m=o.get(f.largestBatchId);m===null&&(m=nn(),o=o.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}let u=nn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((f,m)=>u.set(f,m)),!(u.size()>=i)););return A.resolve(u)}bt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Ca(t,r));let o=this.Lr.get(t);o===void 0&&(o=K(),this.Lr.set(t,o)),this.Lr.set(t,o.add(r.key))}};var Ga=class{constructor(){this.sessionToken=Ce.EMPTY_BYTE_STRING}getSessionToken(e){return A.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,A.resolve()}};var qr=class{constructor(){this.kr=new ve(fe.Kr),this.qr=new ve(fe.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){let r=new fe(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new fe(e,t))}Qr(e,t){e.forEach(r=>this.removeReference(r,t))}Gr(e){let t=new L(new oe([])),r=new fe(t,e),i=new fe(t,e+1),o=[];return this.qr.forEachInRange([r,i],a=>{this.Wr(a),o.push(a.key)}),o}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let t=new L(new oe([])),r=new fe(t,e),i=new fe(t,e+1),o=K();return this.qr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new fe(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},fe=class{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return L.comparator(e.key,t.key)||H(e.Hr,t.Hr)}static Ur(e,t){return H(e.Hr,t.Hr)||L.comparator(e.key,t.key)}};var za=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new ve(fe.Kr)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new ba(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.Jr=this.Jr.add(new fe(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return A.resolve(a)}lookupMutationBatch(e,t){return A.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return A.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?Sc:this.Yn-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new fe(t,0),i=new fe(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([r,i],a=>{let u=this.Zr(a.Hr);o.push(u)}),A.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(H);return t.forEach(i=>{let o=new fe(i,0),a=new fe(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,a],u=>{r=r.add(u.Hr)})}),A.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let a=new fe(new L(o),0),u=new ve(H);return this.Jr.forEachWhile(h=>{let f=h.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(u=u.add(h.Hr)),!0)},a),A.resolve(this.Yr(u))}Yr(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Y(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return A.forEach(t.mutations,i=>{let o=new fe(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,t){let r=new fe(t,0),i=this.Jr.firstAfterOrEqual(r);return A.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var $a=class{constructor(e){this.ti=e,this.docs=(function(){return new ce(L.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return A.resolve(r?r.document.mutableCopy():He.newInvalidDocument(t))}getEntries(e,t){let r=Tt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():He.newInvalidDocument(i))}),A.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Tt(),a=t.path,u=new L(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:f,value:{document:m}}=h.getNext();if(!a.isPrefixOf(f.path))break;f.path.length>a.length+1||tp(ep(m),r)<=0||(i.has(m.key)||bs(t,m))&&(o=o.insert(m.key,m.mutableCopy()))}return A.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B(9500)}ni(e,t){return A.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Ka(this)}getSize(e){return A.resolve(this.size)}},Ka=class extends La{constructor(e){super(),this.Mr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)}),A.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}};var Ha=class{constructor(e){this.persistence=e,this.ri=new It(t=>Rc(t),Oc),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.ii=0,this.si=new qr,this.targetCount=0,this.oi=jr._r()}forEachTarget(e,t){return this.ri.forEach((r,i)=>t(i)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),A.resolve()}lr(e){this.ri.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.oi=new jr(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,A.resolve()}updateTargetData(e,t){return this.lr(t),A.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ri.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ri.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),A.waitFor(o).next(()=>i)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,t){let r=this.ri.get(t)||null;return A.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),A.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),A.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),A.resolve()}getMatchingKeysForTargetId(e,t){let r=this.si.jr(t);return A.resolve(r)}containsKey(e,t){return A.resolve(this.si.containsKey(t))}};var Xi=class{constructor(e,t){this._i={},this.overlays={},this.ai=new xc(0),this.ui=!1,this.ui=!0,this.ci=new Ga,this.referenceDelegate=e(this),this.li=new Ha(this),this.indexManager=new Ra,this.remoteDocumentCache=(function(i){return new $a(i)})(r=>this.referenceDelegate.hi(r)),this.serializer=new Ma(t),this.Pi=new ja(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qa,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new za(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){D("MemoryPersistence","Starting transaction:",e);let i=new Wa(this.ai.next());return this.referenceDelegate.Ti(),r(i).next(o=>this.referenceDelegate.Ii(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return A.or(Object.values(this._i).map(r=>()=>r.containsKey(e,t)))}},Wa=class extends sa{constructor(e){super(),this.currentSequenceNumber=e}},Qa=class n{constructor(e){this.persistence=e,this.Ri=new qr,this.Ai=null}static Vi(e){return new n(e)}get di(){if(this.Ai)return this.Ai;throw B(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),A.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),A.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),A.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach(i=>this.di.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.di.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ti(){this.Ai=new Set}Ii(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.di,r=>{let i=L.fromPath(r);return this.mi(e,i).next(o=>{o||t.removeEntry(i,q.min())})}).next(()=>(this.Ai=null,t.apply(e)))}updateLimboDocument(e,t){return this.mi(e,t).next(r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())})}hi(e){return 0}mi(e,t){return A.or([()=>A.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Zi=class n{constructor(e,t){this.persistence=e,this.fi=new It(r=>sp(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=r_(this,t)}static Vi(e,t){return new n(e,t)}Ti(){}Ii(e){return A.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){let t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}pr(e){let t=0;return this.mr(e,r=>{t++}).next(()=>t)}mr(e,t){return A.forEach(this.fi,(r,i)=>this.wr(e,r,i).next(o=>o?A.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ni(e,a=>this.wr(e,a,t).next(u=>{u||(r++,o.removeEntry(a,q.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),A.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),A.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),A.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),A.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Di(e.data.value)),t}wr(e,t,r){return A.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.fi.get(t);return A.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Ja=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=K(),i=K();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Ya=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Xa=class{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return Ou()?8:rp(Ru())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.gs(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ps(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Ya;return this.ys(e,t,a).next(u=>{if(o.result=u,this.As)return this.ws(e,t,a,u.size)})}).next(()=>o.result)}ws(e,t,r,i){return r.documentReadCount<this.Vs?(In()<=W.DEBUG&&D("QueryEngine","SDK will not create cache indexes for query:",Tn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),A.resolve()):(In()<=W.DEBUG&&D("QueryEngine","Query:",Tn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(In()<=W.DEBUG&&D("QueryEngine","The SDK decides to create cache indexes for query:",Tn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rt(t))):A.resolve())}gs(e,t){if(ph(t))return A.resolve(null);let r=rt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=$i(t,null,"F"),r=rt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=K(...o);return this.fs.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let f=this.bs(t,u);return this.Ss(t,f,a,h.readTime)?this.gs(e,$i(t,null,"F")):this.Ds(e,f,t,h)}))})))}ps(e,t,r,i){return ph(t)||i.isEqual(q.min())?A.resolve(null):this.fs.getDocuments(e,r).next(o=>{let a=this.bs(t,o);return this.Ss(t,a,r,i)?A.resolve(null):(In()<=W.DEBUG&&D("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tn(t)),this.Ds(e,a,t,Zg(i,Or)).next(u=>u))})}bs(e,t){let r=new ve(Cd(e));return t.forEach((i,o)=>{bs(e,o)&&(r=r.add(o))}),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ys(e,t,r){return In()<=W.DEBUG&&D("QueryEngine","Using full collection scan to execute query:",Tn(t)),this.fs.getDocumentsMatchingQuery(e,t,an.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Lc="LocalStore",i_=3e8,Za=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new ce(H),this.Fs=new It(o=>Rc(o),Oc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ua(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.vs))}};function s_(n,e,t,r){return new Za(n,e,t,r)}async function $d(n,e){let t=j(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Os(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=K();for(let f of i){a.push(f.batchId);for(let m of f.mutations)h=h.add(m.key)}for(let f of o){u.push(f.batchId);for(let m of f.mutations)h=h.add(m.key)}return t.localDocuments.getDocuments(r,h).next(f=>({Ns:f,removedBatchIds:a,addedBatchIds:u}))})})}function o_(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(u,h,f,m){let v=f.batch,C=v.keys(),x=A.resolve();return C.forEach(V=>{x=x.next(()=>m.getEntry(h,V)).next(F=>{let M=f.docVersions.get(V);Y(M!==null,48541),F.version.compareTo(M)<0&&(v.applyToRemoteDocument(F,f),F.isValidDocument()&&(F.setReadTime(f.commitVersion),m.addEntry(F)))})}),x.next(()=>u.mutationQueue.removeMutationBatch(h,v))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let h=K();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Kd(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.li.getLastRemoteSnapshotVersion(t))}function a_(n,e){let t=j(n),r=e.snapshotVersion,i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;let u=[];e.targetChanges.forEach((m,v)=>{let C=i.get(v);if(!C)return;u.push(t.li.removeMatchingKeys(o,m.removedDocuments,v).next(()=>t.li.addMatchingKeys(o,m.addedDocuments,v)));let x=C.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?x=x.withResumeToken(Ce.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,r)),i=i.insert(v,x),(function(F,M,J){return F.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=i_?!0:J.addedDocuments.size+J.modifiedDocuments.size+J.removedDocuments.size>0})(C,x,m)&&u.push(t.li.updateTargetData(o,x))});let h=Tt(),f=K();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,m))}),u.push(c_(o,a,e.documentUpdates).next(m=>{h=m.Bs,f=m.Ls})),!r.isEqual(q.min())){let m=t.li.getLastRemoteSnapshotVersion(o).next(v=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(m)}return A.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,f)).next(()=>h)}).then(o=>(t.vs=i,o))}function c_(n,e,t){let r=K(),i=K();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Tt();return t.forEach((u,h)=>{let f=o.get(u);h.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(q.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):D(Lc,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",h.version)}),{Bs:a,Ls:i}})}function l_(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Sc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function u_(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.li.getTargetData(r,e).next(o=>o?(i=o,A.resolve(i)):t.li.allocateTargetId(r).next(a=>(i=new Ur(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r})}async function ec(n,e,t){let r=j(n),i=r.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Wn(a))throw a;D(Lc,`Failed to update sequence numbers for target ${e}: ${a}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function xh(n,e,t){let r=j(n),i=q.min(),o=K();return r.persistence.runTransaction("Execute query","readwrite",a=>(function(h,f,m){let v=j(h),C=v.Fs.get(m);return C!==void 0?A.resolve(v.vs.get(C)):v.li.getTargetData(f,m)})(r,a,rt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.Cs.getDocumentsMatchingQuery(a,e,t?i:q.min(),t?o:K())).next(u=>(h_(r,Cp(e),u),{documents:u,ks:o})))}function h_(n,e,t){let r=n.Ms.get(e)||q.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.Ms.set(e,r)}var es=class{constructor(){this.activeTargetIds=Sp()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var tc=class{constructor(){this.vo=new es,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new es,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var nc=class{Mo(e){}shutdown(){}};var Sh="ConnectivityMonitor",ts=class{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){D(Sh,"Network connectivity changed: AVAILABLE");for(let e of this.Lo)e(0)}Bo(){D(Sh,"Network connectivity changed: UNAVAILABLE");for(let e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Vi=null;function rc(){return Vi===null?Vi=(function(){return 268435456+Math.round(2147483648*Math.random())})():Vi++,"0x"+Vi.toString(16)}var Xo="RestConnection",d_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"},ic=class{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===Gi?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let a=rc(),u=this.Qo(e,t.toUriEncodedString());D(Xo,`Sending RPC '${e}' ${a}:`,u,r);let h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(h,i,o);let{host:f}=new URL(u),m=Ei(f);return this.zo(e,u,h,r,m).then(v=>(D(Xo,`Received RPC '${e}' ${a}: `,v),v),v=>{throw Ut(Xo,`RPC '${e}' ${a} failed with error: `,v,"url: ",u,"request:",r),v})}jo(e,t,r,i,o,a){return this.Wo(e,t,r,i,o)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+$n})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Qo(e,t){let r=d_[e],i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}};var sc=class{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};var Ae="WebChannelConnection",Sr=(n,e,t)=>{n.listen(e,r=>{try{t(r)}catch(i){setTimeout(()=>{throw i},0)}})},ns=class n extends ic{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!n.c_){let e=Wo();Sr(e,Ho.STAT_EVENT,t=>{t.stat===Ai.PROXY?D(Ae,"STAT_EVENT: detected buffering proxy"):t.stat===Ai.NOPROXY&&D(Ae,"STAT_EVENT: detected no buffering proxy")}),n.c_=!0}}zo(e,t,r,i,o){let a=rc();return new Promise((u,h)=>{let f=new $o;f.setWithCredentials(!0),f.listenOnce(Ko.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case xr.NO_ERROR:let v=f.getResponseJson();D(Ae,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(v)),u(v);break;case xr.TIMEOUT:D(Ae,`RPC '${e}' ${a} timed out`),h(new R(P.DEADLINE_EXCEEDED,"Request time out"));break;case xr.HTTP_ERROR:let C=f.getStatus();if(D(Ae,`RPC '${e}' ${a} failed with status:`,C,"response text:",f.getResponseText()),C>0){let x=f.getResponseJson();Array.isArray(x)&&(x=x[0]);let V=x?.error;if(V&&V.status&&V.message){let F=(function(J){let X=J.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(X)>=0?X:P.UNKNOWN})(V.status);h(new R(F,V.message))}else h(new R(P.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new R(P.UNAVAILABLE,"Connection failed."));break;default:B(9055,{l_:e,streamId:a,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{D(Ae,`RPC '${e}' ${a} completed.`)}});let m=JSON.stringify(i);D(Ae,`RPC '${e}' ${a} sending request:`,i),f.send(t,"POST",m,r,15)})}T_(e,t,r){let i=rc(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=this.createWebChannelTransport(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Go(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let f=o.join("");D(Ae,`Creating RPC '${e}' stream ${i}: ${f}`,u);let m=a.createWebChannel(f,u);this.I_(m);let v=!1,C=!1,x=new sc({Ho:V=>{C?D(Ae,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(v||(D(Ae,`Opening RPC '${e}' stream ${i} transport.`),m.open(),v=!0),D(Ae,`RPC '${e}' stream ${i} sending:`,V),m.send(V))},Jo:()=>m.close()});return Sr(m,Cn.EventType.OPEN,()=>{C||(D(Ae,`RPC '${e}' stream ${i} transport opened.`),x.i_())}),Sr(m,Cn.EventType.CLOSE,()=>{C||(C=!0,D(Ae,`RPC '${e}' stream ${i} transport closed`),x.o_(),this.E_(m))}),Sr(m,Cn.EventType.ERROR,V=>{C||(C=!0,Ut(Ae,`RPC '${e}' stream ${i} transport errored. Name:`,V.name,"Message:",V.message),x.o_(new R(P.UNAVAILABLE,"The operation could not be completed")))}),Sr(m,Cn.EventType.MESSAGE,V=>{if(!C){let F=V.data[0];Y(!!F,16349);let M=F,J=M?.error||M[0]?.error;if(J){D(Ae,`RPC '${e}' stream ${i} received error:`,J);let X=J.status,ee=(function(be){let w=de[be];if(w!==void 0)return Od(w)})(X),ke=J.message;ee===void 0&&(ee=P.INTERNAL,ke="Unknown error status: "+X+" with message "+J.message),C=!0,x.o_(new R(ee,ke)),m.close()}else D(Ae,`RPC '${e}' stream ${i} received:`,F),x.__(F)}}),n.u_(),setTimeout(()=>{x.s_()},0),x}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(t=>t===e)}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Qo()}};function f_(n){return new ns(n)}function Zo(){return typeof document<"u"?document:null}function $r(n){return new Aa(n,!0)}ns.c_=!1;var rs=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&D("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};var Vh="PersistentStream",is=class{constructor(e,t,r,i,o,a,u,h){this.Ci=e,this.b_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rs(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(bt(t.toString()),bt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new R(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.H_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return D(Vh,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget(()=>this.D_===e?t():(D(Vh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},oc=class extends is{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=$p(this.serializer,e),r=(function(o){if(!("targetChange"in o))return q.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?q.min():a.readTime?st(a.readTime):q.min()})(e);return this.listener.J_(t,r)}Z_(e){let t={};t.database=Da(this.serializer),t.addTarget=(function(o,a){let u,h=a.target;if(u=ya(h)?{documents:Wp(o,h)}:{query:Qp(o,h).ft},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=kd(o,a.resumeToken);let f=xa(o,a.expectedCount);f!==null&&(u.expectedCount=f)}else if(a.snapshotVersion.compareTo(q.min())>0){u.readTime=Ji(o,a.snapshotVersion.toTimestamp());let f=xa(o,a.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,e);let r=Yp(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){let t={};t.database=Da(this.serializer),t.removeTarget=e,this.K_(t)}},ac=class extends is{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Y(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Y(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=Hp(e.writeResults,e.commitTime),r=st(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=Da(this.serializer),this.K_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Kp(this.serializer,r))};this.K_(t)}};var cc=class{},lc=class extends cc{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new R(P.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,Sa(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new R(P.UNKNOWN,o.toString())})}jo(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.jo(e,Sa(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new R(P.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};function m_(n,e,t,r){return new lc(n,e,t,r)}var uc=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bt(t),this.aa=!1):D("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var fn="RemoteStore",hc=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo(a=>{r.enqueueAndForget(async()=>{pn(this)&&(D(fn,"Restarting streams for network reachability change."),await(async function(h){let f=j(h);f.Ea.add(4),await Kr(f),f.Va.set("Unknown"),f.Ea.delete(4),await Es(f)})(this))})}),this.Va=new uc(r,i)}};async function Es(n){if(pn(n))for(let e of n.Ra)await e(!0)}async function Kr(n){for(let e of n.Ra)await e(!1)}function Hd(n,e){let t=j(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),qc(t)?jc(t):Qn(t).O_()&&Uc(t,e))}function Bc(n,e){let t=j(n),r=Qn(t);t.Ia.delete(e),r.O_()&&Wd(t,e),t.Ia.size===0&&(r.O_()?r.L_():pn(t)&&t.Va.set("Unknown"))}function Uc(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Qn(n).Z_(e)}function Wd(n,e){n.da.$e(e),Qn(n).X_(e)}function jc(n){n.da=new Pa({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Qn(n).start(),n.Va.ua()}function qc(n){return pn(n)&&!Qn(n).x_()&&n.Ia.size>0}function pn(n){return j(n).Ea.size===0}function Qd(n){n.da=void 0}async function g_(n){n.Va.set("Online")}async function p_(n){n.Ia.forEach((e,t)=>{Uc(n,e)})}async function __(n,e){Qd(n),qc(n)?(n.Va.ha(e),jc(n)):n.Va.set("Unknown")}async function y_(n,e,t){if(n.Va.set("Online"),e instanceof Wi&&e.state===2&&e.cause)try{await(async function(i,o){let a=o.cause;for(let u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,a),i.Ia.delete(u),i.da.removeTarget(u))})(n,e)}catch(r){D(fn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ss(n,r)}else if(e instanceof Vn?n.da.Xe(e):e instanceof Hi?n.da.st(e):n.da.tt(e),!t.isEqual(q.min()))try{let r=await Kd(n.localStore);t.compareTo(r)>=0&&await(function(o,a){let u=o.da.Tt(a);return u.targetChanges.forEach((h,f)=>{if(h.resumeToken.approximateByteSize()>0){let m=o.Ia.get(f);m&&o.Ia.set(f,m.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,f)=>{let m=o.Ia.get(h);if(!m)return;o.Ia.set(h,m.withResumeToken(Ce.EMPTY_BYTE_STRING,m.snapshotVersion)),Wd(o,h);let v=new Ur(m.target,h,f,m.sequenceNumber);Uc(o,v)}),o.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){D(fn,"Failed to raise snapshot:",r),await ss(n,r)}}async function ss(n,e,t){if(!Wn(e))throw e;n.Ea.add(1),await Kr(n),n.Va.set("Offline"),t||(t=()=>Kd(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{D(fn,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Es(n)})}function Jd(n,e){return e().catch(t=>ss(n,t,e))}async function Cs(n){let e=j(n),t=qt(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Sc;for(;v_(e);)try{let i=await l_(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,w_(e,i)}catch(i){await ss(e,i)}Yd(e)&&Xd(e)}function v_(n){return pn(n)&&n.Ta.length<10}function w_(n,e){n.Ta.push(e);let t=qt(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function Yd(n){return pn(n)&&!qt(n).x_()&&n.Ta.length>0}function Xd(n){qt(n).start()}async function b_(n){qt(n).ra()}async function E_(n){let e=qt(n);for(let t of n.Ta)e.ea(t.mutations)}async function C_(n,e,t){let r=n.Ta.shift(),i=Ea.from(r,e,t);await Jd(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Cs(n)}async function I_(n,e){e&&qt(n).Y_&&await(async function(r,i){if((function(a){return Np(a)&&a!==P.ABORTED})(i.code)){let o=r.Ta.shift();qt(r).B_(),await Jd(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Cs(r)}})(n,e),Yd(n)&&Xd(n)}async function Dh(n,e){let t=j(n);t.asyncQueue.verifyOperationInProgress(),D(fn,"RemoteStore received new credentials");let r=pn(t);t.Ea.add(3),await Kr(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Es(t)}async function T_(n,e){let t=j(n);e?(t.Ea.delete(2),await Es(t)):e||(t.Ea.add(2),await Kr(t),t.Va.set("Unknown"))}function Qn(n){return n.ma||(n.ma=(function(t,r,i){let o=j(t);return o.sa(),new oc(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:g_.bind(null,n),Yo:p_.bind(null,n),t_:__.bind(null,n),J_:y_.bind(null,n)}),n.Ra.push(async e=>{e?(n.ma.B_(),qc(n)?jc(n):n.Va.set("Unknown")):(await n.ma.stop(),Qd(n))})),n.ma}function qt(n){return n.fa||(n.fa=(function(t,r,i){let o=j(t);return o.sa(),new ac(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:b_.bind(null,n),t_:I_.bind(null,n),ta:E_.bind(null,n),na:C_.bind(null,n)}),n.Ra.push(async e=>{e?(n.fa.B_(),await Cs(n)):(await n.fa.stop(),n.Ta.length>0&&(D(fn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var dc=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new tt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new R(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Gc(n,e){if(bt("AsyncQueue",`${e}: ${n}`),Wn(n))return new R(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Gr=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=Vr(),this.sortedSet=new ce(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var os=class{constructor(){this.ga=new ce(L.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):B(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},mn=class n{constructor(e,t,r,i,o,a,u,h,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,Gr.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ws(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var fc=class{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}},mc=class{constructor(){this.queries=Mh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=Mh(),o.forEach((a,u)=>{for(let h of u.ba)h.onError(r)})})(this,new R(P.ABORTED,"Firestore shutting down"))}};function Mh(){return new It(n=>Ed(n),ws)}async function P_(n,e){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Sa()&&e.Da()&&(r=2):(o=new fc,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){let u=Gc(a,`Initialization of query '${Tn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&zc(t)}async function A_(n,e){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.ba.indexOf(e);a>=0&&(o.ba.splice(a,1),o.ba.length===0?i=e.Da()?0:1:!o.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function x_(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.ba)u.Fa(i)&&(r=!0);a.wa=i}}r&&zc(t)}function S_(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.ba)o.onError(t);r.queries.delete(e)}function zc(n){n.Ca.forEach(e=>{e.next()})}var gc,Rh;(Rh=gc||(gc={})).Ma="default",Rh.Cache="cache";var pc=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new mn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=mn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gc.Cache}};var as=class{constructor(e){this.key=e}},cs=class{constructor(e){this.key=e}},_c=class{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=K(),this.mutatedKeys=K(),this.eu=Cd(e),this.tu=new Gr(this.eu)}get nu(){return this.Za}ru(e,t){let r=t?t.iu:new os,i=t?t.tu:this.tu,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,v)=>{let C=i.get(m),x=bs(this.query,v)?v:null,V=!!C&&this.mutatedKeys.has(C.key),F=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations),M=!1;C&&x?C.data.isEqual(x.data)?V!==F&&(r.track({type:3,doc:x}),M=!0):this.su(C,x)||(r.track({type:2,doc:x}),M=!0,(h&&this.eu(x,h)>0||f&&this.eu(x,f)<0)&&(u=!0)):!C&&x?(r.track({type:0,doc:x}),M=!0):C&&!x&&(r.track({type:1,doc:C}),M=!0,(h||f)&&(u=!0)),M&&(x?(a=a.add(x),o=F?o.add(m):o.delete(m)):(a=a.delete(m),o=o.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),o=o.delete(m.key),r.track({type:1,doc:m})}return{tu:a,iu:r,Ss:u,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let a=e.iu.ya();a.sort((m,v)=>(function(x,V){let F=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B(20277,{Vt:M})}};return F(x)-F(V)})(m.type,v.type)||this.eu(m.doc,v.doc)),this.ou(r),i=i??!1;let u=t&&!i?this._u():[],h=this.Ya.size===0&&this.current&&!i?1:0,f=h!==this.Xa;return this.Xa=h,a.length!==0||f?{snapshot:new mn(this.query,e.tu,o,a,e.mutatedKeys,h===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new os,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Za=this.Za.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Za=this.Za.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=K(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});let t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new cs(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new as(r))}),t}cu(e){this.Za=e.ks,this.Ya=K();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return mn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}},$c="SyncEngine",yc=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},vc=class{constructor(e){this.key=e,this.hu=!1}},wc=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new It(u=>Ed(u),ws),this.Iu=new Map,this.Eu=new Set,this.Ru=new ce(L.comparator),this.Au=new Map,this.Vu=new qr,this.du={},this.mu=new Map,this.fu=jr.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function V_(n,e,t=!0){let r=sf(n),i,o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Zd(r,e,t,!0),i}async function D_(n,e){let t=sf(n);await Zd(t,e,!0,!1)}async function Zd(n,e,t,r){let i=await u_(n.localStore,rt(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),u;return r&&(u=await M_(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Hd(n.remoteStore,i),u}async function M_(n,e,t,r,i){n.pu=(v,C,x)=>(async function(F,M,J,X){let ee=M.view.ru(J);ee.Ss&&(ee=await xh(F.localStore,M.query,!1).then(({documents:w})=>M.view.ru(w,ee)));let ke=X&&X.targetChanges.get(M.targetId),ze=X&&X.targetMismatches.get(M.targetId)!=null,be=M.view.applyChanges(ee,F.isPrimaryClient,ke,ze);return kh(F,M.targetId,be.au),be.snapshot})(n,v,C,x);let o=await xh(n.localStore,e,!0),a=new _c(e,o.ks),u=a.ru(o.documents),h=Br.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=a.applyChanges(u,n.isPrimaryClient,h);kh(n,t,f.au);let m=new yc(e,t,a);return n.Tu.set(e,m),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),f.snapshot}async function R_(n,e,t){let r=j(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter(a=>!ws(a,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ec(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Bc(r.remoteStore,i.targetId),bc(r,i.targetId)}).catch(Hn)):(bc(r,i.targetId),await ec(r.localStore,i.targetId,!0))}async function O_(n,e){let t=j(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Bc(t.remoteStore,r.targetId))}async function k_(n,e,t){let r=q_(n);try{let i=await(function(a,u){let h=j(a),f=ue.now(),m=u.reduce((x,V)=>x.add(V.key),K()),v,C;return h.persistence.runTransaction("Locally write mutations","readwrite",x=>{let V=Tt(),F=K();return h.xs.getEntries(x,m).next(M=>{V=M,V.forEach((J,X)=>{X.isValidDocument()||(F=F.add(J))})}).next(()=>h.localDocuments.getOverlayedDocuments(x,V)).next(M=>{v=M;let J=[];for(let X of u){let ee=kp(X,v.get(X.key).overlayedDocument);ee!=null&&J.push(new lt(X.key,ee,gd(ee.value.mapValue),it.exists(!0)))}return h.mutationQueue.addMutationBatch(x,f,J,u)}).next(M=>{C=M;let J=M.applyToLocalDocumentSet(v,F);return h.documentOverlayCache.saveOverlays(x,M.batchId,J)})}).then(()=>({batchId:C.batchId,changes:Td(v)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,u,h){let f=a.du[a.currentUser.toKey()];f||(f=new ce(H)),f=f.insert(u,h),a.du[a.currentUser.toKey()]=f})(r,i.batchId,t),await Hr(r,i.changes),await Cs(r.remoteStore)}catch(i){let o=Gc(i,"Failed to persist write");t.reject(o)}}async function ef(n,e){let t=j(n);try{let r=await a_(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Au.get(o);a&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Y(a.hu,14607):i.removedDocuments.size>0&&(Y(a.hu,42227),a.hu=!1))}),await Hr(t,r,e)}catch(r){await Hn(r)}}function Oh(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((o,a)=>{let u=a.view.va(e);u.snapshot&&i.push(u.snapshot)}),(function(a,u){let h=j(a);h.onlineState=u;let f=!1;h.queries.forEach((m,v)=>{for(let C of v.ba)C.va(u)&&(f=!0)}),f&&zc(h)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function N_(n,e,t){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),o=i&&i.key;if(o){let a=new ce(L.comparator);a=a.insert(o,He.newNoDocument(o,q.min()));let u=K().add(o),h=new Ki(q.min(),new Map,new ce(H),a,u);await ef(r,h),r.Ru=r.Ru.remove(o),r.Au.delete(e),Kc(r)}else await ec(r.localStore,e,!1).then(()=>bc(r,e,t)).catch(Hn)}async function F_(n,e){let t=j(n),r=e.batch.batchId;try{let i=await o_(t.localStore,e);nf(t,r,null),tf(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Hr(t,i)}catch(i){await Hn(i)}}async function L_(n,e,t){let r=j(n);try{let i=await(function(a,u){let h=j(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return h.mutationQueue.lookupMutationBatch(f,u).next(v=>(Y(v!==null,37113),m=v.keys(),h.mutationQueue.removeMutationBatch(f,v))).next(()=>h.mutationQueue.performConsistencyCheck(f)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(f,m,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>h.localDocuments.getDocuments(f,m))})})(r.localStore,e);nf(r,e,t),tf(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Hr(r,i)}catch(i){await Hn(i)}}function tf(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function nf(n,e,t){let r=j(n),i=r.du[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function bc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach(r=>{n.Vu.containsKey(r)||rf(n,r)})}function rf(n,e){n.Eu.delete(e.path.canonicalString());let t=n.Ru.get(e);t!==null&&(Bc(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Kc(n))}function kh(n,e,t){for(let r of t)r instanceof as?(n.Vu.addReference(r.key,e),B_(n,r)):r instanceof cs?(D($c,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||rf(n,r.key)):B(19791,{wu:r})}function B_(n,e){let t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(D($c,"New document in limbo: "+t),n.Eu.add(r),Kc(n))}function Kc(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new L(oe.fromString(e)),r=n.fu.next();n.Au.set(r,new vc(t)),n.Ru=n.Ru.insert(t,r),Hd(n.remoteStore,new Ur(rt(kc(t.path)),r,"TargetPurposeLimboResolution",xc.ce))}}async function Hr(n,e,t){let r=j(n),i=[],o=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((u,h)=>{a.push(r.pu(h,e,t).then(f=>{if((f||t)&&r.isPrimaryClient){let m=f?!f.fromCache:t?.targetChanges.get(h.targetId)?.current;r.sharedClientState.updateQueryState(h.targetId,m?"current":"not-current")}if(f){i.push(f);let m=Ja.Es(h.targetId,f);o.push(m)}}))}),await Promise.all(a),r.Pu.J_(i),await(async function(h,f){let m=j(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>A.forEach(f,C=>A.forEach(C.Ts,x=>m.persistence.referenceDelegate.addReference(v,C.targetId,x)).next(()=>A.forEach(C.Is,x=>m.persistence.referenceDelegate.removeReference(v,C.targetId,x)))))}catch(v){if(!Wn(v))throw v;D(Lc,"Failed to update sequence numbers: "+v)}for(let v of f){let C=v.targetId;if(!v.fromCache){let x=m.vs.get(C),V=x.snapshotVersion,F=x.withLastLimboFreeSnapshotVersion(V);m.vs=m.vs.insert(C,F)}}})(r.localStore,o))}async function U_(n,e){let t=j(n);if(!t.currentUser.isEqual(e)){D($c,"User change. New user:",e.toKey());let r=await $d(t.localStore,e);t.currentUser=e,(function(o,a){o.mu.forEach(u=>{u.forEach(h=>{h.reject(new R(P.CANCELLED,a))})}),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Hr(t,r.Ns)}}function j_(n,e){let t=j(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let i=K(),o=t.Iu.get(e);if(!o)return i;for(let a of o){let u=t.Tu.get(a);i=i.unionWith(u.view.nu)}return i}}function sf(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ef.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=N_.bind(null,e),e.Pu.J_=x_.bind(null,e.eventManager),e.Pu.yu=S_.bind(null,e.eventManager),e}function q_(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=F_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=L_.bind(null,e),e}var Hc=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=$r(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return s_(this.persistence,new Xa,t.initialUser,this.serializer)}Cu(t){return new Xi(Qa.Vi,this.serializer)}Du(t){return new tc}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),ls=class extends Hc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Y(this.persistence.referenceDelegate instanceof Zi,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Na(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?qe.withCacheSize(this.cacheSizeBytes):qe.DEFAULT;return new Xi(r=>Zi.Vi(r,t),this.serializer)}};var of=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Oh(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=U_.bind(null,this.syncEngine),await T_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new mc})()}createDatastore(t){let r=$r(t.databaseInfo.databaseId),i=f_(t.databaseInfo);return m_(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,a,u,h){return new hc(i,o,a,u,h)})(this.localStore,this.datastore,t.asyncQueue,r=>Oh(this.syncEngine,r,0),(function(){return ts.v()?new ts:new nc})())}createSyncEngine(t,r){return(function(o,a,u,h,f,m,v){let C=new wc(o,a,u,h,f,m);return v&&(C.gu=!0),C})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=j(r);D(fn,"RemoteStore shutting down."),i.Ea.add(5),await Kr(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var Ec=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):bt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Gt="FirestoreClient",Cc=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=ye.UNAUTHENTICATED,this.clientId=on.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{D(Gt,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(D(Gt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new tt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Gc(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function ea(n,e){n.asyncQueue.verifyOperationInProgress(),D(Gt,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await $d(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Nh(n,e){n.asyncQueue.verifyOperationInProgress();let t=await G_(n);D(Gt,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Dh(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Dh(e.remoteStore,i)),n._onlineComponents=e}async function G_(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){D(Gt,"Using user provided OfflineComponentProvider");try{await ea(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Ut("Error using user provided cache. Falling back to memory cache: "+t),await ea(n,new Hc)}}else D(Gt,"Using default OfflineComponentProvider"),await ea(n,new ls(void 0));return n._offlineComponents}async function af(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(D(Gt,"Using user provided OnlineComponentProvider"),await Nh(n,n._uninitializedComponentsProvider._online)):(D(Gt,"Using default OnlineComponentProvider"),await Nh(n,new of))),n._onlineComponents}function z_(n){return af(n).then(e=>e.syncEngine)}async function $_(n){let e=await af(n),t=e.eventManager;return t.onListen=V_.bind(null,e.syncEngine),t.onUnlisten=R_.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=D_.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=O_.bind(null,e.syncEngine),t}function cf(n,e,t={}){let r=new tt;return n.asyncQueue.enqueueAndForget(async()=>(function(o,a,u,h,f){let m=new Ec({next:C=>{m.Nu(),a.enqueueAndForget(()=>A_(o,v)),C.fromCache&&h.source==="server"?f.reject(new R(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(C)},error:C=>f.reject(C)}),v=new pc(u,m,{includeMetadataChanges:!0,Ka:!0});return P_(o,v)})(await $_(n),n.asyncQueue,e,t,r)),r.promise}function lf(n,e){let t=new tt;return n.asyncQueue.enqueueAndForget(async()=>k_(await z_(n),e,t)),t.promise}function uf(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var K_="ComponentProvider",Fh=new Map;function H_(n,e,t,r,i){return new oa(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,uf(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}var hf="firestore.googleapis.com",Lh=!0,us=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new R(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hf,this.ssl=Lh}else this.host=e.host,this.ssl=e.ssl??Lh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<n_)throw new R(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zh("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uf(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new R(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new R(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new R(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},jn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new us({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new R(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new R(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new us(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new ki;switch(r.type){case"firstParty":return new ra(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new R(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Fh.get(t);r&&(D(K_,"Removing Datastore"),Fh.delete(t),r.terminate())})(this),Promise.resolve()}};function df(n,e,t,r={}){n=ut(n,jn);let i=Ei(e),o=n._getSettings(),a=ne(z({},o),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;i&&(Vu(`https://${u}`),Mu("Firestore",!0)),o.host!==hf&&o.host!==u&&Ut("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let h=ne(z({},o),{host:u,ssl:i,emulatorOptions:r});if(!en(h,a)&&(n._setSettings(h),r.mockUserToken)){let f,m;if(typeof r.mockUserToken=="string")f=r.mockUserToken,m=ye.MOCK_USER;else{f=Du(r.mockUserToken,n._app?.options.projectId);let v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new R(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new ye(v)}n._authCredentials=new ta(new Oi(f,m))}}var qn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},we=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Kn(t,n._jsonSchema))return new n(e,r||null,new L(oe.fromString(t.referencePath)))}};we._jsonSchemaVersion="firestore/documentReference/1.0",we._jsonSchema={type:le("string",we._jsonSchemaVersion),referencePath:le("string")};var vt=class n extends qn{constructor(e,t,r){super(e,t,kc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new we(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Wc(n,e,...t){if(n=Ze(n),Gh("collection","path",e),n instanceof jn){let r=oe.fromString(e,...t);return ih(r),new vt(n,null,r)}{if(!(n instanceof we||n instanceof vt))throw new R(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return ih(r),new vt(n.firestore,null,r)}}function Jn(n,e,...t){if(n=Ze(n),arguments.length===1&&(e=on.newId()),Gh("doc","path",e),n instanceof jn){let r=oe.fromString(e,...t);return rh(r),new we(n,null,new L(r))}{if(!(n instanceof we||n instanceof vt))throw new R(P.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return rh(r),new we(n.firestore,n instanceof vt?n.converter:null,new L(r))}}var Bh="AsyncQueue",hs=class{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rs(this,"async_queue_retry"),this._c=()=>{let r=Zo();r&&D(Bh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=Zo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Zo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new tt;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Wn(e))throw e;D(Bh,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,bt("INTERNAL UNHANDLED ERROR: ",Uh(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=dc.createAndSchedule(this,e,t,r,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&B(47125,{Pc:Uh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function Uh(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var Pt=class extends jn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new hs,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new hs(e),this._firestoreClient=void 0,await e}}};function Qc(n,e){let t=typeof n=="object"?n:Yu(),r=typeof n=="string"?n:e||Gi,i=Wu(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Su("firestore");o&&df(i,...o)}return i}function Is(n){if(n._terminated)throw new R(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||W_(n),n._firestoreClient}function W_(n){let e=n._freezeSettings(),t=H_(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Cc(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}var ot=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ce.fromBase64String(e))}catch(t){throw new R(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ce.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kn(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};ot._jsonSchemaVersion="firestore/bytes/1.0",ot._jsonSchema={type:le("string",ot._jsonSchemaVersion),bytes:le("string")};var gn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new R(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Oe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Gn=class{constructor(e){this._methodName=e}};var wt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new R(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new R(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Kn(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};wt._jsonSchemaVersion="firestore/geoPoint/1.0",wt._jsonSchema={type:le("string",wt._jsonSchemaVersion),latitude:le("number"),longitude:le("number")};var at=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kn(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new R(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};at._jsonSchemaVersion="firestore/vectorValue/1.0",at._jsonSchema={type:le("string",at._jsonSchemaVersion),vectorValues:le("object")};var Q_=/^__.*__$/,Ic=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new lt(e,this.data,this.fieldMask,t,this.fieldTransforms):new dn(e,this.data,t,this.fieldTransforms)}},ds=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new lt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function ff(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{dataSource:n})}}var Tc=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new n(z(z({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return ms(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ff(this.dataSource)&&Q_.test(e))throw this.createError('Document fields cannot begin and end with "__"')}},Pc=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||$r(e)}createContext(e,t,r,i=!1){return new Tc({dataSource:e,methodName:t,targetDoc:r,path:Oe.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Jc(n){let e=n._freezeSettings(),t=$r(n._databaseId);return new Pc(n._databaseId,!!e.ignoreUndefinedProperties,t)}function mf(n,e,t,r,i,o={}){let a=n.createContext(o.merge||o.mergeFields?2:0,e,t,i);Yc("Data must be an object, but it was:",a,r);let u=_f(r,a),h,f;if(o.merge)h=new Ge(a.fieldMask),f=a.fieldTransforms;else if(o.mergeFields){let m=[];for(let v of o.mergeFields){let C=zn(e,v,t);if(!a.contains(C))throw new R(P.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);vf(m,C)||m.push(C)}h=new Ge(m),f=a.fieldTransforms.filter(v=>h.covers(v.field))}else h=null,f=a.fieldTransforms;return new Ic(new Re(u),h,f)}var fs=class n extends Gn{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function gf(n,e,t,r){let i=n.createContext(1,e,t);Yc("Data must be an object, but it was:",i,r);let o=[],a=Re.empty();zt(r,(h,f)=>{let m=Xc(e,h,t);f=Ze(f);let v=i.childContextForFieldPath(m);if(f instanceof fs)o.push(m);else{let C=Ts(f,v);C!=null&&(o.push(m),a.set(m,C))}});let u=new Ge(o);return new ds(a,u,i.fieldTransforms)}function pf(n,e,t,r,i,o){let a=n.createContext(1,e,t),u=[zn(e,r,t)],h=[i];if(o.length%2!=0)throw new R(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<o.length;C+=2)u.push(zn(e,o[C])),h.push(o[C+1]);let f=[],m=Re.empty();for(let C=u.length-1;C>=0;--C)if(!vf(f,u[C])){let x=u[C],V=h[C];V=Ze(V);let F=a.childContextForFieldPath(x);if(V instanceof fs)f.push(x);else{let M=Ts(V,F);M!=null&&(f.push(x),m.set(x,M))}}let v=new Ge(f);return new ds(m,v,a.fieldTransforms)}function Ts(n,e){if(yf(n=Ze(n)))return Yc("Unsupported field value:",e,n),_f(n,e);if(n instanceof Gn)return(function(r,i){if(!ff(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){let o=[],a=0;for(let u of r){let h=Ts(u,i.childContextForArray(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=Ze(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Vp(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ue.fromDate(r);return{timestampValue:Ji(i.serializer,o)}}if(r instanceof ue){let o=new ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ji(i.serializer,o)}}if(r instanceof wt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ot)return{bytesValue:kd(i.serializer,r._byteString)};if(r instanceof we){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.createError(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Fc(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof at)return(function(a,u){let h=a instanceof at?a.toArray():a;return{mapValue:{fields:{[Vc]:{stringValue:Dc},[Mn]:{arrayValue:{values:h.map(m=>{if(typeof m!="number")throw u.createError("VectorValues must only contain numeric values.");return Nc(u.serializer,m)})}}}}}})(r,i);if(qd(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${ps(r)}`)})(n,e)}function _f(n,e){let t={};return od(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zt(n,(r,i)=>{let o=Ts(i,e.childContextForField(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function yf(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ue||n instanceof wt||n instanceof ot||n instanceof we||n instanceof Gn||n instanceof at||qd(n))}function Yc(n,e,t){if(!yf(t)||!$h(t)){let r=ps(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function zn(n,e,t){if((e=Ze(e))instanceof gn)return e._internalPath;if(typeof e=="string")return Xc(n,e);throw ms("Field path arguments must be of type string or ",n,!1,void 0,t)}var J_=new RegExp("[~\\*/\\[\\]]");function Xc(n,e,t){if(e.search(J_)>=0)throw ms(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gn(...e.split("."))._internalPath}catch{throw ms(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ms(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new R(P.INVALID_ARGUMENT,u+n+h)}function vf(n,e){return n.some(t=>t.isEqual(e))}var zr=class{convertValue(e,t="none"){switch(jt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ct(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return zt(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){let t=e.fields?.[Mn].arrayValue?.values?.map(r=>se(r.doubleValue));return new at(t)}convertGeoPoint(e){return new wt(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=vs(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Nr(e));default:return null}}convertTimestamp(e){let t=Et(e);return new ue(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=oe.fromString(e);Y(jd(r),9688,{name:e});let i=new Fr(r.get(1),r.get(3)),o=new L(r.popFirst(5));return i.isEqual(t)||bt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};var gs=class extends zr{constructor(e){super(),this.firestore=e}convertBytes(e){return new ot(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new we(this.firestore,null,t)}};var wf="@firebase/firestore",bf="4.10.0";var Ps=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new we(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Zc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(zn("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Zc=class extends Ps{data(){return super.data()}};function ey(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new R(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function ty(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Xn=class n extends Ps{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Zn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(zn("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new R(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Xn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xn._jsonSchema={type:le("string",Xn._jsonSchemaVersion),bundleSource:le("string","DocumentSnapshot"),bundleName:le("string"),bundle:le("string")};var Zn=class extends Xn{data(e={}){return super.data(e)}},er=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Yn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Zn(this._firestore,this._userDataWriter,r.key,r,new Yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new R(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Zn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Zn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),f=-1,m=-1;return u.type!==0&&(f=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),m=a.indexOf(u.doc.key)),{type:ny(u.type),doc:h,oldIndex:f,newIndex:m}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new R(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=on.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function ny(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}er._jsonSchemaVersion="firestore/querySnapshot/1.0",er._jsonSchema={type:le("string",er._jsonSchemaVersion),bundleSource:le("string","QuerySnapshot"),bundleName:le("string"),bundle:le("string")};function Ef(n){n=ut(n,qn);let e=ut(n.firestore,Pt),t=Is(e),r=new gs(e);return ey(n._query),cf(t,n._query).then(i=>new er(e,r,n,i))}function Cf(n,e,t){n=ut(n,we);let r=ut(n.firestore,Pt),i=ty(n.converter,e,t),o=Jc(r);return el(r,[mf(o,"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,it.none())])}function If(n,e,t,...r){n=ut(n,we);let i=ut(n.firestore,Pt),o=Jc(i),a;return a=typeof(e=Ze(e))=="string"||e instanceof gn?pf(o,"updateDoc",n._key,e,t,r):gf(o,"updateDoc",n._key,e),el(i,[a.toMutation(n._key,it.exists(!0))])}function Tf(n){return el(ut(n.firestore,Pt),[new Un(n._key,it.none())])}function el(n,e){let t=Is(n);return lf(t,e)}(function(e,t=!0){jh(Ju),Pr(new gt("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new Pt(new Ni(r.getProvider("auth-internal")),new Li(a,r.getProvider("app-check-internal")),hd(a,i),a);return o=z({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Bt(wf,bf,e),Bt(wf,bf,"esm2020")})();var Pf={production:!1,firebase:{apiKey:"TU_API_KEY",authDomain:"TU_AUTH_DOMAIN",projectId:"TU_PROJECT_ID",storageBucket:"TU_STORAGE_BUCKET",messagingSenderId:"TU_MESSAGING_SENDER_ID",appId:"TU_APP_ID"}};var As=class n{app;db;playersCollection="players";constructor(){this.app=Go(Pf.firebase),this.db=Qc(this.app)}async getPlayers(){let e=Wc(this.db,this.playersCollection);return(await Ef(e)).docs.map(r=>ne(z({},r.data()),{id:r.id}))}async savePlayer(e){let t=Jn(this.db,this.playersCollection,e.id);await Cf(t,{name:e.name,defense:e.defense,creation:e.creation,offense:e.offense,enabled:e.enabled})}async updatePlayer(e){let t=Jn(this.db,this.playersCollection,e.id);await If(t,{name:e.name,defense:e.defense,creation:e.creation,offense:e.offense,enabled:e.enabled})}async deletePlayer(e){let t=Jn(this.db,this.playersCollection,e);await Tf(t)}async savePlayers(e){let t=e.map(r=>this.savePlayer(r));await Promise.all(t)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Xt({token:n,factory:n.\u0275fac,providedIn:"root"})};var ht=class n{storageKey="futbol-players";goalkeeperService=Ve(Ft);firebaseService=Ve(As);playersData=_e(Io);isInitialized=!1;players=dt(()=>[...this.playersData()].sort((t,r)=>{if(t.enabled!==r.enabled)return t.enabled?-1:1;if(t.enabled&&r.enabled){let a=t.lastToggled||0,u=r.lastToggled||0;if(a!==u)return a-u}let i=t.order??Number.MAX_SAFE_INTEGER,o=r.order??Number.MAX_SAFE_INTEGER;return i!==o?i-o:t.name.localeCompare(r.name)}));separatedPairs=[["11","4"]];enabledPlayers=()=>this.players().filter(e=>e.enabled);disabledPlayers=()=>this.players().filter(e=>!e.enabled);async initializePlayers(){if(!this.isInitialized)try{let e=await this.firebaseService.getPlayers();e.length>0?this.playersData.set(e):await this.firebaseService.savePlayers(Io),this.isInitialized=!0}catch(e){console.error("Error loading players from Firebase:",e);let t=localStorage.getItem(this.storageKey);t&&this.playersData.set(JSON.parse(t)),this.isInitialized=!0}}async savePlayers(){localStorage.setItem(this.storageKey,JSON.stringify(this.playersData()));try{await this.firebaseService.savePlayers(this.playersData())}catch(e){console.error("Error saving players to Firebase:",e)}}async addPlayer(e){let t=ne(z({},e),{id:crypto.randomUUID(),enabled:!0});this.playersData.update(r=>[...r,t]),await this.savePlayers()}async togglePlayer(e){this.playersData.update(t=>t.map(r=>r.id===e?ne(z({},r),{enabled:!r.enabled,lastToggled:Date.now()}):r)),await this.savePlayers()}async updatePlayer(e){this.playersData.update(t=>t.map(r=>r.id===e.id?e:r)),await this.savePlayers()}async deletePlayer(e){this.playersData.update(t=>t.filter(r=>r.id!==e)),await this.savePlayers()}getPlayerSkill(e){return e.defense+e.creation+e.offense}generateTeams(){let e=this.enabledPlayers();if(e.length<2)return[];for(let i=0;i<100;i++){let o=this.tryGenerateTeams(e);if(this.validateTeams(o))return this.distributeGoalkeepers(o),o}let r=this.tryGenerateTeams(e);return this.distributeGoalkeepers(r),r}distributeGoalkeepers(e){let t=this.goalkeeperService.selectedGoalkeepers();t.length===2&&e.length===2?(e[0].goalkeeper=t[0],e[1].goalkeeper=t[1]):t.length===1&&e.length>=1&&(e[0].goalkeeper=t[0])}tryGenerateTeams(e){let t=[{name:"Equipo 1",players:[],totalSkill:0},{name:"Equipo 2",players:[],totalSkill:0}],r=[{defense:0,creation:0,offense:0},{defense:0,creation:0,offense:0}],i=new Set;for(let[u,h]of this.separatedPairs){let f=e.find(v=>v.id===u),m=e.find(v=>v.id===h);if(f&&m&&!i.has(u)&&!i.has(h)){let v=Math.random()<.5?0:1;t[v].players.push(f),t[v].totalSkill+=this.getPlayerSkill(f),r[v].defense+=f.defense,r[v].creation+=f.creation,r[v].offense+=f.offense,t[1-v].players.push(m),t[1-v].totalSkill+=this.getPlayerSkill(m),r[1-v].defense+=m.defense,r[1-v].creation+=m.creation,r[1-v].offense+=m.offense,i.add(u),i.add(h)}}let o=e.filter(u=>!i.has(u.id)),a=this.shuffleArray(o);a.sort((u,h)=>this.getPlayerSkill(h)-this.getPlayerSkill(u));for(let u of a){let h=Math.abs(r[0].defense-r[1].defense),f=Math.abs(r[0].creation-r[1].creation),m=Math.abs(r[0].offense-r[1].offense),v=Math.abs(t[0].totalSkill-t[1].totalSkill),C=this.calculateImbalanceScore(r[0].defense+u.defense,r[1].defense,r[0].creation+u.creation,r[1].creation,r[0].offense+u.offense,r[1].offense),x=this.calculateImbalanceScore(r[0].defense,r[1].defense+u.defense,r[0].creation,r[1].creation+u.creation,r[0].offense,r[1].offense+u.offense),V=C<=x?0:1;this.canAddToTeam(u,t[V])||(V=1-V),t[V].players.push(u),t[V].totalSkill+=this.getPlayerSkill(u),r[V].defense+=u.defense,r[V].creation+=u.creation,r[V].offense+=u.offense}return t.forEach(u=>{u.players=this.shuffleArray(u.players)}),t}calculateImbalanceScore(e,t,r,i,o,a){let u=Math.abs(e-t),h=Math.abs(r-i),f=Math.abs(o-a);return u+h+f}canAddToTeam(e,t){let r=t.players.map(i=>i.id);for(let[i,o]of this.separatedPairs)if(e.id===i&&r.includes(o)||e.id===o&&r.includes(i))return!1;return!0}validateTeams(e){for(let t of e){let r=t.players.map(i=>i.id);for(let[i,o]of this.separatedPairs)if(r.includes(i)&&r.includes(o))return!1}return!0}shuffleArray(e){let t=[...e];for(let r=t.length-1;r>0;r--){let i=Math.floor(Math.random()*(r+1));[t[r],t[i]]=[t[i],t[r]]}return t}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Xt({token:n,factory:n.\u0275fac,providedIn:"root"})};function ry(n,e){if(n&1){let t=Nt();re(0,"button",2),bn("click",function(){let i=Le(t).$implicit,o=$();return Be(o.onStarClick(i))}),k(1," \u2605 "),ie()}if(n&2){let t=e.$implicit,r=$();Ke("filled",t<=r.value()),Zt("disabled",r.readonly())}}var $t=class n{value=bo(0);readonly=bo(!1);valueChange=vu();stars=[1,2,3,4,5];onStarClick(e){this.readonly()||this.valueChange.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ue({type:n,selectors:[["app-star-rating"]],inputs:{value:[1,"value"],readonly:[1,"readonly"]},outputs:{valueChange:"valueChange"},decls:3,vars:0,consts:[[1,"star-rating"],["type","button",1,"star",3,"filled","disabled"],["type","button",1,"star",3,"click","disabled"]],template:function(t,r){t&1&&(re(0,"div",0),Ye(1,ry,2,3,"button",1,yu),ie()),t&2&&(U(),Xe(r.stars))},styles:[".star-rating[_ngcontent-%COMP%]{display:inline-flex;gap:2px}.star[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;cursor:pointer;color:#444;transition:color .2s,transform .2s;padding:0}.star.filled[_ngcontent-%COMP%]{color:#ffc107}.star[_ngcontent-%COMP%]:not(:disabled):hover{transform:scale(1.2)}.star[_ngcontent-%COMP%]:disabled{cursor:default}"]})};var kf=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Ee(yo),Ee(po))};static \u0275dir=$e({type:n})}return n})(),iy=(()=>{class n extends kf{static \u0275fac=(()=>{let t;return function(i){return(t||(t=go(n)))(i||n)}})();static \u0275dir=$e({type:n,features:[kt]})}return n})(),Nf=new wn("");var sy={provide:Nf,useExisting:wr(()=>Ns),multi:!0};function oy(){let n=Co()?Co().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var ay=new wn(""),Ns=(()=>{class n extends kf{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!oy())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Ee(yo),Ee(po),Ee(ay,8))};static \u0275dir=$e({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&he("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[Er([sy]),kt]})}return n})();function cy(n){return n==null||ly(n)===0}function ly(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var rl=new wn(""),Ff=new wn("");function uy(n){return cy(n.value)?{required:!0}:null}function Af(n){return null}function Lf(n){return n!=null}function Bf(n){return _u(n)?mu(n):n}function Uf(n){let e={};return n.forEach(t=>{e=t!=null?z(z({},e),t):e}),Object.keys(e).length===0?null:e}function jf(n,e){return e.map(t=>t(n))}function hy(n){return!n.validate}function qf(n){return n.map(e=>hy(e)?e:t=>e.validate(t))}function dy(n){if(!n)return null;let e=n.filter(Lf);return e.length==0?null:function(t){return Uf(jf(t,e))}}function il(n){return n!=null?dy(qf(n)):null}function fy(n){if(!n)return null;let e=n.filter(Lf);return e.length==0?null:function(t){let r=jf(t,e).map(Bf);return pu(r).pipe(gu(Uf))}}function sl(n){return n!=null?fy(qf(n)):null}function xf(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function my(n){return n._rawValidators}function gy(n){return n._rawAsyncValidators}function tl(n){return n?Array.isArray(n)?n:[n]:[]}function Ss(n,e){return Array.isArray(n)?n.includes(e):n===e}function Sf(n,e){let t=tl(e);return tl(n).forEach(i=>{Ss(t,i)||t.push(i)}),t}function Vf(n,e){return tl(e).filter(t=>!Ss(n,t))}var Vs=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=il(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=sl(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},rr=class extends Vs{name;get formDirective(){return null}get path(){return null}},ei=class extends Vs{_parent=null;name=null;valueAccessor=null},Ds=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var Gf=(()=>{class n extends Ds{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Ee(ei,2))};static \u0275dir=$e({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Ke("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[kt]})}return n})(),zf=(()=>{class n extends Ds{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Ee(rr,10))};static \u0275dir=$e({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["","formArray",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Ke("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[kt]})}return n})();var Qr="VALID",xs="INVALID",tr="PENDING",Jr="DISABLED",Kt=class{},Ms=class extends Kt{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Xr=class extends Kt{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Zr=class extends Kt{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},nr=class extends Kt{status;source;constructor(e,t){super(),this.status=e,this.source=t}},nl=class extends Kt{source;constructor(e){super(),this.source=e}},Rs=class extends Kt{source;constructor(e){super(),this.source=e}};function $f(n){return(Fs(n)?n.validators:n)||null}function py(n){return Array.isArray(n)?il(n):n||null}function Kf(n,e){return(Fs(e)?e.asyncValidators:n)||null}function _y(n){return Array.isArray(n)?sl(n):n||null}function Fs(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function yy(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new _i(1e3,"");if(!r[t])throw new _i(1001,"")}function vy(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new _i(1002,"")})}var Os=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Ot(this.statusReactive)}set status(e){Ot(()=>this.statusReactive.set(e))}_status=dt(()=>this.statusReactive());statusReactive=_e(void 0);get valid(){return this.status===Qr}get invalid(){return this.status===xs}get pending(){return this.status==tr}get disabled(){return this.status===Jr}get enabled(){return this.status!==Jr}errors;get pristine(){return Ot(this.pristineReactive)}set pristine(e){Ot(()=>this.pristineReactive.set(e))}_pristine=dt(()=>this.pristineReactive());pristineReactive=_e(!0);get dirty(){return!this.pristine}get touched(){return Ot(this.touchedReactive)}set touched(e){Ot(()=>this.touchedReactive.set(e))}_touched=dt(()=>this.touchedReactive());touchedReactive=_e(!1);get untouched(){return!this.touched}_events=new fu;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Sf(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Sf(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Vf(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Vf(e,this._rawAsyncValidators))}hasValidator(e){return Ss(this._rawValidators,e)}hasAsyncValidator(e){return Ss(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ne(z({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Zr(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Zr(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ne(z({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Xr(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Xr(!0,r))}markAsPending(e={}){this.status=tr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new nr(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ne(z({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Jr,this.errors=null,this._forEachChild(i=>{i.disable(ne(z({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ms(this.value,r)),this._events.next(new nr(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ne(z({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Qr,this._forEachChild(r=>{r.enable(ne(z({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ne(z({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qr||this.status===tr)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ms(this.value,t)),this._events.next(new nr(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ne(z({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jr:Qr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=tr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=Bf(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new nr(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new br,this.statusChanges=new br}_calculateStatus(){return this._allControlsDisabled()?Jr:this.errors?xs:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(tr)?tr:this._anyControlsHaveStatus(xs)?xs:Qr}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Xr(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Zr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Fs(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=py(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=_y(this._rawAsyncValidators)}},ks=class extends Os{constructor(e,t,r){super($f(t),Kf(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){vy(this,!0,e),Object.keys(e).forEach(r=>{yy(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,ne(z({},t),{onlySelf:!0}))}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Rs(this))}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var ol=new wn("",{factory:()=>al}),al="always";function wy(n,e){return[...e.path,n]}function Hf(n,e,t=al){Wf(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),Ey(n,e),Iy(n,e),Cy(n,e),by(n,e)}function Df(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function by(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Wf(n,e){let t=my(n);e.validator!==null?n.setValidators(xf(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=gy(n);e.asyncValidator!==null?n.setAsyncValidators(xf(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Df(e._rawValidators,i),Df(e._rawAsyncValidators,i)}function Ey(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Qf(n,e)})}function Cy(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Qf(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Qf(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function Iy(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function Ty(n,e){n==null,Wf(n,e)}function Py(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Ay(n){return Object.getPrototypeOf(n.constructor)===iy}function xy(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Sy(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===Ns?t=o:Ay(o)?r=o:i=o}),i||r||t||null}var Vy={provide:rr,useExisting:wr(()=>cl)},Yr=Promise.resolve(),cl=(()=>{class n extends rr{callSetDisabledState;get submitted(){return Ot(this.submittedReactive)}_submitted=dt(()=>this.submittedReactive());submittedReactive=_e(!1);_directives=new Set;form;ngSubmit=new br;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new ks({},il(t),sl(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Yr.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Hf(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Yr.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Yr.then(()=>{let r=this._findContainer(t.path),i=new ks({});Ty(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Yr.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Yr.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),xy(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new nl(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(Ee(rl,10),Ee(Ff,10),Ee(ol,8))};static \u0275dir=$e({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup","",3,"formArray",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&he("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Er([Vy]),kt]})}return n})();function Mf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Rf(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Dy=class extends Os{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super($f(t),Kf(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fs(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Rf(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Rs(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Mf(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Mf(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Rf(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var My={provide:ei,useExisting:wr(()=>ll)},Of=Promise.resolve(),ll=(()=>{class n extends ei{_changeDetectorRef;callSetDisabledState;control=new Dy;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new br;constructor(t,r,i,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Sy(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),Py(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Hf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Of.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&Eo(r);Of.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?wy(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(Ee(rr,9),Ee(rl,10),Ee(Ff,10),Ee(Nf,10),Ee(wu,8),Ee(ol,8))};static \u0275dir=$e({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Er([My]),kt,mo]})}return n})();var Jf=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=$e({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var Ry=(()=>{class n{_validator=Af;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Af,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=$e({type:n,features:[mo]})}return n})();var Oy={provide:rl,useExisting:wr(()=>ul),multi:!0};var ul=(()=>{class n extends Ry{required;inputName="required";normalizeInput=Eo;createValidator=t=>uy;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=go(n)))(i||n)}})();static \u0275dir=$e({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&yi("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Er([Oy]),kt]})}return n})();var ky=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=vo({type:n});static \u0275inj=fo({})}return n})();var Yf=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:ol,useValue:t.callSetDisabledState??al}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vo({type:n});static \u0275inj=fo({imports:[ky]})}return n})();var Ls=class n{playerService=Ve(ht);name=_e("");defense=_e(3);creation=_e(3);offense=_e(3);async addPlayer(){this.name().trim()&&(await this.playerService.addPlayer({name:this.name().trim(),defense:this.defense(),creation:this.creation(),offense:this.offense()}),this.resetForm())}resetForm(){this.name.set(""),this.defense.set(3),this.creation.set(3),this.offense.set(3)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ue({type:n,selectors:[["app-player-form"]],decls:23,vars:5,consts:[[1,"player-form"],[3,"ngSubmit"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","placeholder","Ingresa el nombre","required","",3,"ngModelChange","ngModel"],[1,"skills-group"],[1,"skill-item"],[3,"valueChange","value"],["type","submit",1,"btn-add",3,"disabled"]],template:function(t,r){t&1&&(N(0,"div",0)(1,"h2"),k(2,"Agregar Jugador"),O(),N(3,"form",1),he("ngSubmit",function(){return r.addPlayer()}),N(4,"div",2)(5,"label",3),k(6,"Nombre del jugador"),O(),N(7,"input",4),he("ngModelChange",function(o){return r.name.set(o)}),O()(),N(8,"div",5)(9,"div",6)(10,"label"),k(11,"Defensa"),O(),N(12,"app-star-rating",7),he("valueChange",function(o){return r.defense.set(o)}),O()(),N(13,"div",6)(14,"label"),k(15,"Creaci\xF3n"),O(),N(16,"app-star-rating",7),he("valueChange",function(o){return r.creation.set(o)}),O()(),N(17,"div",6)(18,"label"),k(19,"Ofensiva"),O(),N(20,"app-star-rating",7),he("valueChange",function(o){return r.offense.set(o)}),O()()(),N(21,"button",8),k(22," \u2795 Agregar Jugador "),O()()()),t&2&&(U(7),Me("ngModel",r.name()),U(5),Me("value",r.defense()),U(4),Me("value",r.creation()),U(4),Me("value",r.offense()),U(),Me("disabled",!r.name().trim()))},dependencies:[Yf,Jf,Ns,Gf,zf,ul,ll,cl,$t],styles:[".player-form[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:2rem}@media(max-width:768px){.player-form[_ngcontent-%COMP%]{padding:1.5rem;border-radius:12px}}.player-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00d4ff;margin-bottom:1.5rem}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem}}.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1rem}}.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#fffc;font-weight:500}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem}}.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;background:#ffffff14;border:1px solid rgba(255,255,255,.2);border-radius:8px;color:#fff;font-size:1rem;transition:border-color .3s,box-shadow .3s;box-sizing:border-box}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.625rem .875rem;font-size:.9rem}}.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#fff6}.player-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#00d4ff;box-shadow:0 0 0 3px #00d4ff33}.player-form[_ngcontent-%COMP%]   .skills-group[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:1.5rem;margin-bottom:1.5rem}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   .skills-group[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1rem}}@media(max-width:480px){.player-form[_ngcontent-%COMP%]   .skills-group[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}}.player-form[_ngcontent-%COMP%]   .skills-group[_ngcontent-%COMP%]   .skill-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#fffc;font-weight:500;font-size:.9rem}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   .skills-group[_ngcontent-%COMP%]   .skill-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.85rem}}.player-form[_ngcontent-%COMP%]   .btn-add[_ngcontent-%COMP%]{width:100%;padding:1rem;background:linear-gradient(90deg,#00d4ff,#7b2cbf);border:none;border-radius:8px;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:transform .3s,box-shadow .3s}@media(max-width:768px){.player-form[_ngcontent-%COMP%]   .btn-add[_ngcontent-%COMP%]{padding:.875rem;font-size:.9rem}}.player-form[_ngcontent-%COMP%]   .btn-add[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 20px #00d4ff66}.player-form[_ngcontent-%COMP%]   .btn-add[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"]})};var Fy=(n,e)=>e.id;function Ly(n,e){n&1&&(N(0,"p",8),k(1,"No hay jugadores disponibles."),O())}function By(n,e){if(n&1&&k(0),n&2){let t=$().$index;vi(" ",t+1," ")}}function Uy(n,e){if(n&1&&k(0),n&2){let t=$().$implicit,r=$(2);vi(" ",r.getEnabledIndex(t)+1+r.selectedGoalkeepers().length," ")}}function jy(n,e){n&1&&(N(0,"span",14),k(1,"\u{1F9E4}"),O())}function qy(n,e){if(n&1){let t=Nt();N(0,"label",15)(1,"input",17),he("change",function(){Le(t);let i=$().$implicit,o=$(2);return Be(o.togglePlayer(i.id))}),O(),je(2,"span",18),O()}if(n&2){let t=$().$implicit;U(),Me("checked",t.enabled)}}function Gy(n,e){n&1&&je(0,"td")(1,"td")(2,"td")(3,"td")}function zy(n,e){if(n&1){let t=Nt();N(0,"td")(1,"app-star-rating",19),he("valueChange",function(i){Le(t);let o=$().$implicit,a=$(2);return Be(a.updateSkill(o,"defense",i))}),O()(),N(2,"td")(3,"app-star-rating",19),he("valueChange",function(i){Le(t);let o=$().$implicit,a=$(2);return Be(a.updateSkill(o,"creation",i))}),O()(),N(4,"td")(5,"app-star-rating",19),he("valueChange",function(i){Le(t);let o=$().$implicit,a=$(2);return Be(a.updateSkill(o,"offense",i))}),O()(),N(6,"td",20),k(7),O()}if(n&2){let t=$().$implicit,r=$(2);U(),Me("value",t.defense)("readonly",!t.enabled),U(2),Me("value",t.creation)("readonly",!t.enabled),U(2),Me("value",t.offense)("readonly",!t.enabled),U(2),Fe(r.getPlayerTotalSkill(t))}}function $y(n,e){if(n&1&&(N(0,"tr")(1,"td",12),Te(2,By,1,1)(3,Uy,1,1),O(),N(4,"td",13),Te(5,jy,2,0,"span",14)(6,qy,3,1,"label",15),O(),N(7,"td",16),k(8),O(),Te(9,Gy,4,0)(10,zy,8,7),O()),n&2){let t=e.$implicit,r=$(2);Ke("disabled-row",!r.isGoalkeeper(t)&&!t.enabled)("goalkeeper-row",r.isGoalkeeper(t))("first-twelve",!r.isGoalkeeper(t)&&t.enabled&&r.getEnabledIndex(t)<12)("reserve-players",!r.isGoalkeeper(t)&&t.enabled&&r.getEnabledIndex(t)>=12),U(2),Pe(r.isGoalkeeper(t)?2:t.enabled?3:-1),U(3),Pe(r.isGoalkeeper(t)?5:6),U(3),Fe(t.name),U(),Pe(r.isGoalkeeper(t)?9:10)}}function Ky(n,e){if(n&1&&(N(0,"div",9)(1,"table")(2,"thead")(3,"tr")(4,"th"),k(5,"#"),O(),je(6,"th"),N(7,"th"),k(8,"Nombre"),O(),N(9,"th"),k(10,"Defensa"),O(),N(11,"th"),k(12,"Creaci\xF3n"),O(),N(13,"th"),k(14,"Ofensiva"),O(),N(15,"th"),k(16,"Total"),O()()(),N(17,"tbody"),Ye(18,$y,11,12,"tr",11,Fy),O()()()),n&2){let t=$();U(18),Xe(t.allPlayersWithGoalkeepers())}}function Hy(n,e){if(n&1){let t=Nt();N(0,"div",21),he("click",function(){Le(t);let i=$();return Be(i.closeModal())}),N(1,"div",22),he("click",function(i){return Le(t),Be(i.stopPropagation())}),N(2,"button",23),he("click",function(){Le(t);let i=$();return Be(i.closeModal())}),k(3," \u2715 "),O(),je(4,"app-player-form"),O()()}}var Bs=class n{playerService=Ve(ht);goalkeeperService=Ve(Ft);players=this.playerService.players;enabledPlayers=this.playerService.enabledPlayers;disabledPlayers=this.playerService.disabledPlayers;showModal=_e(!1);selectedGoalkeepers=this.goalkeeperService.selectedGoalkeepers;allPlayersWithGoalkeepers=dt(()=>{let e=this.selectedGoalkeepers(),t=this.players();return[...e,...t]});async updateSkill(e,t,r){await this.playerService.updatePlayer(ne(z({},e),{[t]:r}))}async deletePlayer(e){await this.playerService.deletePlayer(e)}async togglePlayer(e){await this.playerService.togglePlayer(e)}getTotalSkill(e){return this.playerService.getPlayerSkill(e)}getEnabledIndex(e){return this.enabledPlayers().findIndex(t=>t.id===e.id)}isGoalkeeper(e){return"selected"in e}getDefense(e){return this.isGoalkeeper(e)?e.skill:e.defense}getCreation(e){return this.isGoalkeeper(e)?e.skill:e.creation}getOffense(e){return this.isGoalkeeper(e)?e.skill:e.offense}getPlayerTotalSkill(e){return this.isGoalkeeper(e)?e.skill*3:this.getTotalSkill(e)}openModal(){this.showModal.set(!0)}closeModal(){this.showModal.set(!1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ue({type:n,selectors:[["app-player-list"]],decls:17,vars:4,consts:[[1,"player-list"],[1,"header"],[1,"title-section"],["title","Agregar jugador",1,"btn-add-player",3,"click"],[1,"counter"],[1,"counter-label"],[1,"counter-value"],[1,"counter-total"],[1,"empty-message"],[1,"table-container"],[1,"modal-overlay"],[3,"disabled-row","goalkeeper-row","first-twelve","reserve-players"],[1,"number-cell"],[1,"checkbox-cell"],[1,"goalkeeper-badge"],[1,"checkbox-container"],[1,"player-name"],["type","checkbox",3,"change","checked"],[1,"checkmark"],[3,"valueChange","value","readonly"],[1,"total-skill"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],["title","Cerrar",1,"btn-close",3,"click"]],template:function(t,r){t&1&&(N(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),k(4,"Jugadores"),O(),N(5,"button",3),he("click",function(){return r.openModal()}),k(6," \u2795 "),O()(),N(7,"div",4)(8,"span",5),k(9,"Habilitados:"),O(),N(10,"span",6),k(11),O(),N(12,"span",7),k(13),O()()(),Te(14,Ly,2,0,"p",8)(15,Ky,20,0,"div",9),Te(16,Hy,5,0,"div",10),O()),t&2&&(U(11),Fe(r.enabledPlayers().length),U(2),vi("/ ",r.players().length),U(),Pe(r.allPlayersWithGoalkeepers().length===0?14:15),U(2),Pe(r.showModal()?16:-1))},dependencies:[$t,Ls],styles:['.player-list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem;margin-bottom:1rem}}.player-list[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{gap:.75rem}}.player-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00d4ff;margin:0}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}}.player-list[_ngcontent-%COMP%]   .btn-add-player[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff,#7b2cbf);border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.2rem;transition:all .3s;box-shadow:0 4px 15px #00d4ff4d}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .btn-add-player[_ngcontent-%COMP%]{width:36px;height:36px;font-size:1rem}}.player-list[_ngcontent-%COMP%]   .btn-add-player[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 20px #00d4ff80}.player-list[_ngcontent-%COMP%]   .btn-add-player[_ngcontent-%COMP%]:active{transform:scale(.95)}.player-list[_ngcontent-%COMP%]   .counter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:#00d4ff1a;border:1px solid rgba(0,212,255,.3);border-radius:8px;padding:.5rem 1rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .counter[_ngcontent-%COMP%]{padding:.4rem .75rem;font-size:.9rem}}.player-list[_ngcontent-%COMP%]   .counter[_ngcontent-%COMP%]   .counter-label[_ngcontent-%COMP%]{color:#fffc;font-weight:500}.player-list[_ngcontent-%COMP%]   .counter[_ngcontent-%COMP%]   .counter-value[_ngcontent-%COMP%]{color:#00d4ff;font-weight:700;font-size:1.2rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .counter[_ngcontent-%COMP%]   .counter-value[_ngcontent-%COMP%]{font-size:1.1rem}}.player-list[_ngcontent-%COMP%]   .counter[_ngcontent-%COMP%]   .counter-total[_ngcontent-%COMP%]{color:#fff9;font-weight:500}.player-list[_ngcontent-%COMP%]   .empty-message[_ngcontent-%COMP%]{text-align:center;color:#fff9;padding:2rem}.player-list[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{margin:0 -1rem;padding:0 1rem}}.player-list[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#ffffff0d;border-radius:12px;overflow:hidden}.player-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .player-list[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid rgba(255,255,255,.1)}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .player-list[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem .5rem;font-size:.875rem}}.player-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#00d4ff1a;color:#00d4ff;font-weight:600;text-transform:uppercase;font-size:.85rem;letter-spacing:.5px}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;white-space:nowrap}}.player-list[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#ffffff08}.player-list[_ngcontent-%COMP%]   .disabled-row[_ngcontent-%COMP%]{opacity:.5}.player-list[_ngcontent-%COMP%]   .disabled-row[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%]{color:#fff9}.player-list[_ngcontent-%COMP%]   .disabled-row[_ngcontent-%COMP%]   .total-skill[_ngcontent-%COMP%]{color:#ffc10799}.player-list[_ngcontent-%COMP%]   .goalkeeper-row[_ngcontent-%COMP%]{background-color:#00d4ff26!important;font-weight:500}.player-list[_ngcontent-%COMP%]   .goalkeeper-row[_ngcontent-%COMP%]:hover{background-color:#00d4ff40!important}.player-list[_ngcontent-%COMP%]   .goalkeeper-row[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%]{color:#00d4ff;font-weight:600}.player-list[_ngcontent-%COMP%]   .goalkeeper-badge[_ngcontent-%COMP%]{font-size:1.5rem;display:inline-block}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .goalkeeper-badge[_ngcontent-%COMP%]{font-size:1.3rem}}.player-list[_ngcontent-%COMP%]   .first-twelve[_ngcontent-%COMP%]{background-color:#90ee9026!important}.player-list[_ngcontent-%COMP%]   .first-twelve[_ngcontent-%COMP%]:hover{background-color:#90ee9040!important}.player-list[_ngcontent-%COMP%]   .reserve-players[_ngcontent-%COMP%]{background-color:#ffa50026!important}.player-list[_ngcontent-%COMP%]   .reserve-players[_ngcontent-%COMP%]:hover{background-color:#ffa50040!important}.player-list[_ngcontent-%COMP%]   .number-cell[_ngcontent-%COMP%]{width:50px;text-align:center;font-weight:700;color:#00d4ff;font-size:1rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .number-cell[_ngcontent-%COMP%]{width:40px;font-size:.9rem}}.player-list[_ngcontent-%COMP%]   .checkbox-cell[_ngcontent-%COMP%]{width:50px;text-align:center;padding:.5rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .checkbox-cell[_ngcontent-%COMP%]{width:40px;padding:.5rem .25rem}}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{position:relative;cursor:pointer;-webkit-user-select:none;user-select:none;display:inline-block}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff,#7b2cbf);border-color:#00d4ff}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{display:block;height:20px;width:20px;background-color:#ffffff1a;border:2px solid rgba(255,255,255,.3);border-radius:4px;transition:all .3s}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{height:18px;width:18px}}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:6px;top:2px;width:5px;height:10px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{left:5px;top:1px;width:4px;height:9px}}.player-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]:hover   .checkmark[_ngcontent-%COMP%]{border-color:#00d4ff}.player-list[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%]{font-weight:500;color:#fff}.player-list[_ngcontent-%COMP%]   .total-skill[_ngcontent-%COMP%]{font-weight:700;color:#ffc107;font-size:1.1rem}.player-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{gap:.25rem}}.player-list[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{border-radius:8px;padding:.5rem .75rem;cursor:pointer;transition:all .3s;border:1px solid;background:#ff525233;border-color:#ff52524d}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{padding:.4rem .6rem;font-size:.8rem}}.player-list[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]:hover{background:#ff525266;transform:scale(1.1)}.player-list[_ngcontent-%COMP%]   .modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.player-list[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:16px;padding:2rem;max-width:500px;width:100%;max-height:90vh;overflow-y:auto;position:relative;box-shadow:0 10px 40px #00d4ff4d;border:1px solid rgba(0,212,255,.2);animation:_ngcontent-%COMP%_slideIn .3s ease-in-out}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{padding:1.5rem;max-width:100%}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}.player-list[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;background:#ffffff1a;border:1px solid rgba(255,255,255,.2);border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.2rem;color:#fffc;transition:all .3s}@media(max-width:768px){.player-list[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{width:28px;height:28px;font-size:1rem}}.player-list[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#ff52524d;border-color:#ff525280;color:#fff;transform:rotate(90deg)}.player-list[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:active{transform:rotate(90deg) scale(.9)}']})};var Wy=(n,e)=>e.name,Xf=(n,e)=>e.id;function Qy(n,e){n&1&&(re(0,"p",5),k(1,"Se necesitan al menos 2 jugadores para generar equipos."),ie())}function Jy(n,e){if(n&1&&wo(0,"img",17),n&2){let t=$(2).$implicit;Zt("src",t.goalkeeper.image,_o)("alt",t.goalkeeper.name)}}function Yy(n,e){n&1&&(re(0,"span",18),k(1,"\u{1F9E4}"),ie())}function Xy(n,e){if(n&1&&(re(0,"div",13)(1,"div",15)(2,"div",16),Te(3,Jy,1,2,"img",17)(4,Yy,2,0,"span",18),ie(),re(5,"div",19),k(6),ie(),re(7,"div",20)(8,"div",21),k(9),ie()()()()),n&2){let t=$().$implicit;U(3),Pe(t.goalkeeper.image?3:4),U(3),Fe(t.goalkeeper.skill),U(3),Fe(t.goalkeeper.name)}}function Zy(n,e){if(n&1&&wo(0,"img",17),n&2){let t=$().$implicit;Zt("src",t.image,_o)("alt",t.name)}}function e0(n,e){if(n&1&&(re(0,"span",24),k(1),ie()),n&2){let t=$().$implicit,r=$(5);U(),Fe(r.getInitial(t.name))}}function t0(n,e){n&1&&k(0," \u{1F6E1}\uFE0F ")}function n0(n,e){n&1&&k(0," \u{1F3AF} ")}function r0(n,e){n&1&&k(0," \u2694\uFE0F ")}function i0(n,e){if(n&1&&(re(0,"div",23)(1,"div",16),Te(2,Zy,1,2,"img",17)(3,e0,2,1,"span",24),ie(),re(4,"div",25),k(5),ie(),re(6,"div",20)(7,"div",21),k(8),ie(),re(9,"div",26),Te(10,t0,1,0)(11,n0,1,0)(12,r0,1,0),ie()()()),n&2){let t=e.$implicit,r=$(5);yi("data-position",r.getPlayerPosition(t)),U(2),Pe(t.image?2:3),U(3),Fe(r.getPlayerSkill(t)),U(3),Fe(t.name),U(2),Pe(r.getPlayerPosition(t)==="defense"?10:r.getPlayerPosition(t)==="creation"?11:12)}}function s0(n,e){if(n&1&&(re(0,"div",22),Ye(1,i0,13,5,"div",23,Xf),ie()),n&2){let t=$().$index,r=$(),i=r.$implicit,o=r.$index,a=$(2);U(),Xe(a.getRowPlayers(a.getSortedPlayers(i.players,o===1),t))}}function o0(n,e){if(n&1&&Te(0,s0,3,0,"div",22),n&2){let t=e.$index;Pe(t%3===0?0:-1)}}function a0(n,e){if(n&1&&(re(0,"div",9)(1,"div",10)(2,"h3"),k(3),ie(),re(4,"span",11),k(5),ie()(),re(6,"div",12),Te(7,Xy,10,3,"div",13),re(8,"div",14),Ye(9,o0,1,1,null,null,Xf),ie()()()),n&2){let t=e.$implicit,r=e.$index,i=$(2);Ke("team-two",r===1),U(3),Fe(t.name),U(2),wi(" Total: ",t.totalSkill," | Prom: ",i.getSkillAverage(t)," "),U(2),Pe(t.goalkeeper?7:-1),U(2),Xe(i.getSortedPlayers(t.players,r===1))}}function c0(n,e){if(n&1&&(re(0,"div",6)(1,"div",7),Ye(2,a0,11,6,"div",8,Wy),ie()()),n&2){let t=$();U(2),Xe(t.teams())}}var Us=class n{playerService=Ve(ht);teams=_e([]);players=this.playerService.players;generateTeams(){let e=this.playerService.generateTeams();this.teams.set(e)}generateTeamsAndScroll(){this.generateTeams(),setTimeout(()=>{let e=document.getElementById("teams-section");if(e){let t=e.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:t-50,behavior:"smooth"})}},100)}scrollToPlayers(){let e=document.getElementById("players");if(e){let t=e.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:t-80,behavior:"smooth"})}}getSkillAverage(e){return e.players.length===0?0:Math.round(e.totalSkill/e.players.length*10)/10}getInitial(e){return e.charAt(0).toUpperCase()}getPlayerSkill(e){return e.defense+e.creation+e.offense}getPlayerPosition(e){return e.defense>=e.creation&&e.defense>=e.offense?"defense":e.creation>=e.offense?"creation":"offense"}getSortedPlayers(e,t=!1){return[...e].sort((r,i)=>{let o=t?{offense:0,creation:1,defense:2}:{defense:0,creation:1,offense:2},a=this.getPlayerPosition(r),u=this.getPlayerPosition(i);return o[a]-o[u]})}getRowPlayers(e,t){return e.slice(t,t+3)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ue({type:n,selectors:[["app-team-generator"]],decls:12,vars:4,consts:[[1,"team-generator"],[1,"config-section"],[1,"btn-generate",3,"click","disabled"],["title","Ir a lista de jugadores",1,"btn-floating","btn-floating-top",3,"click"],["title","Repartir Equipos",1,"btn-floating",3,"click","disabled"],[1,"warning"],["id","teams-section",1,"teams-container"],[1,"teams-field"],[1,"team-section",3,"team-two"],[1,"team-section"],[1,"team-header"],[1,"team-stats"],[1,"formation-field"],[1,"formation-row","goalkeeper-row"],[1,"formation-rows"],[1,"player-avatar","goalkeeper"],[1,"avatar-circle"],[1,"player-image",3,"src","alt"],[1,"goalkeeper-icon"],[1,"player-rating","goalkeeper-rating"],[1,"player-info"],[1,"player-name"],[1,"formation-row"],[1,"player-avatar"],[1,"player-initial"],[1,"player-rating"],[1,"player-position"]],template:function(t,r){t&1&&(re(0,"div",0)(1,"h2"),k(2,"Generar Equipos"),ie(),re(3,"div",1)(4,"button",2),bn("click",function(){return r.generateTeams()}),k(5," \u{1F3B2} Repartir Equipos "),ie()(),re(6,"button",3),bn("click",function(){return r.scrollToPlayers()}),k(7," \u{1F3C3} "),ie(),re(8,"button",4),bn("click",function(){return r.generateTeamsAndScroll()}),k(9," \u26BD "),ie(),Te(10,Qy,2,0,"p",5),Te(11,c0,4,0,"div",6),ie()),t&2&&(U(4),Zt("disabled",r.players().length<2),U(4),Zt("disabled",r.players().length<2),U(2),Pe(r.players().length<2?10:-1),U(),Pe(r.teams().length>0?11:-1))},styles:['.team-generator[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00d4ff;margin-bottom:1.5rem}.team-generator[_ngcontent-%COMP%]   .config-section[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem;align-items:flex-end;margin-bottom:2rem;padding:1.5rem;background:#ffffff0d;border-radius:12px}.team-generator[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#fffc;font-weight:500}.team-generator[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80px;padding:.75rem 1rem;background:#ffffff14;border:1px solid rgba(255,255,255,.2);border-radius:8px;color:#fff;font-size:1rem;text-align:center}.team-generator[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#00d4ff;box-shadow:0 0 0 3px #00d4ff33}.team-generator[_ngcontent-%COMP%]   .btn-generate[_ngcontent-%COMP%]{padding:.75rem 2rem;background:linear-gradient(90deg,#7b2cbf,#00d4ff);border:none;border-radius:8px;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:transform .3s,box-shadow .3s}.team-generator[_ngcontent-%COMP%]   .btn-generate[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 20px #7b2cbf66}.team-generator[_ngcontent-%COMP%]   .btn-generate[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.team-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:#ffc107;text-align:center;padding:1rem;background:#ffc1071a;border-radius:8px}.team-generator[_ngcontent-%COMP%]   .teams-container[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:12px;overflow:hidden}.team-generator[_ngcontent-%COMP%]   .teams-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:linear-gradient(180deg,#228b2266,#228b224d,#228b2266);position:relative}.team-generator[_ngcontent-%COMP%]   .teams-field[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:0;right:0;height:3px;background:#ffffff4d;transform:translateY(-50%);z-index:1}.team-generator[_ngcontent-%COMP%]   .teams-field[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;width:200px;height:200px;border:3px solid rgba(255,255,255,.3);border-radius:50%;transform:translate(-50%,-50%);z-index:1}.team-generator[_ngcontent-%COMP%]   .team-section[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;position:relative}.team-generator[_ngcontent-%COMP%]   .team-section[_ngcontent-%COMP%]:first-child{border-bottom:3px solid rgba(255,255,255,.3)}.team-generator[_ngcontent-%COMP%]   .team-section[_ngcontent-%COMP%]:first-child:before{content:"";position:absolute;top:40px;left:50%;width:200px;height:60px;border:3px solid rgba(255,255,255,.25);border-top:none;transform:translate(-50%);z-index:0}.team-generator[_ngcontent-%COMP%]   .team-section[_ngcontent-%COMP%]:last-child:before{content:"";position:absolute;bottom:20px;left:50%;width:200px;height:60px;border:3px solid rgba(255,255,255,.25);border-bottom:none;transform:translate(-50%);z-index:0}.team-generator[_ngcontent-%COMP%]   .team-header[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff33,#7b2cbf33);padding:1rem 1.25rem;display:flex;justify-content:space-between;align-items:center}.team-generator[_ngcontent-%COMP%]   .team-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:1.1rem}.team-generator[_ngcontent-%COMP%]   .team-header[_ngcontent-%COMP%]   .team-stats[_ngcontent-%COMP%]{font-size:.85rem;color:#ffc107;font-weight:500}.team-generator[_ngcontent-%COMP%]   .formation-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:linear-gradient(180deg,#228b224d,#228b221a);padding:2rem 1rem;min-height:400px}.team-generator[_ngcontent-%COMP%]   .team-two[_ngcontent-%COMP%]   .formation-field[_ngcontent-%COMP%]{flex-direction:column-reverse}.team-generator[_ngcontent-%COMP%]   .formation-rows[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem;flex:1;justify-content:space-evenly}.team-generator[_ngcontent-%COMP%]   .formation-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1.5rem;flex-wrap:wrap}.team-generator[_ngcontent-%COMP%]   .player-avatar[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem;position:relative}.team-generator[_ngcontent-%COMP%]   .player-avatar.goalkeeper[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00d4ff,#09c);border-color:#00d4ff}.team-generator[_ngcontent-%COMP%]   .player-avatar[data-position=defense][_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%], .team-generator[_ngcontent-%COMP%]   .player-avatar[data-position=defense][_ngcontent-%COMP%]   .player-rating[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4a90e2,#357abd);border-color:#4a90e2}.team-generator[_ngcontent-%COMP%]   .player-avatar[data-position=creation][_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%], .team-generator[_ngcontent-%COMP%]   .player-avatar[data-position=creation][_ngcontent-%COMP%]   .player-rating[_ngcontent-%COMP%]{background:linear-gradient(135deg,#50c878,#3da35d);border-color:#50c878}.team-generator[_ngcontent-%COMP%]   .player-avatar[data-position=offense][_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%], .team-generator[_ngcontent-%COMP%]   .player-avatar[data-position=offense][_ngcontent-%COMP%]   .player-rating[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff6b6b,#ee5a6f);border-color:#ff6b6b}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:50%;background:linear-gradient(135deg,#ff6b6b,#ee5a6f);border:3px solid rgba(255,255,255,.3);display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;color:#fff;box-shadow:0 4px 12px #0000004d;transition:transform .3s;overflow:hidden}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]   .player-initial[_ngcontent-%COMP%]{font-size:1.8rem}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]   .goalkeeper-icon[_ngcontent-%COMP%]{font-size:2rem}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]   .player-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:center 60%;border-radius:50%}.team-generator[_ngcontent-%COMP%]   .player-rating[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;background:#ff6b6b;color:#fff;font-weight:700;font-size:.9rem;padding:.25rem .5rem;border-radius:12px;min-width:35px;text-align:center;box-shadow:0 2px 8px #0000004d}.team-generator[_ngcontent-%COMP%]   .player-rating.goalkeeper-rating[_ngcontent-%COMP%]{background:#00d4ff}.team-generator[_ngcontent-%COMP%]   .player-info[_ngcontent-%COMP%]{text-align:center;max-width:100px}.team-generator[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%]{color:#fff;font-weight:600;font-size:.85rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.team-generator[_ngcontent-%COMP%]   .player-position[_ngcontent-%COMP%]{font-size:.9rem;margin-top:.25rem}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:fixed;bottom:2rem;right:2rem;width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#7b2cbf,#00d4ff);border:none;color:#fff;font-size:2rem;box-shadow:0 4px 20px #7b2cbf80;cursor:pointer;z-index:1000;transition:transform .3s,box-shadow .3s}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1);box-shadow:0 6px 30px #7b2cbfb3}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95)}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.team-generator[_ngcontent-%COMP%]   .btn-floating-top[_ngcontent-%COMP%]{bottom:6rem;background:linear-gradient(135deg,#00d4ff,#7b2cbf)}@media(max-width:768px){.team-generator[_ngcontent-%COMP%]   .btn-floating-top[_ngcontent-%COMP%]{bottom:5rem;width:50px;height:50px;font-size:1.5rem}}@media(max-width:768px){.team-generator[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem}.team-generator[_ngcontent-%COMP%]   .config-section[_ngcontent-%COMP%]{padding:1rem;gap:1rem;margin-bottom:1.5rem;flex-direction:column;align-items:stretch}.team-generator[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]{width:100%}.team-generator[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem}.team-generator[_ngcontent-%COMP%]   .config-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.625rem .875rem;font-size:.9rem}.team-generator[_ngcontent-%COMP%]   .btn-generate[_ngcontent-%COMP%], .team-generator[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{width:100%;padding:.875rem;font-size:.9rem}.team-generator[_ngcontent-%COMP%]   .teams-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.team-generator[_ngcontent-%COMP%]   .team-header[_ngcontent-%COMP%]{padding:.875rem 1rem}.team-generator[_ngcontent-%COMP%]   .team-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem}.team-generator[_ngcontent-%COMP%]   .team-header[_ngcontent-%COMP%]   .team-stats[_ngcontent-%COMP%]{font-size:.8rem}.team-generator[_ngcontent-%COMP%]   .formation-field[_ngcontent-%COMP%]{padding:1.5rem .5rem;min-height:350px;gap:1rem}.team-generator[_ngcontent-%COMP%]   .formation-rows[_ngcontent-%COMP%], .team-generator[_ngcontent-%COMP%]   .formation-row[_ngcontent-%COMP%]{gap:1rem}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{width:60px;height:60px}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]   .player-initial[_ngcontent-%COMP%]{font-size:1.5rem}.team-generator[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]   .goalkeeper-icon[_ngcontent-%COMP%]{font-size:1.7rem}.team-generator[_ngcontent-%COMP%]   .player-rating[_ngcontent-%COMP%]{font-size:.8rem;padding:.2rem .4rem;min-width:30px}.team-generator[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%]{font-size:.75rem;max-width:80px}.team-generator[_ngcontent-%COMP%]   .config-section[_ngcontent-%COMP%]{display:none}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:fixed;bottom:2rem;right:2rem;width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#7b2cbf,#00d4ff);border:none;color:#fff;font-size:2rem;box-shadow:0 4px 20px #7b2cbf80;cursor:pointer;z-index:1000;transition:transform .3s,box-shadow .3s}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.1);box-shadow:0 6px 30px #7b2cbfb3}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95)}.team-generator[_ngcontent-%COMP%]   .btn-floating[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}}']})};var l0=(n,e)=>e.id;function u0(n,e){n&1&&(N(0,"p",2),k(1,"No hay arqueros disponibles"),O())}function h0(n,e){if(n&1){let t=Nt();N(0,"div",5)(1,"div",6)(2,"label",7)(3,"input",8),he("change",function(){let i=Le(t).$implicit,o=$(2);return Be(o.toggleGoalkeeper(i.id))}),O(),je(4,"span",9),O(),N(5,"h3"),k(6),O()(),N(7,"div",10)(8,"span",11),k(9,"Habilidad:"),O(),je(10,"app-star-rating",12),O()()}if(n&2){let t=e.$implicit,r=$(2);Ke("selected",t.selected),U(3),Me("checked",t.selected)("disabled",!r.canSelect(t.id)),U(3),Fe(t.name),U(4),Me("value",t.skill)("readonly",!0)}}function d0(n,e){if(n&1&&(N(0,"div",3),Ye(1,h0,11,7,"div",4,l0),O()),n&2){let t=$();U(),Xe(t.goalkeepers())}}var js=class n{goalkeeperService=Ve(Ft);goalkeepers=this.goalkeeperService.goalkeepers;selectedCount=()=>this.goalkeeperService.selectedGoalkeepers().length;maxSelected=this.goalkeeperService.maxSelected;toggleGoalkeeper(e){this.goalkeeperService.toggleGoalkeeper(e)}canSelect(e){return this.goalkeeperService.canSelect(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ue({type:n,selectors:[["app-goalkeeper-list"]],decls:8,vars:3,consts:[[1,"goalkeeper-list"],[1,"selection-info"],[1,"empty-message"],[1,"goalkeepers-grid"],[1,"goalkeeper-card",3,"selected"],[1,"goalkeeper-card"],[1,"goalkeeper-header"],[1,"checkbox-container"],["type","checkbox",3,"change","checked","disabled"],[1,"checkmark"],[1,"goalkeeper-skill"],[1,"skill-label"],[3,"value","readonly"]],template:function(t,r){t&1&&(N(0,"div",0)(1,"h2"),k(2,"\u26BD Arqueros"),O(),N(3,"div",1)(4,"p"),k(5),O()(),Te(6,u0,2,0,"p",2)(7,d0,3,0,"div",3),O()),t&2&&(U(5),wi("Selecciona exactamente 2 arqueros (",r.selectedCount(),"/",r.maxSelected,")"),U(),Pe(r.goalkeepers().length===0?6:7))},dependencies:[$t],styles:['.goalkeeper-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#00d4ff;margin-bottom:1rem}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}}.goalkeeper-list[_ngcontent-%COMP%]   .selection-info[_ngcontent-%COMP%]{background:#00d4ff1a;border:1px solid rgba(0,212,255,.3);border-radius:8px;padding:1rem;margin-bottom:1.5rem}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   .selection-info[_ngcontent-%COMP%]{padding:.875rem}}.goalkeeper-list[_ngcontent-%COMP%]   .selection-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#00d4ff;font-weight:500;text-align:center}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   .selection-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem}}.goalkeeper-list[_ngcontent-%COMP%]   .empty-message[_ngcontent-%COMP%]{text-align:center;color:#fff9;padding:2rem}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeepers-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1rem}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   .goalkeepers-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-card[_ngcontent-%COMP%]{background:#ffffff0d;border:2px solid rgba(255,255,255,.1);border-radius:12px;padding:1.25rem;transition:all .3s}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-card[_ngcontent-%COMP%]{padding:1rem}}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-card[_ngcontent-%COMP%]:hover{border-color:#00d4ff4d;transform:translateY(-2px)}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-card.selected[_ngcontent-%COMP%]{border-color:#00d4ff;background:#00d4ff1a;box-shadow:0 4px 20px #00d4ff33}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1rem}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:1.1rem;flex:1}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem}}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{position:relative;cursor:pointer;-webkit-user-select:none;user-select:none;display:block}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;cursor:pointer;height:0;width:0}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff,#7b2cbf);border-color:#00d4ff}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ .checkmark[_ngcontent-%COMP%]:after{display:block}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled ~ .checkmark[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{display:block;height:24px;width:24px;background-color:#ffffff1a;border:2px solid rgba(255,255,255,.3);border-radius:6px;transition:all .3s}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:8px;top:4px;width:6px;height:12px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}.goalkeeper-list[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]:hover   input[_ngcontent-%COMP%]:not(:disabled) ~ .checkmark[_ngcontent-%COMP%]{border-color:#00d4ff}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-skill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-skill[_ngcontent-%COMP%]   .skill-label[_ngcontent-%COMP%]{color:#ffffffb3;font-size:.9rem;font-weight:500}@media(max-width:768px){.goalkeeper-list[_ngcontent-%COMP%]   .goalkeeper-skill[_ngcontent-%COMP%]   .skill-label[_ngcontent-%COMP%]{font-size:.85rem}}']})};var Zf=class n{playerService=Ve(ht);async ngOnInit(){await this.playerService.initializePlayers()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ue({type:n,selectors:[["app-landing"]],decls:28,vars:0,consts:[[1,"landing"],[1,"landing__header"],[1,"landing__nav"],[1,"landing__logo"],[1,"landing__logo-icon"],[1,"landing__logo-text"],[1,"landing__menu"],["href","#players"],["href","#goalkeepers"],["href","#teams"],[1,"landing__main"],["id","goalkeepers",1,"landing__section"],["id","players",1,"landing__section"],["id","teams",1,"landing__section"],[1,"landing__footer"]],template:function(t,r){t&1&&(N(0,"div",0)(1,"header",1)(2,"nav",2)(3,"div",3)(4,"span",4),k(5,"\u26BD"),O(),N(6,"span",5),k(7,"F\xFAtbol CLI"),O()(),N(8,"ul",6)(9,"li")(10,"a",7),k(11,"Jugadores"),O()(),N(12,"li")(13,"a",8),k(14,"Arqueros"),O()(),N(15,"li")(16,"a",9),k(17,"Equipos"),O()()()()(),N(18,"main",10)(19,"section",11),je(20,"app-goalkeeper-list"),O(),N(21,"section",12),je(22,"app-player-list"),O(),N(23,"section",13),je(24,"app-team-generator"),O()(),N(25,"footer",14)(26,"p"),k(27,"\xA9 2026 F\xFAtbol CLI - Organiza tus partidos"),O()()())},dependencies:[Bs,Us,js],styles:[".landing[_ngcontent-%COMP%]{min-height:100vh;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);color:#fff}.landing__header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:100;background:#1a1a2ef2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.1)}.landing__nav[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:0 auto;padding:1rem 2rem}@media(max-width:768px){.landing__nav[_ngcontent-%COMP%]{padding:1rem}}.landing__logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:1.5rem;font-weight:700}@media(max-width:768px){.landing__logo[_ngcontent-%COMP%]{font-size:1.2rem}}.landing__logo-icon[_ngcontent-%COMP%]{font-size:2rem}@media(max-width:768px){.landing__logo-icon[_ngcontent-%COMP%]{font-size:1.5rem}}.landing__logo-text[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff,#7b2cbf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.landing__menu[_ngcontent-%COMP%]{display:flex;list-style:none;gap:2rem;margin:0;padding:0}@media(max-width:768px){.landing__menu[_ngcontent-%COMP%]{gap:1rem;font-size:.9rem}}@media(max-width:480px){.landing__menu[_ngcontent-%COMP%]{gap:.75rem;font-size:.85rem}}.landing__menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{white-space:nowrap}.landing__menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;transition:color .3s}.landing__menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#00d4ff}.landing__main[_ngcontent-%COMP%]{padding-top:80px}.landing__hero[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;min-height:calc(100vh - 80px);max-width:1200px;margin:0 auto;padding:2rem;gap:2rem}@media(max-width:768px){.landing__hero[_ngcontent-%COMP%]{padding:2rem 1rem;min-height:auto}}.landing__hero-content[_ngcontent-%COMP%]{flex:1}.landing__hero-image[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center}.landing__title[_ngcontent-%COMP%]{font-size:3.5rem;line-height:1.2;margin-bottom:1.5rem}@media(max-width:768px){.landing__title[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:1rem}}@media(max-width:480px){.landing__title[_ngcontent-%COMP%]{font-size:1.75rem}}.landing__highlight[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff,#7b2cbf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.landing__subtitle[_ngcontent-%COMP%]{font-size:1.25rem;color:#fffc;margin-bottom:2rem;max-width:500px}@media(max-width:768px){.landing__subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:1.5rem}}.landing__cta[_ngcontent-%COMP%]{display:flex;gap:1rem}.landing__btn[_ngcontent-%COMP%]{padding:1rem 2rem;font-size:1rem;font-weight:600;border:none;border-radius:50px;cursor:pointer;transition:transform .3s,box-shadow .3s}@media(max-width:768px){.landing__btn[_ngcontent-%COMP%]{padding:.875rem 1.5rem;font-size:.9rem;width:100%}}.landing__btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.landing__btn--primary[_ngcontent-%COMP%]{background:linear-gradient(90deg,#00d4ff,#7b2cbf);color:#fff;box-shadow:0 4px 20px #00d4ff66}.landing__btn--primary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 30px #00d4ff99}.landing__btn--secondary[_ngcontent-%COMP%]{background:transparent;color:#fff;border:2px solid rgba(255,255,255,.3)}.landing__btn--secondary[_ngcontent-%COMP%]:hover{border-color:#00d4ff;color:#00d4ff}.landing__ball-animation[_ngcontent-%COMP%]{font-size:10rem;animation:_ngcontent-%COMP%_bounce 2s ease-in-out infinite}.landing__section-title[_ngcontent-%COMP%]{text-align:center;font-size:2.5rem;margin-bottom:3rem;background:linear-gradient(90deg,#00d4ff,#7b2cbf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}@media(max-width:768px){.landing__section-title[_ngcontent-%COMP%]{font-size:1.75rem;margin-bottom:2rem}}.landing__section[_ngcontent-%COMP%]{padding:3rem 2rem;max-width:1200px;margin:0 auto}@media(max-width:768px){.landing__section[_ngcontent-%COMP%]{padding:2rem 1rem}}.landing__grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 350px;gap:2rem}@media(max-width:900px){.landing__grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1.5rem}}.landing__grid-main[_ngcontent-%COMP%]{min-width:0}.landing__grid-side[_ngcontent-%COMP%]{position:sticky;top:100px;align-self:start}.landing__footer[_ngcontent-%COMP%]{padding:2rem;text-align:center;background:#0000004d;color:#fff9}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translateY(0)}50%{transform:translateY(-30px)}}@media(max-width:768px){.landing__hero[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.landing__subtitle[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto}.landing__cta[_ngcontent-%COMP%]{justify-content:center;flex-direction:column;width:100%}.landing__ball-animation[_ngcontent-%COMP%]{font-size:6rem}.landing__menu[_ngcontent-%COMP%]{display:none}}"]})};export{Zf as Landing};
